(function(){"use strict";var e={9581:function(e,t,a){var l=a(5130),o=a(6768);function s(e,t,a,l,s,r){const i=(0,o.g2)("v-toolbar-title"),n=(0,o.g2)("v-spacer"),c=(0,o.g2)("v-icon"),d=(0,o.g2)("v-btn"),u=(0,o.g2)("v-app-bar"),m=(0,o.g2)("router-view"),g=(0,o.g2)("v-main"),h=(0,o.g2)("v-app");return(0,o.uX)(),(0,o.Wv)(h,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{color:"primary",dark:"",prominent:""},{default:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[0]||(t[0]=[(0,o.eW)("Distributed Inventory and Sales Management System",-1)])]),_:1}),(0,o.bF)(n),(0,o.bF)(d,{to:{name:"Selling"},color:"white",variant:"text",class:"mr-2"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{left:""},{default:(0,o.k6)(()=>[...t[1]||(t[1]=[(0,o.eW)("mdi-cash-register",-1)])]),_:1}),t[2]||(t[2]=(0,o.eW)(" selling ",-1))]),_:1}),(0,o.bF)(d,{to:{name:"Inventory"},color:"white",variant:"text",class:"mr-2"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{left:""},{default:(0,o.k6)(()=>[...t[3]||(t[3]=[(0,o.eW)("mdi-warehouse",-1)])]),_:1}),t[4]||(t[4]=(0,o.eW)(" Inventory ",-1))]),_:1}),(0,o.bF)(d,{to:{name:"SalesRecord"},color:"white",variant:"text",class:"mr-2"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{left:""},{default:(0,o.k6)(()=>[...t[5]||(t[5]=[(0,o.eW)("mdi-chart-line",-1)])]),_:1}),t[6]||(t[6]=(0,o.eW)(" sales record ",-1))]),_:1}),(0,o.bF)(d,{icon:""},{default:(0,o.k6)(()=>[(0,o.bF)(c,null,{default:(0,o.k6)(()=>[...t[7]||(t[7]=[(0,o.eW)("mdi-account",-1)])]),_:1})]),_:1})]),_:1}),(0,o.bF)(g,null,{default:(0,o.k6)(()=>[(0,o.bF)(m)]),_:1})]),_:1})}var r={name:"App"},i=a(1241);const n=(0,i.A)(r,[["render",s]]);var c=n,d=a(5753),u=(a(5524),a(2801)),m=a(3425),g=a(1387),h=a(4232);function p(e,t,a,l,s,r){const i=(0,o.g2)("v-icon"),n=(0,o.g2)("v-spacer"),c=(0,o.g2)("v-btn"),d=(0,o.g2)("v-card-title"),u=(0,o.g2)("v-card-text"),m=(0,o.g2)("v-card"),g=(0,o.g2)("SalesRecordFilters"),p=(0,o.g2)("SalesRecordList"),f=(0,o.g2)("v-col"),y=(0,o.g2)("v-row"),b=(0,o.g2)("v-card-actions"),v=(0,o.g2)("v-dialog"),k=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(k,{fluid:""},{default:(0,o.k6)(()=>[(0,o.bF)(y,null,{default:(0,o.k6)(()=>[(0,o.bF)(f,{cols:"12"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{class:"mb-4"},{default:(0,o.k6)(()=>[(0,o.bF)(d,{class:"d-flex align-center"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{left:"",size:"large",color:"primary"},{default:(0,o.k6)(()=>[...t[2]||(t[2]=[(0,o.eW)("mdi-chart-line",-1)])]),_:1}),t[5]||(t[5]=(0,o.Lk)("h1",{class:"text-h4"},"Sales Records Query",-1)),(0,o.bF)(n),(0,o.bF)(c,{color:"primary",variant:"outlined",onClick:r.refreshData,loading:s.isRefreshing},{default:(0,o.k6)(()=>[(0,o.bF)(i,{left:""},{default:(0,o.k6)(()=>[...t[3]||(t[3]=[(0,o.eW)("mdi-refresh",-1)])]),_:1}),t[4]||(t[4]=(0,o.eW)(" Refresh Data ",-1))]),_:1},8,["onClick","loading"])]),_:1}),(0,o.bF)(u,null,{default:(0,o.k6)(()=>[...t[6]||(t[6]=[(0,o.Lk)("p",{class:"text-body-1 text-grey-darken-1"}," View and manage all sales records with filtering by date, product, and store ",-1)])]),_:1})]),_:1}),(0,o.bF)(g,{onFiltersChange:r.onFiltersChange,onError:r.onFilterError,class:"mb-4"},null,8,["onFiltersChange","onError"]),(0,o.bF)(p,{"sales-records":s.salesRecords,stats:s.salesStats,loading:s.loading,error:s.error},null,8,["sales-records","stats","loading","error"])]),_:1})]),_:1}),(0,o.bF)(v,{modelValue:s.showErrorDialog,"onUpdate:modelValue":t[1]||(t[1]=e=>s.showErrorDialog=e),"max-width":"500px"},{default:(0,o.k6)(()=>[(0,o.bF)(m,null,{default:(0,o.k6)(()=>[(0,o.bF)(d,{class:"text-h5 text-error"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{left:"",color:"error"},{default:(0,o.k6)(()=>[...t[7]||(t[7]=[(0,o.eW)("mdi-alert-circle",-1)])]),_:1}),t[8]||(t[8]=(0,o.eW)(" Error ",-1))]),_:1}),(0,o.bF)(u,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(s.errorDialogMessage),1)]),_:1}),(0,o.bF)(b,null,{default:(0,o.k6)(()=>[(0,o.bF)(n),(0,o.bF)(c,{color:"primary",onClick:t[0]||(t[0]=e=>s.showErrorDialog=!1)},{default:(0,o.k6)(()=>[...t[9]||(t[9]=[(0,o.eW)("OK",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}function f(e,t,a,l,s,r){const i=(0,o.g2)("v-icon"),n=(0,o.g2)("v-card-title"),c=(0,o.g2)("v-select"),d=(0,o.g2)("v-col"),u=(0,o.g2)("v-date-picker"),m=(0,o.g2)("v-text-field"),g=(0,o.g2)("v-combobox"),h=(0,o.g2)("v-row"),p=(0,o.g2)("v-btn"),f=(0,o.g2)("v-card-text"),y=(0,o.g2)("v-spacer"),b=(0,o.g2)("v-card-actions"),v=(0,o.g2)("v-card"),k=(0,o.g2)("v-dialog");return(0,o.uX)(),(0,o.Wv)(v,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[(0,o.bF)(i,{left:""},{default:(0,o.k6)(()=>[...t[9]||(t[9]=[(0,o.eW)("mdi-filter",-1)])]),_:1}),t[10]||(t[10]=(0,o.eW)(" Filter Conditions ",-1))]),_:1}),(0,o.bF)(f,null,{default:(0,o.k6)(()=>[(0,o.bF)(h,null,{default:(0,o.k6)(()=>[(0,o.bF)(d,{cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{modelValue:s.dateFilterType,"onUpdate:modelValue":t[0]||(t[0]=e=>s.dateFilterType=e),items:s.dateFilterOptions,label:"Date Filter Type",outlined:"",dense:"",onChange:r.onDateFilterTypeChange},null,8,["modelValue","items","onChange"])]),_:1}),"single"===s.dateFilterType?((0,o.uX)(),(0,o.Wv)(d,{key:0,cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:s.singleDate,"onUpdate:modelValue":[t[1]||(t[1]=e=>s.singleDate=e),r.onDateChange],color:"primary","show-adjacent-months":"",max:(new Date).toISOString().split("T")[0]},null,8,["modelValue","onUpdate:modelValue","max"])]),_:1})):(0,o.Q3)("",!0),"range"===s.dateFilterType?((0,o.uX)(),(0,o.Wv)(d,{key:1,cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{modelValue:s.dateRangeText,"onUpdate:modelValue":t[2]||(t[2]=e=>s.dateRangeText=e),label:"Date Range",placeholder:"Select start and end date",outlined:"",dense:"",readonly:"","append-icon":"mdi-calendar",onClick:t[3]||(t[3]=e=>s.showDateRangePicker=!0)},null,8,["modelValue"])]),_:1})):(0,o.Q3)("",!0),(0,o.bF)(d,{cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(g,{modelValue:s.selectedProducts,"onUpdate:modelValue":[t[4]||(t[4]=e=>s.selectedProducts=e),r.onFiltersChange],items:s.availableProducts,loading:s.loadingProducts,label:"Product Filter",placeholder:"Select products",outlined:"",dense:"",multiple:"",chips:"",clearable:""},null,8,["modelValue","items","loading","onUpdate:modelValue"])]),_:1}),(0,o.bF)(d,{cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(g,{modelValue:s.selectedStoreNames,"onUpdate:modelValue":[t[5]||(t[5]=e=>s.selectedStoreNames=e),r.onFiltersChange],items:s.availableStoreNames,loading:s.loadingStoreNames,label:"Store Filter",placeholder:"Select stores",outlined:"",dense:"",multiple:"",chips:"",clearable:""},null,8,["modelValue","items","loading","onUpdate:modelValue"])]),_:1})]),_:1}),(0,o.bF)(h,{class:"mt-2"},{default:(0,o.k6)(()=>[(0,o.bF)(d,{cols:"12",class:"text-right"},{default:(0,o.k6)(()=>[(0,o.bF)(p,{color:"secondary",onClick:r.resetFilters,class:"mr-2"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{left:""},{default:(0,o.k6)(()=>[...t[11]||(t[11]=[(0,o.eW)("mdi-refresh",-1)])]),_:1}),t[12]||(t[12]=(0,o.eW)(" Reset ",-1))]),_:1},8,["onClick"]),(0,o.bF)(p,{color:"primary",onClick:r.applyFilters,loading:s.loading},{default:(0,o.k6)(()=>[(0,o.bF)(i,{left:""},{default:(0,o.k6)(()=>[...t[13]||(t[13]=[(0,o.eW)("mdi-magnify",-1)])]),_:1}),t[14]||(t[14]=(0,o.eW)(" Search ",-1))]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1}),(0,o.bF)(k,{modelValue:s.showDateRangePicker,"onUpdate:modelValue":t[8]||(t[8]=e=>s.showDateRangePicker=e),"max-width":"400px"},{default:(0,o.k6)(()=>[(0,o.bF)(v,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[15]||(t[15]=[(0,o.eW)("Select Date Range",-1)])]),_:1}),(0,o.bF)(f,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:s.dateRange,"onUpdate:modelValue":[t[6]||(t[6]=e=>s.dateRange=e),r.onDateRangeChange],range:"",color:"primary","show-adjacent-months":"",max:(new Date).toISOString().split("T")[0]},null,8,["modelValue","onUpdate:modelValue","max"])]),_:1}),(0,o.bF)(b,null,{default:(0,o.k6)(()=>[(0,o.bF)(y),(0,o.bF)(p,{text:"",onClick:t[7]||(t[7]=e=>s.showDateRangePicker=!1)},{default:(0,o.k6)(()=>[...t[16]||(t[16]=[(0,o.eW)("Cancel",-1)])]),_:1}),(0,o.bF)(p,{color:"primary",onClick:r.confirmDateRange},{default:(0,o.k6)(()=>[...t[17]||(t[17]=[(0,o.eW)("Confirm",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}a(8111),a(1701),a(8237),a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698);var y=a(1300);const b="https://obhzromrgwodaxsjlgfs.supabase.co",v="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9iaHpyb21yZ3dvZGF4c2psZ2ZzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2NDg1NTgsImV4cCI6MjA3NDIyNDU1OH0.7gjEbFfzzXOTxt3fhnBxEfSqKtazQ_5ywY4i_I84O-E";b&&v||console.error("[Supabase] Missing SUPABASE_URL or SUPABASE_ANON_KEY environment variables");const k=(0,y.UU)(b||"",v||"");var F=k;const _="sales";async function S(e){const{data:t,error:a}=await F.from(_).insert([e]).select();if(a)throw a;return t}async function C(e){let t=F.from(_).select("*");if(e.dateRange)if(1===e.dateRange.length){const a=new Date(e.dateRange[0]);a.setHours(0,0,0,0);const l=new Date(e.dateRange[0]);l.setHours(23,59,59,999),t=t.gte("time",a.toISOString()).lte("time",l.toISOString())}else if(2===e.dateRange.length){const a=new Date(e.dateRange[0]);a.setHours(0,0,0,0);const l=new Date(e.dateRange[1]);l.setHours(23,59,59,999),t=t.gte("time",a.toISOString()).lte("time",l.toISOString())}e.products&&e.products.length>0&&(t=t.in("product",e.products)),e.storeNames&&e.storeNames.length>0&&(t=t.in("name",e.storeNames)),t=t.order("time",{ascending:!1}),e.limit&&(t=t.limit(e.limit)),e.offset&&(t=t.range(e.offset,e.offset+(e.limit||20)-1));const{data:a,error:l}=await t;if(l)throw l;return a}async function w(){const{data:e,error:t}=await F.from(_).select("product").order("product");if(t)throw t;const a=[...new Set(e.map(e=>e.product))];return a}async function P(){const{data:e,error:t}=await F.from(_).select("name").order("name");if(t)throw t;const a=[...new Set(e.map(e=>e.name))];return a}async function x(e={}){let t=F.from(_).select("price, quantity");if(e.dateRange)if(1===e.dateRange.length){const a=new Date(e.dateRange[0]);a.setHours(0,0,0,0);const l=new Date(e.dateRange[0]);l.setHours(23,59,59,999),t=t.gte("time",a.toISOString()).lte("time",l.toISOString())}else if(2===e.dateRange.length){const a=new Date(e.dateRange[0]);a.setHours(0,0,0,0);const l=new Date(e.dateRange[1]);l.setHours(23,59,59,999),t=t.gte("time",a.toISOString()).lte("time",l.toISOString())}e.products&&e.products.length>0&&(t=t.in("product",e.products)),e.storeNames&&e.storeNames.length>0&&(t=t.in("name",e.storeNames));const{data:a,error:l}=await t;if(l)throw l;const o=a.length,s=a.reduce((e,t)=>e+(t.price||0),0),r=a.reduce((e,t)=>e+(t.quantity||0),0);return{totalRecords:o,totalRevenue:s,totalQuantity:r}}var I={name:"SalesRecordFilters",emits:["filters-change"],data(){return{dateFilterType:"none",dateFilterOptions:[{title:"No Date Filter",value:"none"},{title:"Select Single Date",value:"single"},{title:"Select Date Range",value:"range"}],singleDate:null,dateRange:[],dateRangeText:"",showDateRangePicker:!1,selectedProducts:[],selectedStoreNames:[],availableProducts:[],availableStoreNames:[],loadingProducts:!1,loadingStoreNames:!1,loading:!1}},mounted(){this.loadFilterOptions()},methods:{async loadFilterOptions(){this.loadingProducts=!0,this.loadingStoreNames=!0;try{const[e,t]=await Promise.all([w(),P()]);this.availableProducts=e,this.availableStoreNames=t}catch(e){console.error("Failed to load filter options:",e),this.$emit("error","Failed to load filter options")}finally{this.loadingProducts=!1,this.loadingStoreNames=!1}},onDateFilterTypeChange(){this.resetDateFilters(),this.onFiltersChange()},onDateChange(){this.onFiltersChange()},onDateRangeChange(){},confirmDateRange(){this.dateRange&&this.dateRange.length>0&&(1===this.dateRange.length?this.dateRangeText=this.formatDate(this.dateRange[0]):2===this.dateRange.length&&(this.dateRangeText=`${this.formatDate(this.dateRange[0])} - ${this.formatDate(this.dateRange[1])}`)),this.showDateRangePicker=!1,this.onFiltersChange()},formatDate(e){return e?new Date(e).toLocaleDateString("en-US"):""},onFiltersChange(){this.emitFilters()},emitFilters(){const e={dateRange:this.getDateRangeFilter(),products:this.selectedProducts,storeNames:this.selectedStoreNames};this.$emit("filters-change",e)},getDateRangeFilter(){return"single"===this.dateFilterType&&this.singleDate?[this.singleDate]:"range"===this.dateFilterType&&this.dateRange.length>0?this.dateRange:null},applyFilters(){this.loading=!0,this.emitFilters(),setTimeout(()=>{this.loading=!1},500)},resetFilters(){this.dateFilterType="none",this.singleDate=null,this.dateRange=[],this.dateRangeText="",this.selectedProducts=[],this.selectedStoreNames=[],this.emitFilters()},resetDateFilters(){this.singleDate=null,this.dateRange=[],this.dateRangeText=""}}};const R=(0,i.A)(I,[["render",f],["__scopeId","data-v-5827b50c"]]);var W=R;const V={class:"text-h6"},N={class:"text-h6"},D={class:"text-h6"},L={key:1,class:"text-center py-8"},q={key:3,class:"text-center py-8"},Q={key:4},E={class:"ml-2"},$={class:"font-weight-medium"},T={class:"font-weight-medium"},U={class:"font-weight-medium"},O={class:"font-weight-bold text-primary"},X={class:"text-caption"};function M(e,t,a,l,s,r){const i=(0,o.g2)("v-icon"),n=(0,o.g2)("v-spacer"),c=(0,o.g2)("v-chip"),d=(0,o.g2)("v-card-title"),u=(0,o.g2)("v-card-text"),m=(0,o.g2)("v-card"),g=(0,o.g2)("v-col"),p=(0,o.g2)("v-row"),f=(0,o.g2)("v-progress-circular"),y=(0,o.g2)("v-alert"),b=(0,o.g2)("v-expansion-panel-title"),v=(0,o.g2)("v-divider"),k=(0,o.g2)("v-list-item-title"),F=(0,o.g2)("v-list-item-subtitle"),_=(0,o.g2)("v-list-item"),S=(0,o.g2)("v-list"),C=(0,o.g2)("v-expansion-panel-text"),w=(0,o.g2)("v-expansion-panel"),P=(0,o.g2)("v-expansion-panels"),x=(0,o.g2)("v-pagination");return(0,o.uX)(),(0,o.Wv)(m,null,{default:(0,o.k6)(()=>[(0,o.bF)(d,null,{default:(0,o.k6)(()=>[(0,o.bF)(i,{left:""},{default:(0,o.k6)(()=>[...t[2]||(t[2]=[(0,o.eW)("mdi-format-list-bulleted",-1)])]),_:1}),t[3]||(t[3]=(0,o.eW)(" Sales Records ",-1)),(0,o.bF)(n),(0,o.bF)(c,{color:"primary",variant:"outlined"},{default:(0,o.k6)(()=>[(0,o.eW)(" Total "+(0,h.v_)(r.totalRecords)+" Records ",1)]),_:1})]),_:1}),(0,o.bF)(u,null,{default:(0,o.k6)(()=>[a.stats?((0,o.uX)(),(0,o.Wv)(p,{key:0,class:"mb-4"},{default:(0,o.k6)(()=>[(0,o.bF)(g,{cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{color:"primary",variant:"tonal"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"text-center"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",V,(0,h.v_)(a.stats.totalRecords),1),t[4]||(t[4]=(0,o.Lk)("div",{class:"text-caption"},"Total Records",-1))]),_:1})]),_:1})]),_:1}),(0,o.bF)(g,{cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{color:"success",variant:"tonal"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"text-center"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",N,"$"+(0,h.v_)(a.stats.totalRevenue.toLocaleString()),1),t[5]||(t[5]=(0,o.Lk)("div",{class:"text-caption"},"Total Revenue",-1))]),_:1})]),_:1})]),_:1}),(0,o.bF)(g,{cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{color:"info",variant:"tonal"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"text-center"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",D,(0,h.v_)(a.stats.totalQuantity),1),t[6]||(t[6]=(0,o.Lk)("div",{class:"text-caption"},"Total Quantity",-1))]),_:1})]),_:1})]),_:1})]),_:1})):(0,o.Q3)("",!0),a.loading?((0,o.uX)(),(0,o.CE)("div",L,[(0,o.bF)(f,{indeterminate:"",color:"primary",size:"64"}),t[7]||(t[7]=(0,o.Lk)("div",{class:"mt-2"},"Loading...",-1))])):a.error?((0,o.uX)(),(0,o.Wv)(y,{key:2,type:"error",class:"mb-4"},{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(a.error),1)]),_:1})):0===a.salesRecords.length?((0,o.uX)(),(0,o.CE)("div",q,[(0,o.bF)(i,{size:"64",color:"grey"},{default:(0,o.k6)(()=>[...t[8]||(t[8]=[(0,o.eW)("mdi-inbox-outline",-1)])]),_:1}),t[9]||(t[9]=(0,o.Lk)("div",{class:"text-h6 mt-2"},"No Sales Records Found",-1)),t[10]||(t[10]=(0,o.Lk)("div",{class:"text-body-2 text-grey"},"Please adjust filter conditions or check data",-1))])):((0,o.uX)(),(0,o.CE)("div",Q,[(0,o.bF)(P,{modelValue:s.expandedPanels,"onUpdate:modelValue":t[0]||(t[0]=e=>s.expandedPanels=e),multiple:""},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.paginatedRecords,(e,a)=>((0,o.uX)(),(0,o.Wv)(w,{key:e.id||a,value:a},{default:(0,o.k6)(()=>[(0,o.bF)(b,null,{default:(0,o.k6)(({expanded:a})=>[(0,o.bF)(p,{"no-gutters":""},{default:(0,o.k6)(()=>[(0,o.bF)(g,{cols:"12",md:"3"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{icon:a?"mdi-chevron-up":"mdi-chevron-down"},null,8,["icon"]),(0,o.Lk)("span",E,(0,h.v_)(e.product),1)]),_:2},1024),(0,o.bF)(g,{cols:"12",md:"2"},{default:(0,o.k6)(()=>[t[11]||(t[11]=(0,o.Lk)("span",{class:"text-caption text-grey"},"Store:",-1)),(0,o.Lk)("div",$,(0,h.v_)(e.name),1)]),_:2},1024),(0,o.bF)(g,{cols:"12",md:"2"},{default:(0,o.k6)(()=>[t[12]||(t[12]=(0,o.Lk)("span",{class:"text-caption text-grey"},"Qty:",-1)),(0,o.Lk)("div",T,(0,h.v_)(e.quantity),1)]),_:2},1024),(0,o.bF)(g,{cols:"12",md:"2"},{default:(0,o.k6)(()=>[t[13]||(t[13]=(0,o.Lk)("span",{class:"text-caption text-grey"},"Unit:",-1)),(0,o.Lk)("div",U,"$"+(0,h.v_)(e.unit_price),1)]),_:2},1024),(0,o.bF)(g,{cols:"12",md:"2"},{default:(0,o.k6)(()=>[t[14]||(t[14]=(0,o.Lk)("span",{class:"text-caption text-grey"},"Total:",-1)),(0,o.Lk)("div",O,"$"+(0,h.v_)(e.price),1)]),_:2},1024),(0,o.bF)(g,{cols:"12",md:"1"},{default:(0,o.k6)(()=>[t[15]||(t[15]=(0,o.Lk)("span",{class:"text-caption text-grey"},"Time:",-1)),(0,o.Lk)("div",X,(0,h.v_)(r.formatDate(e.time)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,o.bF)(C,null,{default:(0,o.k6)(()=>[(0,o.bF)(v,{class:"mb-3"}),(0,o.bF)(p,null,{default:(0,o.k6)(()=>[(0,o.bF)(g,{cols:"12",md:"6"},{default:(0,o.k6)(()=>[(0,o.bF)(S,{density:"compact"},{default:(0,o.k6)(()=>[(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[16]||(t[16]=[(0,o.eW)("mdi-store",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[17]||(t[17]=[(0,o.eW)("Store Name",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(e.name),1)]),_:2},1024)]),_:2},1024),(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[18]||(t[18]=[(0,o.eW)("mdi-map-marker",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[19]||(t[19]=[(0,o.eW)("Store Location",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(e.store_location),1)]),_:2},1024)]),_:2},1024),(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[20]||(t[20]=[(0,o.eW)("mdi-package-variant",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[21]||(t[21]=[(0,o.eW)("Product",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(e.product),1)]),_:2},1024)]),_:2},1024),(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[22]||(t[22]=[(0,o.eW)("mdi-palette",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[23]||(t[23]=[(0,o.eW)("Color",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(e.color),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,o.bF)(g,{cols:"12",md:"6"},{default:(0,o.k6)(()=>[(0,o.bF)(S,{density:"compact"},{default:(0,o.k6)(()=>[e.storage?((0,o.uX)(),(0,o.Wv)(_,{key:0},{prepend:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[24]||(t[24]=[(0,o.eW)("mdi-memory",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[25]||(t[25]=[(0,o.eW)("Storage",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(e.storage)+"GB",1)]),_:2},1024)]),_:2},1024)):(0,o.Q3)("",!0),(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[26]||(t[26]=[(0,o.eW)("mdi-numeric",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[27]||(t[27]=[(0,o.eW)("Quantity",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(e.quantity),1)]),_:2},1024)]),_:2},1024),(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[28]||(t[28]=[(0,o.eW)("mdi-currency-usd",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[29]||(t[29]=[(0,o.eW)("Unit Price",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)("$"+(0,h.v_)(e.unit_price),1)]),_:2},1024)]),_:2},1024),(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[30]||(t[30]=[(0,o.eW)("mdi-calculator",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[31]||(t[31]=[(0,o.eW)("Total Price",-1)])]),_:1}),(0,o.bF)(F,{class:"text-h6 text-primary"},{default:(0,o.k6)(()=>[(0,o.eW)("$"+(0,h.v_)(e.price),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,o.bF)(v,{class:"mt-3"}),(0,o.bF)(p,{class:"mt-2"},{default:(0,o.k6)(()=>[(0,o.bF)(g,{cols:"12",class:"text-right"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{color:"grey",variant:"outlined",size:"small"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{start:""},{default:(0,o.k6)(()=>[...t[32]||(t[32]=[(0,o.eW)("mdi-clock",-1)])]),_:1}),(0,o.eW)(" Sale Time: "+(0,h.v_)(r.formatDateTime(e.time)),1)]),_:2},1024),(0,o.bF)(c,{color:"grey",variant:"outlined",size:"small",class:"ml-2"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{start:""},{default:(0,o.k6)(()=>[...t[33]||(t[33]=[(0,o.eW)("mdi-identifier",-1)])]),_:1}),(0,o.eW)(" ID: "+(0,h.v_)(e.id),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),r.totalPages>1?((0,o.uX)(),(0,o.Wv)(x,{key:0,modelValue:s.currentPage,"onUpdate:modelValue":[t[1]||(t[1]=e=>s.currentPage=e),r.onPageChange],length:r.totalPages,"total-visible":7,class:"mt-4"},null,8,["modelValue","length","onUpdate:modelValue"])):(0,o.Q3)("",!0)]))]),_:1})]),_:1})}var A={name:"SalesRecordList",props:{salesRecords:{type:Array,default:()=>[]},stats:{type:Object,default:null},loading:{type:Boolean,default:!1},error:{type:String,default:""}},data(){return{currentPage:1,itemsPerPage:20,expandedPanels:[]}},computed:{totalRecords(){return this.salesRecords.length},totalPages(){return Math.ceil(this.totalRecords/this.itemsPerPage)},paginatedRecords(){const e=(this.currentPage-1)*this.itemsPerPage,t=e+this.itemsPerPage;return this.salesRecords.slice(e,t)}},watch:{salesRecords(){this.currentPage=1,this.expandedPanels=[]}},methods:{formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString("en-US")},formatDateTime(e){if(!e)return"";const t=new Date(e);return t.toLocaleString("en-US")},onPageChange(e){this.currentPage=e,this.$nextTick(()=>{const e=this.$el.querySelector(".v-card");e&&e.scrollIntoView({behavior:"smooth"})})},expandAll(){this.expandedPanels=Array.from({length:this.paginatedRecords.length},(e,t)=>t)},collapseAll(){this.expandedPanels=[]}}};const j=(0,i.A)(A,[["render",M],["__scopeId","data-v-1232b3a8"]]);var z=j,B={name:"SalesRecord",components:{SalesRecordFilters:W,SalesRecordList:z},data(){return{salesRecords:[],salesStats:null,loading:!1,isRefreshing:!1,error:"",showErrorDialog:!1,errorDialogMessage:"",currentFilters:{}}},async mounted(){await this.loadSalesData()},methods:{async onFiltersChange(e){this.currentFilters=e,await this.loadSalesData(e)},async loadSalesData(e={}){this.loading=!0,this.error="";try{const[t,a]=await Promise.all([C(e),x(e)]);this.salesRecords=t,this.salesStats=a,0===t.length&&Object.keys(e).length>0&&(this.error="No sales records found matching the criteria. Please try adjusting the filter conditions")}catch(t){console.error("Failed to load sales data:",t),this.error="Failed to load sales records: "+t.message,this.salesRecords=[],this.salesStats=null}finally{this.loading=!1}},async refreshData(){this.isRefreshing=!0;try{await this.loadSalesData(this.currentFilters)}finally{this.isRefreshing=!1}},onFilterError(e){this.errorDialogMessage=e,this.showErrorDialog=!0}}};const H=(0,i.A)(B,[["render",p],["__scopeId","data-v-5fb0bc80"]]);var J=H;const G={key:0},Z={key:1};function K(e,t,a,l,s,r){const i=(0,o.g2)("v-card-title"),n=(0,o.g2)("v-text-field"),c=(0,o.g2)("v-col"),d=(0,o.g2)("v-row"),u=(0,o.g2)("v-data-table"),m=(0,o.g2)("v-card-text"),g=(0,o.g2)("v-card"),p=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(p,{fluid:""},{default:(0,o.k6)(()=>[(0,o.bF)(d,null,{default:(0,o.k6)(()=>[(0,o.bF)(c,{cols:"12"},{default:(0,o.k6)(()=>[(0,o.bF)(g,null,{default:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[5]||(t[5]=[(0,o.Lk)("h1",{class:"text-h4"},"Inventory",-1)])]),_:1}),(0,o.bF)(m,null,{default:(0,o.k6)(()=>[(0,o.bF)(d,{class:"mb-4",dense:""},{default:(0,o.k6)(()=>[(0,o.bF)(c,{cols:"12",sm:"6",md:"3"},{default:(0,o.k6)(()=>[(0,o.bF)(n,{modelValue:s.idFilter,"onUpdate:modelValue":t[0]||(t[0]=e=>s.idFilter=e),label:"ID",clearable:"",density:"comfortable"},null,8,["modelValue"])]),_:1}),(0,o.bF)(c,{cols:"12",sm:"6",md:"3"},{default:(0,o.k6)(()=>[(0,o.bF)(n,{modelValue:s.productFilter,"onUpdate:modelValue":t[1]||(t[1]=e=>s.productFilter=e),label:"Product",clearable:"",density:"comfortable"},null,8,["modelValue"])]),_:1}),(0,o.bF)(c,{cols:"12",sm:"6",md:"3"},{default:(0,o.k6)(()=>[(0,o.bF)(n,{modelValue:s.nameFilter,"onUpdate:modelValue":t[2]||(t[2]=e=>s.nameFilter=e),label:"Store Name",clearable:"",density:"comfortable"},null,8,["modelValue"])]),_:1}),(0,o.bF)(c,{cols:"12",sm:"6",md:"3"},{default:(0,o.k6)(()=>[(0,o.bF)(n,{modelValue:s.locationFilter,"onUpdate:modelValue":t[3]||(t[3]=e=>s.locationFilter=e),label:"Store Location",clearable:"",density:"comfortable"},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(u,{headers:s.headers,items:r.filteredProducts,"sort-by":s.sortBy,"onUpdate:sortBy":t[4]||(t[4]=e=>s.sortBy=e)},{["item.price"]:(0,o.k6)(({item:e})=>[null!==e.price&&void 0!==e.price?((0,o.uX)(),(0,o.CE)("span",G," $"+(0,h.v_)(e.price),1)):((0,o.uX)(),(0,o.CE)("span",Z,"-"))]),_:2},1032,["headers","items","sort-by"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}a(2489);const Y="inventory";var ee={name:"InventoryPage",data(){return{headers:[{title:"ID",value:"id"},{title:"Product",value:"product"},{title:"Color",value:"color"},{title:"Storage",value:"storage"},{title:"Stock Quantity",value:"quantity"},{title:"Price",value:"price"},{title:"Store Name",value:"name"},{title:"Store Location",value:"location"},{title:"Update Time",value:"UpdateTime"}],products:[],idFilter:"",productFilter:"",nameFilter:"",locationFilter:"",sortBy:[{key:"name",order:"asc"}]}},computed:{filteredProducts(){const e=String(this.idFilter||"").trim().toLowerCase(),t=String(this.productFilter||"").trim().toLowerCase(),a=String(this.nameFilter||"").trim().toLowerCase(),l=String(this.locationFilter||"").trim().toLowerCase();return e||t||a||l?(this.products||[]).filter(o=>{const s=o&&void 0!==o.id&&null!==o.id?String(o.id).toLowerCase():"",r=o&&o.product?String(o.product).toLowerCase():"",i=o&&o.name?String(o.name).toLowerCase():"",n=o&&o.location?String(o.location).toLowerCase():"",c=!e||s.includes(e),d=!t||r.includes(t),u=!a||i.includes(a),m=!l||n.includes(l);return c&&d&&u&&m}):this.products}},async mounted(){try{const{data:e,error:t}=await F.from(Y).select("*");if(t)throw t;this.products=e}catch(e){console.error("Error fetching data:",e)}}};const te=(0,i.A)(ee,[["render",K]]);var ae=te;const le={class:"text-h6"};function oe(e,t,a,l,s,r){const i=(0,o.g2)("v-card-title"),n=(0,o.g2)("InventorySearchPanel"),c=(0,o.g2)("v-radio"),d=(0,o.g2)("v-radio-group"),u=(0,o.g2)("v-col"),m=(0,o.g2)("v-text-field"),g=(0,o.g2)("v-row"),p=(0,o.g2)("v-card-text"),f=(0,o.g2)("v-card"),y=(0,o.g2)("v-btn"),b=(0,o.g2)("v-alert"),v=(0,o.g2)("CartPanel"),k=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(k,{fluid:""},{default:(0,o.k6)(()=>[(0,o.bF)(g,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{cols:"12"},{default:(0,o.k6)(()=>[(0,o.bF)(f,null,{default:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[2]||(t[2]=[(0,o.Lk)("h1",{class:"text-h4"},"Selling",-1)])]),_:1}),(0,o.bF)(p,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,{onChange:r.onSelectionChange},null,8,["onChange"]),s.selectedItem?((0,o.uX)(),(0,o.Wv)(f,{key:0,class:"mt-4",elevation:"2"},{default:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[3]||(t[3]=[(0,o.eW)("Select Sale Quantity",-1)])]),_:1}),(0,o.bF)(p,null,{default:(0,o.k6)(()=>[(0,o.bF)(g,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{cols:"12"},{default:(0,o.k6)(()=>[(0,o.bF)(d,{modelValue:s.selectedQuantity,"onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedQuantity=e),row:""},{default:(0,o.k6)(()=>[(0,o.bF)(c,{label:"1",value:1}),(0,o.bF)(c,{label:"2",value:2}),(0,o.bF)(c,{label:"3",value:3}),(0,o.bF)(c,{label:"4",value:4}),(0,o.bF)(c,{label:"Custom",value:s.customQuantity},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),s.selectedQuantity===s.customQuantity?((0,o.uX)(),(0,o.Wv)(u,{key:0,cols:"6"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{modelValue:s.customQuantityValue,"onUpdate:modelValue":t[1]||(t[1]=e=>s.customQuantityValue=e),label:"Custom Quantity",type:"number",min:"1",max:s.selectedItem.quantity,outlined:""},null,8,["modelValue","max"])]),_:1})):(0,o.Q3)("",!0),(0,o.bF)(u,{cols:"6"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",le,[(0,o.Lk)("strong",null,"Total Price: "+(0,h.v_)(r.totalPriceDisplay),1)])]),_:1})]),_:1})]),_:1})]),_:1})):(0,o.Q3)("",!0),s.selectedItem?((0,o.uX)(),(0,o.Wv)(f,{key:1,class:"mt-4",elevation:"2"},{default:(0,o.k6)(()=>[(0,o.bF)(p,null,{default:(0,o.k6)(()=>[(0,o.bF)(y,{color:"primary",size:"large",disabled:!r.canSell,loading:s.isSelling,onClick:r.handleSell},{default:(0,o.k6)(()=>[...t[4]||(t[4]=[(0,o.eW)(" Checkout ",-1)])]),_:1},8,["disabled","loading","onClick"]),(0,o.bF)(y,{class:"ml-2",color:"secondary",size:"large",disabled:!r.canSell,loading:s.isAddingToCart,onClick:r.handleAddToCart},{default:(0,o.k6)(()=>[...t[5]||(t[5]=[(0,o.eW)(" Add to Cart ",-1)])]),_:1},8,["disabled","loading","onClick"]),s.sellMessage?((0,o.uX)(),(0,o.Wv)(b,{key:0,type:s.sellMessageType,class:"mt-2"},{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(s.sellMessage),1)]),_:1},8,["type"])):(0,o.Q3)("",!0)]),_:1})]),_:1})):(0,o.Q3)("",!0),(0,o.bF)(v,{items:s.cart.items,loading:s.isCartProcessing,estimates:s.priceEstimates,"total-estimate":s.totalEstimate,message:s.cartMessage,"message-type":s.cartMessageType,onUpdateQty:r.onCartUpdateQty,onRemoveItem:r.onCartRemoveItem,onClear:r.onCartClear,onCheckout:r.onCartCheckout,onRefreshPrices:r.onRefreshEstimates},null,8,["items","loading","estimates","total-estimate","message","message-type","onUpdateQty","onRemoveItem","onClear","onCheckout","onRefreshPrices"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const se={key:2,class:"text-subtitle-1"},re={key:0},ie={key:1,class:"font-weight-bold ml-1"},ne={key:2,class:"ml-4"},ce={key:3,class:"font-weight-bold ml-1"},de={key:4,class:"ml-4"},ue={key:5,class:"font-weight-bold ml-1"};function me(e,t,a,l,s,r){const i=(0,o.g2)("v-expansion-panel-title"),n=(0,o.g2)("ProductSelector"),c=(0,o.g2)("v-expansion-panel-text"),d=(0,o.g2)("v-expansion-panel"),u=(0,o.g2)("ColorSelector"),m=(0,o.g2)("StorageSelector"),g=(0,o.g2)("StoreSelector"),p=(0,o.g2)("v-expansion-panels"),f=(0,o.g2)("v-alert"),y=(0,o.g2)("v-skeleton-loader"),b=(0,o.g2)("v-col"),v=(0,o.g2)("v-row"),k=(0,o.g2)("v-card-text"),F=(0,o.g2)("v-card");return(0,o.uX)(),(0,o.Wv)(F,null,{default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[(0,o.bF)(p,{modelValue:s.activePanel,"onUpdate:modelValue":t[4]||(t[4]=e=>s.activePanel=e),variant:"accordion",class:"mb-4"},{default:(0,o.k6)(()=>[(0,o.bF)(d,null,{default:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[5]||(t[5]=[(0,o.eW)("Product",-1)])]),_:1}),(0,o.bF)(c,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,{modelValue:s.selectedProduct,"onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedProduct=e)},null,8,["modelValue"])]),_:1})]),_:1}),s.selectedProduct?((0,o.uX)(),(0,o.Wv)(d,{key:0},{default:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[6]||(t[6]=[(0,o.eW)("Color",-1)])]),_:1}),(0,o.bF)(c,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{product:s.selectedProduct,modelValue:s.selectedColor,"onUpdate:modelValue":t[1]||(t[1]=e=>s.selectedColor=e)},null,8,["product","modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0),s.selectedColor?((0,o.uX)(),(0,o.Wv)(d,{key:1},{default:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[7]||(t[7]=[(0,o.eW)("Storage",-1)])]),_:1}),(0,o.bF)(c,null,{default:(0,o.k6)(()=>[(0,o.bF)(m,{product:s.selectedProduct,color:s.selectedColor,modelValue:s.selectedStorage,"onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedStorage=e),onOptions:r.onStorageOptions},null,8,["product","color","modelValue","onOptions"])]),_:1})]),_:1})):(0,o.Q3)("",!0),s.selectedColor?((0,o.uX)(),(0,o.Wv)(d,{key:2},{default:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[8]||(t[8]=[(0,o.eW)("Store",-1)])]),_:1}),(0,o.bF)(c,null,{default:(0,o.k6)(()=>[(0,o.bF)(g,{modelValue:s.selectedStore,"onUpdate:modelValue":t[3]||(t[3]=e=>s.selectedStore=e),product:s.selectedProduct,color:s.selectedColor,storage:s.selectedStorage},null,8,["modelValue","product","color","storage"])]),_:1})]),_:1})):(0,o.Q3)("",!0)]),_:1},8,["modelValue"]),(0,o.bF)(v,{class:"mt-2"},{default:(0,o.k6)(()=>[(0,o.bF)(b,{cols:"12",md:"6"},{default:(0,o.k6)(()=>[s.error?((0,o.uX)(),(0,o.Wv)(f,{key:0,type:"error",density:"comfortable"},{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(s.error),1)]),_:1})):s.loading?((0,o.uX)(),(0,o.Wv)(y,{key:1,type:"text"})):((0,o.uX)(),(0,o.CE)("div",se,[s.selectedStore?((0,o.uX)(),(0,o.CE)("span",re,"Quantity:")):(0,o.Q3)("",!0),s.selectedStore?((0,o.uX)(),(0,o.CE)("span",ie,(0,h.v_)(r.quantityDisplay),1)):(0,o.Q3)("",!0),s.selectedStore&&s.selectedStorage?((0,o.uX)(),(0,o.CE)("span",ne,"Storage:")):(0,o.Q3)("",!0),s.selectedStore&&s.selectedStorage?((0,o.uX)(),(0,o.CE)("span",ce,(0,h.v_)(s.selectedStorage)+"GB",1)):(0,o.Q3)("",!0),s.selectedStore&&null!==s.price&&void 0!==s.price?((0,o.uX)(),(0,o.CE)("span",de,"Price:")):(0,o.Q3)("",!0),s.selectedStore&&null!==s.price&&void 0!==s.price?((0,o.uX)(),(0,o.CE)("span",ue,"$"+(0,h.v_)(s.price),1)):(0,o.Q3)("",!0)]))]),_:1})]),_:1})]),_:1})]),_:1})}function ge(e,t,a,l,s,r){const i=(0,o.g2)("v-list-item-title"),n=(0,o.g2)("v-list-item"),c=(0,o.g2)("v-autocomplete");return(0,o.uX)(),(0,o.Wv)(c,{items:s.storeItems,loading:s.loading,"model-value":a.modelValue,"item-title":"label","item-value":"value",label:"Store",placeholder:"Select a store",clearable:"","onUpdate:modelValue":r.onUpdate},{item:(0,o.k6)(({props:e,item:t})=>[(0,o.bF)(n,(0,o.v6)(e,{disabled:!0===t?.raw?.notAvailable,class:t?.raw?.notAvailable?"text-disabled":""}),{default:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(t?.raw?.label),1)]),_:2},1024)]),_:2},1040,["disabled","class"])]),_:1},8,["items","loading","model-value","onUpdate:modelValue"])}a(4114),a(116);const he="inventory";async function pe(){const{data:e,error:t}=await F.from(he).select("name, location").not("name","is",null).not("location","is",null);if(t)throw t;const a=new Set,l=[],o=e=>String(e).trim().replace(/\s+/g," ");for(const s of e){const e=o(s.name),t=o(s.location),r=`${e.toLowerCase()}__${t.toLowerCase()}`;a.has(r)||(a.add(r),l.push({name:e,location:t,label:`${e} — ${t}`}))}return l.sort((e,t)=>e.label.localeCompare(t.label))}async function fe(){const{data:e,error:t}=await F.from(he).select("product").not("product","is",null);if(t)throw t;const a=new Set((e||[]).map(e=>String(e.product).trim().toLowerCase()));return Array.from(a).sort()}async function ye(e){const{data:t,error:a}=await F.from(he).select("color").ilike("product",e).not("color","is",null);if(a)throw a;const l=new Set((t||[]).map(e=>String(e.color).trim().toLowerCase()));return Array.from(l).sort()}async function be(e,t){const{data:a,error:l}=await F.from(he).select("storage").ilike("product",e).ilike("color",t).not("storage","is",null);if(l)throw l;const o=new Set((a||[]).map(e=>String(e.storage).trim()));return Array.from(o).sort((e,t)=>Number(e)-Number(t))}async function ve(e,t,a){let l=F.from(he).select("name, location, quantity").ilike("product",e).ilike("color",t);if(void 0!==a&&null!==a&&""!==a){const e=Number(a);l=Number.isNaN(e)?l.eq("storage",String(a)):l.eq("storage",e)}else l=l.or("storage.is.null,storage.eq.0");const{data:o,error:s}=await l;if(s)throw s;const r=e=>String(e).trim().replace(/\s+/g," "),i=new Map;for(const c of o||[]){const e=r(c.name),t=r(c.location),a=`${e.toLowerCase()}__${t.toLowerCase()}`,l=i.get(a)||0,o=Number(c.quantity);i.set(a,l+(Number.isNaN(o)?0:o))}const n=[];for(const[c,d]of i.entries()){const[e,t]=c.split("__"),a=o.find(a=>r(a.name).toLowerCase()===e&&r(a.location).toLowerCase()===t),l=a?r(a.name):e,s=a?r(a.location):t,i=d>0,u=`${l} — ${s}`,m=i?u:`(no available) ${u}`;n.push({name:l,location:s,label:m,available:i})}return n.sort((e,t)=>e.label.localeCompare(t.label))}async function ke(e,t,a,l){const{name:o,location:s}=e;let r=F.from(he).select("quantity").eq("name",o).eq("location",s).ilike("product",t).ilike("color",a);if(void 0!==l&&null!==l&&""!==l){const e=Number(l);r=Number.isNaN(e)?r.eq("storage",String(l)):r.eq("storage",e)}else r=r.or("storage.is.null,storage.eq.0");const{data:i,error:n}=await r;if(n)throw n;let c=0;for(const d of i||[]){const e=Number(d.quantity);Number.isNaN(e)||(c+=e)}return c}async function Fe(e,t,a,l){const{name:o,location:s}=e;let r=F.from(he).select("price").eq("name",o).eq("location",s).ilike("product",t).ilike("color",a);if(void 0!==l&&null!==l&&""!==l){const e=Number(l);r=Number.isNaN(e)?r.eq("storage",String(l)):r.eq("storage",e)}else r=r.or("storage.is.null,storage.eq.0");const{data:i,error:n}=await r;if(n)throw n;return i&&i.length>0?i[0].price:null}var _e={name:"StoreSelector",props:{modelValue:{type:Object,default:null},product:{type:String,default:""},color:{type:String,default:""},storage:{type:[String,Number],default:""}},data(){return{loading:!1,storeItems:[]}},methods:{onUpdate(e){this.$emit("update:modelValue",e)},async loadStores(){this.loading=!0;try{const e=await pe();console.log("All stores from fetchDistinctStores:",e);let t=new Map;if(this.product&&this.color){const e=await ve(this.product,this.color,this.storage);console.log("Stores from fetchStoresByProductColorStorage:",e);for(const a of e){const e=`${String(a.name).trim().replace(/\s+/g," ").toLowerCase()}__${String(a.location).trim().replace(/\s+/g," ").toLowerCase()}`;t.set(e,{hasProduct:!0,available:a.available})}}const a=(e,t)=>`${String(e).trim().replace(/\s+/g," ").toLowerCase()}__${String(t).trim().replace(/\s+/g," ").toLowerCase()}`,l=new Map;for(const i of e){const e=a(i.name,i.location);if(l.has(e)){console.log("Skipping duplicate store:",i.name,i.location);continue}const o=t.get(e),s=!0===o?.hasProduct,r=!0===o?.available,n=String(i.name).trim().replace(/\s+/g," "),c=String(i.location).trim().replace(/\s+/g," ");let d=`${n} — ${c}`;this.product&&this.color&&(s?r||(d=`(no available) ${d}`):d=`(not available) ${d}`);const u={name:n,location:c},m={label:d,value:u,notAvailable:!(!this.product||!this.color)&&!s};l.set(e,m),console.log("Added store to map:",e,m)}const o=Array.from(l.values());console.log("Final store items:",o);const s=new Set,r=[];for(const i of o){const e=JSON.stringify(i.value);s.has(e)?console.log("Found duplicate value:",i.value):(s.add(e),r.push(i))}console.log("Unique items after deduplication:",r),this.storeItems=r}catch(e){console.error("Failed to load stores",e)}finally{this.loading=!1}}},mounted(){this.loadStores()},watch:{product(){this.loadStores()},color(){this.loadStores()},storage(){this.loadStores()}}};const Se=(0,i.A)(_e,[["render",ge]]);var Ce=Se;function we(e,t,a,l,s,r){const i=(0,o.g2)("v-autocomplete");return(0,o.uX)(),(0,o.Wv)(i,{disabled:!1,items:s.items,loading:s.loading,"model-value":a.modelValue,label:"Product",placeholder:"Select a product",clearable:"","onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("update:modelValue",t))},null,8,["items","loading","model-value"])}var Pe={name:"ProductSelector",props:{modelValue:{type:String,default:""},store:{type:Object,default:null}},data(){return{loading:!1,items:[]}},watch:{modelValue(){}},mounted(){this.load()},methods:{async load(){this.loading=!0;try{const e=await fe();this.items=e.length>0?e:["(not available)"]}catch(e){console.error("Failed to load products",e),this.items=["(not available)"]}finally{this.loading=!1}}}};const xe=(0,i.A)(Pe,[["render",we]]);var Ie=xe;function Re(e,t,a,l,s,r){const i=(0,o.g2)("v-autocomplete");return(0,o.uX)(),(0,o.Wv)(i,{disabled:!a.product,items:s.items,loading:s.loading,"model-value":a.modelValue,label:"Color",placeholder:"Select a color",clearable:"","onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("update:modelValue",t))},null,8,["disabled","items","loading","model-value"])}var We={name:"ColorSelector",props:{modelValue:{type:String,default:""},store:{type:Object,default:null},product:{type:String,default:""}},data(){return{loading:!1,items:[]}},watch:{product:{handler(){this.load()},immediate:!0}},methods:{async load(){if(this.product){this.loading=!0;try{const e=await ye(this.product);this.items=e&&e.length?e:["(not available)"]}catch(e){console.error("Failed to load colors",e),this.items=["(not available)"]}finally{this.loading=!1}}else this.items=[]}}};const Ve=(0,i.A)(We,[["render",Re]]);var Ne=Ve;function De(e,t,a,l,s,r){const i=(0,o.g2)("v-autocomplete");return(0,o.uX)(),(0,o.Wv)(i,{disabled:!a.product||!a.color,items:r.displayItems,loading:s.loading,"model-value":a.modelValue,"item-title":"label","item-value":"value",label:"Storage",placeholder:"Select storage",clearable:"","onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("update:modelValue",t))},null,8,["disabled","items","loading","model-value"])}var Le={name:"StorageSelector",props:{modelValue:{type:[String,Number],default:""},store:{type:Object,default:null},product:{type:String,default:""},color:{type:String,default:""}},emits:["update:modelValue","options"],data(){return{loading:!1,items:[]}},computed:{displayItems(){return this.items.map(e=>"(not available)"===e?{label:"(not available)",value:""}:{label:`${e}GB`,value:e})}},watch:{product:{handler(){this.load()},immediate:!0},color(){this.load()}},methods:{async load(){if(!this.product||!this.color)return this.items=[],void this.$emit("options",0);this.loading=!0;try{const e=await be(this.product,this.color);this.items=e&&e.length?e:["(not available)"],this.$emit("options",this.items.length),0===this.items.length&&this.$emit("update:modelValue","")}catch(e){console.error("Failed to load storages",e),this.items=["(not available)"],this.$emit("options",1)}finally{this.loading=!1}}}};const qe=(0,i.A)(Le,[["render",De]]);var Qe=qe,Ee={name:"InventorySearchPanel",components:{StoreSelector:Ce,ProductSelector:Ie,ColorSelector:Ne,StorageSelector:Qe},emits:["change"],data(){return{selectedStore:null,selectedProduct:"",selectedColor:"",selectedStorage:"",loading:!1,error:"",quantity:null,price:null,storageOptionsCount:0,activePanel:0}},computed:{quantityDisplay(){return null===this.quantity?"-":this.quantity},hasStoreProductColor(){return!!this.selectedStore&&!!this.selectedProduct&&!!this.selectedColor}},watch:{selectedProduct(){this.resetAfterProduct(),this.emitSelection(),this.activePanel=1},selectedColor(){this.resetAfterColor(),this.emitSelection(),this.activePanel=2},selectedStorage(){this.emitSelection(),this.activePanel=3},selectedStore(){this.triggerQuery(),this.activePanel=3}},methods:{onStorageOptions(e){this.storageOptionsCount=e},resetAfterProduct(){this.selectedColor="",this.selectedStorage="",this.selectedStore=null,this.storageOptionsCount=0,this.quantity=null,this.price=null},resetAfterColor(){this.selectedStorage="",this.selectedStore=null,this.storageOptionsCount=0,this.quantity=null,this.price=null},emitSelection(){this.$emit("change",{store:this.selectedStore,product:this.selectedProduct,color:this.selectedColor,storage:this.selectedStorage})},async triggerQuery(){if(this.emitSelection(),!this.selectedStore||!this.selectedProduct||!this.selectedColor)return this.quantity=null,void(this.price=null);this.loading=!0,this.error="";try{const[e,t]=await Promise.all([ke(this.selectedStore,this.selectedProduct,this.selectedColor,this.selectedStorage),Fe(this.selectedStore,this.selectedProduct,this.selectedColor,this.selectedStorage)]);this.quantity=e,this.price=t}catch(e){this.error="Failed to load data",console.error(e)}finally{this.loading=!1}}}};const $e=(0,i.A)(Ee,[["render",me]]);var Te=$e;const Ue={key:0,class:"text-body-2"},Oe={key:0,class:"text-left"},Xe={key:1,class:"text-left"},Me={key:0},Ae={key:1},je={class:"mt-4 d-flex align-center"},ze={class:"text-body-2 mr-2"},Be={key:0};function He(e,t,a,l,s,r){const i=(0,o.g2)("v-spacer"),n=(0,o.g2)("v-btn"),c=(0,o.g2)("v-card-title"),d=(0,o.g2)("v-text-field"),u=(0,o.g2)("v-table"),m=(0,o.g2)("v-alert"),g=(0,o.g2)("v-card-text"),p=(0,o.g2)("v-card");return(0,o.uX)(),(0,o.Wv)(p,{class:"mt-4",elevation:"2"},{default:(0,o.k6)(()=>[(0,o.bF)(c,null,{default:(0,o.k6)(()=>[t[5]||(t[5]=(0,o.eW)(" Cart ",-1)),(0,o.bF)(i),(0,o.bF)(n,{class:"mr-2",color:"primary",variant:"text",disabled:0===a.items.length||a.loading,onClick:t[0]||(t[0]=t=>e.$emit("refresh-prices"))},{default:(0,o.k6)(()=>[...t[3]||(t[3]=[(0,o.eW)("Refresh Prices",-1)])]),_:1},8,["disabled"]),(0,o.bF)(n,{color:"error",variant:"text",disabled:0===a.items.length,onClick:t[1]||(t[1]=t=>e.$emit("clear"))},{default:(0,o.k6)(()=>[...t[4]||(t[4]=[(0,o.eW)("Clear",-1)])]),_:1},8,["disabled"])]),_:1}),(0,o.bF)(g,null,{default:(0,o.k6)(()=>[0===a.items.length?((0,o.uX)(),(0,o.CE)("div",Ue,"Cart is empty")):((0,o.uX)(),(0,o.Wv)(u,{key:1,density:"comfortable"},{default:(0,o.k6)(()=>[(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[t[6]||(t[6]=(0,o.Lk)("th",{class:"text-left"},"Product",-1)),t[7]||(t[7]=(0,o.Lk)("th",{class:"text-left"},"Color",-1)),t[8]||(t[8]=(0,o.Lk)("th",{class:"text-left"},"Storage",-1)),r.hasEstimates?((0,o.uX)(),(0,o.CE)("th",Oe,"Unit Price")):(0,o.Q3)("",!0),r.hasEstimates?((0,o.uX)(),(0,o.CE)("th",Xe,"Subtotal")):(0,o.Q3)("",!0),t[9]||(t[9]=(0,o.Lk)("th",{class:"text-left",style:{width:"140px"}},"Qty",-1)),t[10]||(t[10]=(0,o.Lk)("th",{class:"text-left",style:{width:"80px"}},null,-1))])]),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.items,t=>((0,o.uX)(),(0,o.CE)("tr",{key:t.key},[(0,o.Lk)("td",null,(0,h.v_)(t.product),1),(0,o.Lk)("td",null,(0,h.v_)(t.color),1),(0,o.Lk)("td",null,(0,h.v_)(t.storage||"-"),1),r.hasEstimates?((0,o.uX)(),(0,o.CE)("td",Me,(0,h.v_)(r.displayUnitPrice(t.key)),1)):(0,o.Q3)("",!0),r.hasEstimates?((0,o.uX)(),(0,o.CE)("td",Ae,(0,h.v_)(r.displaySubtotal(t.key,t.quantity)),1)):(0,o.Q3)("",!0),(0,o.Lk)("td",null,[(0,o.bF)(d,{type:"number",min:"1",density:"compact",variant:"outlined","hide-details":"","model-value":t.quantity,"onUpdate:modelValue":e=>r.onUpdateQty(t.key,e)},null,8,["model-value","onUpdate:modelValue"])]),(0,o.Lk)("td",null,[(0,o.bF)(n,{color:"error",variant:"text",icon:"mdi-delete",onClick:a=>e.$emit("remove-item",t.key)},null,8,["onClick"])])]))),128))])]),_:1})),(0,o.Lk)("div",je,[(0,o.Lk)("div",ze,[t[11]||(t[11]=(0,o.eW)(" Prices are estimated and finalized at checkout ",-1)),r.hasEstimates&&null!==a.totalEstimate?((0,o.uX)(),(0,o.CE)("span",Be," — Estimated Total: "+(0,h.v_)(r.displayCurrency(a.totalEstimate)),1)):(0,o.Q3)("",!0)]),(0,o.bF)(i),(0,o.bF)(n,{color:"primary",disabled:0===a.items.length||a.loading,loading:a.loading,onClick:t[2]||(t[2]=t=>e.$emit("checkout"))},{default:(0,o.k6)(()=>[...t[12]||(t[12]=[(0,o.eW)("Checkout Cart",-1)])]),_:1},8,["disabled","loading"])]),a.message?((0,o.uX)(),(0,o.Wv)(m,{key:2,type:a.messageType,class:"mt-3"},{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(a.message),1)]),_:1},8,["type"])):(0,o.Q3)("",!0)]),_:1})]),_:1})}var Je={name:"CartPanel",props:{items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},estimates:{type:Object,default:null},totalEstimate:{type:Number,default:null},message:{type:String,default:""},messageType:{type:String,default:"success"}},emits:["update-qty","remove-item","clear","checkout","refresh-prices"],computed:{hasEstimates(){return!!this.estimates}},methods:{onUpdateQty(e,t){const a=parseInt(t,10);this.$emit("update-qty",{key:e,quantity:Number.isNaN(a)?1:a})},displayCurrency(e){const t=Number(e)||0;return`$${t.toFixed(2)}`},displayUnitPrice(e){return this.estimates&&void 0!==this.estimates[e]&&null!==this.estimates[e]?this.displayCurrency(this.estimates[e]):"-"},displaySubtotal(e,t){if(!this.estimates||void 0===this.estimates[e]||null===this.estimates[e])return"-";const a=Number(this.estimates[e])||0,l=Number(t)||0;return this.displayCurrency(a*l)}}};const Ge=(0,i.A)(Je,[["render",He]]);var Ze=Ge;const Ke="app_cart";function Ye(e){return void 0===e||null===e||""===e?"NULL":String(e)}function et(){try{const e=localStorage.getItem(Ke);if(!e)return{store:null,items:[]};const t=JSON.parse(e);return t&&"object"===typeof t?{store:t.store||null,items:Array.isArray(t.items)?t.items:[]}:{store:null,items:[]}}catch(e){return{store:null,items:[]}}}function tt(e){localStorage.setItem(Ke,JSON.stringify(e))}function at(){const e={store:null,items:[]};return tt(e),e}function lt(e,t,a){if(e.items.length>0){const{name:a,location:l}=e.store||{};if(!t||t.name!==a||t.location!==l)return{cart:e,error:"Cart only allows items from the same store."}}const l=Ye(a.storage),o=`${String(a.product).toLowerCase()}|${String(a.color).toLowerCase()}|${l}`,s={store:0===e.items.length?t:e.store,items:[...e.items]},r=s.items.findIndex(e=>e.key===o);if(r>=0){const e=s.items[r];s.items.splice(r,1,{...e,quantity:Number(e.quantity)+Number(a.quantity)})}else s.items.push({key:o,product:a.product,color:a.color,storage:a.storage,quantity:Number(a.quantity)});return tt(s),{cart:s}}function ot(e,t,a){const l=Math.max(0,Number(a)||0),o={store:e.store,items:e.items.map(e=>e.key===t?{...e,quantity:l}:e)},s={store:o.store,items:o.items.filter(e=>e.quantity>0)};return 0===s.items.length&&(s.store=null),tt(s),s}function st(e,t){const a={store:e.store,items:e.items.filter(e=>e.key!==t)};return 0===a.items.length&&(a.store=null),tt(a),a}function rt(e){return""===e||null===e||void 0===e?null:e}async function it({store:e,product:t,color:a,storage:l}){const{name:o,location:s}=e;let r=F.from("inventory").select("id").eq("name",o).eq("location",s).ilike("product",t).ilike("color",a);const i=rt(l);if(null!==i){const e=Number(i);r=Number.isNaN(e)?r.eq("storage",String(i)):r.eq("storage",e)}else r=r.or("storage.is.null,storage.eq.");const{data:n,error:c}=await r;if(c)throw c;if(!n||0===n.length)throw new Error(`No inventory record found for ${t} ${a} ${l?l+"GB":"no storage"}`);return n[0].id}async function nt({store:e,product:t,color:a,storage:l},o){const{name:s,location:r}=e;let i=F.from("inventory").select("*").eq("name",s).eq("location",r).ilike("product",t).ilike("color",a);const n=rt(l);if(null!==n){const e=Number(n);i=Number.isNaN(e)?i.eq("storage",String(n)):i.eq("storage",e)}else i=i.or("storage.is.null,storage.eq.");const{data:c,error:d}=await i;if(d)throw d;if(!c||0===c.length)throw new Error(`No inventory records found for ${t} ${a} ${l?l+"GB":"no storage"}`);let u=0;for(const g of c)u+=Number(g.quantity)||0;if(u<o)throw new Error(`Insufficient inventory. Available: ${u}, Required: ${o}`);let m=o;for(const g of c){if(m<=0)break;const e=Number(g.quantity)||0,t=Math.min(m,e);if(t>0){const a=e-t,{error:l}=await F.from("inventory").update({quantity:a}).eq("id",g.id).eq("name",g.name).eq("location",g.location);if(l)throw l;m-=t}}if(m>0)throw new Error("Insufficient inventory to complete the sale")}var ct={name:"SellingPage",components:{InventorySearchPanel:Te,CartPanel:Ze},data(){return{selectedItem:null,selectedQuantity:1,customQuantity:"custom",customQuantityValue:1,isSelling:!1,isAddingToCart:!1,sellMessage:"",sellMessageType:"success",cart:{store:null,items:[]},isCartProcessing:!1,cartMessage:"",cartMessageType:"success",priceEstimates:null,totalEstimate:null}},created(){this.cart=et()},computed:{actualQuantity(){return this.selectedQuantity===this.customQuantity?parseInt(this.customQuantityValue)||1:this.selectedQuantity},totalPrice(){return this.selectedItem&&this.selectedItem.price?this.selectedItem.price*this.actualQuantity:0},totalPriceDisplay(){if(!this.selectedItem||!this.selectedItem.price)return"$0";const e=this.selectedItem.price*this.actualQuantity;return`$${e.toFixed(2)}`},canSell(){return this.selectedItem&&this.selectedItem.price&&this.actualQuantity>0&&this.actualQuantity<=(this.selectedItem.quantity||0)}},methods:{async onSelectionChange(e){if(console.log("Selection changed",e),e.store&&e.product&&e.color)try{const t=rt(e.storage),[a,l]=await Promise.all([Fe(e.store,e.product,e.color,t),ke(e.store,e.product,e.color,t)]);this.selectedItem={store:e.store,product:e.product,color:e.color,storage:t,price:a,quantity:l},this.selectedQuantity=1,this.customQuantityValue=1,this.sellMessage=""}catch(t){console.error("Error fetching item details:",t),this.sellMessage="Error fetching product information",this.sellMessageType="error"}else this.selectedItem=null,this.sellMessage=""},handleAddToCart(){if(this.canSell){this.isAddingToCart=!0,this.cartMessage="";try{const e={product:this.selectedItem.product,color:this.selectedItem.color,storage:this.selectedItem.storage,quantity:this.actualQuantity},{cart:t,error:a}=lt(this.cart,this.selectedItem.store,e);a?(this.cartMessage=a,this.cartMessageType="error"):(this.cart=t,this.cartMessage="Added to cart",this.cartMessageType="success")}catch(e){this.cartMessage="Failed to add to cart",this.cartMessageType="error"}finally{this.isAddingToCart=!1}}},async handleSell(){if(this.canSell){this.isSelling=!0,this.sellMessage="";try{const e=await Fe(this.selectedItem.store,this.selectedItem.product,this.selectedItem.color,this.selectedItem.storage),t=await it({store:this.selectedItem.store,product:this.selectedItem.product,color:this.selectedItem.color,storage:this.selectedItem.storage}),a={time:(new Date).toISOString(),id:t,name:this.selectedItem.store.name,product:this.selectedItem.product,price:(e||0)*this.actualQuantity,quantity:this.actualQuantity,store_location:this.selectedItem.store.location,color:this.selectedItem.color,storage:rt(this.selectedItem.storage),unit_price:e};await S(a),await nt({store:this.selectedItem.store,product:this.selectedItem.product,color:this.selectedItem.color,storage:this.selectedItem.storage},this.actualQuantity),this.sellMessage=`Successfully sold ${this.actualQuantity} items for $${(e||0)*this.actualQuantity}`,this.sellMessageType="success";const l=await ke(this.selectedItem.store,this.selectedItem.product,this.selectedItem.color,this.selectedItem.storage);this.selectedItem.quantity=l,this.selectedQuantity=1,this.customQuantityValue=1}catch(e){console.error("Error creating sale:",e),this.sellMessage="Sale failed: "+e.message,this.sellMessageType="error"}finally{this.isSelling=!1}}},onCartUpdateQty({key:e,quantity:t}){this.cart=ot(this.cart,e,t),this.cartMessage=""},onCartRemoveItem(e){this.cart=st(this.cart,e),this.cartMessage=""},onCartClear(){this.cart=at(),this.cartMessage="",this.priceEstimates=null,this.totalEstimate=null},async onCartCheckout(){if(this.cart&&0!==this.cart.items.length){this.isCartProcessing=!0,this.cartMessage="";try{for(const e of this.cart.items){const[t]=await Promise.all([ke(this.cart.store,e.product,e.color,e.storage)]);if(t<e.quantity)return this.cartMessage=`Insufficient inventory for ${e.product} ${e.color} ${e.storage||""}. Available: ${t}, Required: ${e.quantity}`,void(this.cartMessageType="error")}for(const e of this.cart.items){const t=await Fe(this.cart.store,e.product,e.color,e.storage),a=await it({store:this.cart.store,product:e.product,color:e.color,storage:e.storage}),l={time:(new Date).toISOString(),id:a,name:this.cart.store.name,product:e.product,price:(t||0)*e.quantity,quantity:e.quantity,store_location:this.cart.store.location,color:e.color,storage:rt(e.storage),unit_price:t};await S(l),await nt({store:this.cart.store,product:e.product,color:e.color,storage:e.storage},e.quantity)}this.cart=at(),this.cartMessage="Checkout completed.",this.cartMessageType="success"}catch(e){console.error(e),this.cartMessage=`Checkout failed: ${e.message}`,this.cartMessageType="error"}finally{this.isCartProcessing=!1}}},async onRefreshEstimates(){if(!this.cart||0===this.cart.items.length||!this.cart.store)return this.priceEstimates=null,void(this.totalEstimate=null);this.isCartProcessing=!0;try{const e={};let t=0;for(const a of this.cart.items){const l=await Fe(this.cart.store,a.product,a.color,a.storage);e[a.key]=l,t+=(Number(l)||0)*(Number(a.quantity)||0)}this.priceEstimates=e,this.totalEstimate=t}catch(e){console.error(e),this.cartMessage="Failed to refresh prices",this.cartMessageType="error"}finally{this.isCartProcessing=!1}}}};const dt=(0,i.A)(ct,[["render",oe]]);var ut=dt;const mt=[{path:"/",redirect:"/selling"},{path:"/sales-record",name:"SalesRecord",component:J},{path:"/inventory",name:"Inventory",component:ae},{path:"/selling",name:"Selling",component:ut}],gt=(0,g.aE)({history:(0,g.LA)(),routes:mt});var ht=gt;const pt=(0,d.$N)({components:u,directives:m}),ft=(0,l.Ef)(c);ft.use(pt),ft.use(ht),ft.mount("#app")}},t={};function a(l){var o=t[l];if(void 0!==o)return o.exports;var s=t[l]={exports:{}};return e[l].call(s.exports,s,s.exports,a),s.exports}a.m=e,function(){var e=[];a.O=function(t,l,o,s){if(!l){var r=1/0;for(d=0;d<e.length;d++){l=e[d][0],o=e[d][1],s=e[d][2];for(var i=!0,n=0;n<l.length;n++)(!1&s||r>=s)&&Object.keys(a.O).every(function(e){return a.O[e](l[n])})?l.splice(n--,1):(i=!1,s<r&&(r=s));if(i){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[l,o,s]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,l){var o,s,r=l[0],i=l[1],n=l[2],c=0;if(r.some(function(t){return 0!==e[t]})){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(n)var d=n(a)}for(t&&t(l);c<r.length;c++)s=r[c],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(d)},l=self["webpackChunkinventory_management_system"]=self["webpackChunkinventory_management_system"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=a.O(void 0,[504],function(){return a(9581)});l=a.O(l)})();
//# sourceMappingURL=app.f83621fc.js.map