(function(){"use strict";var e={8275:function(e,t,l){var a=l(5130),o=l(6768);function r(e,t,l,a,r,s){const n=(0,o.g2)("v-toolbar-title"),i=(0,o.g2)("v-spacer"),d=(0,o.g2)("v-icon"),c=(0,o.g2)("v-btn"),u=(0,o.g2)("v-app-bar"),m=(0,o.g2)("router-view"),g=(0,o.g2)("v-main"),h=(0,o.g2)("v-app");return(0,o.uX)(),(0,o.Wv)(h,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{color:"primary",dark:"",prominent:""},{default:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[0]||(t[0]=[(0,o.eW)("Distributed Inventory and Sales Management System",-1)])]),_:1}),(0,o.bF)(i),(0,o.bF)(c,{to:{name:"Selling"},color:"white",variant:"text",class:"mr-2"},{default:(0,o.k6)(()=>[(0,o.bF)(d,{left:""},{default:(0,o.k6)(()=>[...t[1]||(t[1]=[(0,o.eW)("mdi-cash-register",-1)])]),_:1}),t[2]||(t[2]=(0,o.eW)(" selling ",-1))]),_:1}),(0,o.bF)(c,{to:{name:"Inventory"},color:"white",variant:"text",class:"mr-2"},{default:(0,o.k6)(()=>[(0,o.bF)(d,{left:""},{default:(0,o.k6)(()=>[...t[3]||(t[3]=[(0,o.eW)("mdi-warehouse",-1)])]),_:1}),t[4]||(t[4]=(0,o.eW)(" Inventory ",-1))]),_:1}),(0,o.bF)(c,{to:{name:"SalesRecord"},color:"white",variant:"text",class:"mr-2"},{default:(0,o.k6)(()=>[(0,o.bF)(d,{left:""},{default:(0,o.k6)(()=>[...t[5]||(t[5]=[(0,o.eW)("mdi-chart-line",-1)])]),_:1}),t[6]||(t[6]=(0,o.eW)(" sales record ",-1))]),_:1}),(0,o.bF)(c,{icon:""},{default:(0,o.k6)(()=>[(0,o.bF)(d,null,{default:(0,o.k6)(()=>[...t[7]||(t[7]=[(0,o.eW)("mdi-account",-1)])]),_:1})]),_:1})]),_:1}),(0,o.bF)(g,null,{default:(0,o.k6)(()=>[(0,o.bF)(m)]),_:1})]),_:1})}var s={name:"App"},n=l(1241);const i=(0,n.A)(s,[["render",r]]);var d=i,c=l(5753),u=(l(5524),l(2801)),m=l(3425),g=l(1387),h=l(4232);function f(e,t,l,a,r,s){const n=(0,o.g2)("v-icon"),i=(0,o.g2)("v-spacer"),d=(0,o.g2)("v-btn"),c=(0,o.g2)("v-card-title"),u=(0,o.g2)("v-card-text"),m=(0,o.g2)("v-card"),g=(0,o.g2)("SalesRecordFilters"),f=(0,o.g2)("SalesRecordList"),p=(0,o.g2)("v-col"),b=(0,o.g2)("v-row"),v=(0,o.g2)("v-card-actions"),y=(0,o.g2)("v-dialog"),k=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(k,{fluid:""},{default:(0,o.k6)(()=>[(0,o.bF)(b,null,{default:(0,o.k6)(()=>[(0,o.bF)(p,{cols:"12"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{class:"mb-4"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{class:"d-flex align-center"},{default:(0,o.k6)(()=>[(0,o.bF)(n,{left:"",size:"large",color:"primary"},{default:(0,o.k6)(()=>[...t[2]||(t[2]=[(0,o.eW)("mdi-chart-line",-1)])]),_:1}),t[5]||(t[5]=(0,o.Lk)("h1",{class:"text-h4"},"Sales Records Query",-1)),(0,o.bF)(i),(0,o.bF)(d,{color:"primary",variant:"outlined",onClick:s.refreshData,loading:r.isRefreshing},{default:(0,o.k6)(()=>[(0,o.bF)(n,{left:""},{default:(0,o.k6)(()=>[...t[3]||(t[3]=[(0,o.eW)("mdi-refresh",-1)])]),_:1}),t[4]||(t[4]=(0,o.eW)(" Refresh Data ",-1))]),_:1},8,["onClick","loading"])]),_:1}),(0,o.bF)(u,null,{default:(0,o.k6)(()=>[...t[6]||(t[6]=[(0,o.Lk)("p",{class:"text-body-1 text-grey-darken-1"}," View and manage all sales records with filtering by date, product, and store ",-1)])]),_:1})]),_:1}),(0,o.bF)(g,{onFiltersChange:s.onFiltersChange,onError:s.onFilterError,class:"mb-4"},null,8,["onFiltersChange","onError"]),(0,o.bF)(f,{"sales-records":r.salesRecords,stats:r.salesStats,loading:r.loading,error:r.error},null,8,["sales-records","stats","loading","error"])]),_:1})]),_:1}),(0,o.bF)(y,{modelValue:r.showErrorDialog,"onUpdate:modelValue":t[1]||(t[1]=e=>r.showErrorDialog=e),"max-width":"500px"},{default:(0,o.k6)(()=>[(0,o.bF)(m,null,{default:(0,o.k6)(()=>[(0,o.bF)(c,{class:"text-h5 text-error"},{default:(0,o.k6)(()=>[(0,o.bF)(n,{left:"",color:"error"},{default:(0,o.k6)(()=>[...t[7]||(t[7]=[(0,o.eW)("mdi-alert-circle",-1)])]),_:1}),t[8]||(t[8]=(0,o.eW)(" Error ",-1))]),_:1}),(0,o.bF)(u,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(r.errorDialogMessage),1)]),_:1}),(0,o.bF)(v,null,{default:(0,o.k6)(()=>[(0,o.bF)(i),(0,o.bF)(d,{color:"primary",onClick:t[0]||(t[0]=e=>r.showErrorDialog=!1)},{default:(0,o.k6)(()=>[...t[9]||(t[9]=[(0,o.eW)("OK",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}function p(e,t,l,a,r,s){const n=(0,o.g2)("v-icon"),i=(0,o.g2)("v-card-title"),d=(0,o.g2)("v-select"),c=(0,o.g2)("v-col"),u=(0,o.g2)("v-date-picker"),m=(0,o.g2)("v-text-field"),g=(0,o.g2)("v-combobox"),h=(0,o.g2)("v-row"),f=(0,o.g2)("v-btn"),p=(0,o.g2)("v-card-text"),b=(0,o.g2)("v-spacer"),v=(0,o.g2)("v-card-actions"),y=(0,o.g2)("v-card"),k=(0,o.g2)("v-dialog");return(0,o.uX)(),(0,o.Wv)(y,null,{default:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,{left:""},{default:(0,o.k6)(()=>[...t[9]||(t[9]=[(0,o.eW)("mdi-filter",-1)])]),_:1}),t[10]||(t[10]=(0,o.eW)(" Filter Conditions ",-1))]),_:1}),(0,o.bF)(p,null,{default:(0,o.k6)(()=>[(0,o.bF)(h,null,{default:(0,o.k6)(()=>[(0,o.bF)(c,{cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(d,{modelValue:r.dateFilterType,"onUpdate:modelValue":t[0]||(t[0]=e=>r.dateFilterType=e),items:r.dateFilterOptions,label:"Date Filter Type",outlined:"",dense:"",onChange:s.onDateFilterTypeChange},null,8,["modelValue","items","onChange"])]),_:1}),"single"===r.dateFilterType?((0,o.uX)(),(0,o.Wv)(c,{key:0,cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:r.singleDate,"onUpdate:modelValue":[t[1]||(t[1]=e=>r.singleDate=e),s.onDateChange],color:"primary","show-adjacent-months":"",max:(new Date).toISOString().split("T")[0]},null,8,["modelValue","onUpdate:modelValue","max"])]),_:1})):(0,o.Q3)("",!0),"range"===r.dateFilterType?((0,o.uX)(),(0,o.Wv)(c,{key:1,cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{modelValue:r.dateRangeText,"onUpdate:modelValue":t[2]||(t[2]=e=>r.dateRangeText=e),label:"Date Range",placeholder:"Select start and end date",outlined:"",dense:"",readonly:"","append-icon":"mdi-calendar",onClick:t[3]||(t[3]=e=>r.showDateRangePicker=!0)},null,8,["modelValue"])]),_:1})):(0,o.Q3)("",!0),(0,o.bF)(c,{cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(g,{modelValue:r.selectedProducts,"onUpdate:modelValue":[t[4]||(t[4]=e=>r.selectedProducts=e),s.onFiltersChange],items:r.availableProducts,loading:r.loadingProducts,label:"Product Filter",placeholder:"Select products",outlined:"",dense:"",multiple:"",chips:"",clearable:""},null,8,["modelValue","items","loading","onUpdate:modelValue"])]),_:1}),(0,o.bF)(c,{cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(g,{modelValue:r.selectedStoreNames,"onUpdate:modelValue":[t[5]||(t[5]=e=>r.selectedStoreNames=e),s.onFiltersChange],items:r.availableStoreNames,loading:r.loadingStoreNames,label:"Store Filter",placeholder:"Select stores",outlined:"",dense:"",multiple:"",chips:"",clearable:""},null,8,["modelValue","items","loading","onUpdate:modelValue"])]),_:1})]),_:1}),(0,o.bF)(h,{class:"mt-2"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{cols:"12",class:"text-right"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{color:"secondary",onClick:s.resetFilters,class:"mr-2"},{default:(0,o.k6)(()=>[(0,o.bF)(n,{left:""},{default:(0,o.k6)(()=>[...t[11]||(t[11]=[(0,o.eW)("mdi-refresh",-1)])]),_:1}),t[12]||(t[12]=(0,o.eW)(" Reset ",-1))]),_:1},8,["onClick"]),(0,o.bF)(f,{color:"primary",onClick:s.applyFilters,loading:r.loading},{default:(0,o.k6)(()=>[(0,o.bF)(n,{left:""},{default:(0,o.k6)(()=>[...t[13]||(t[13]=[(0,o.eW)("mdi-magnify",-1)])]),_:1}),t[14]||(t[14]=(0,o.eW)(" Search ",-1))]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1}),(0,o.bF)(k,{modelValue:r.showDateRangePicker,"onUpdate:modelValue":t[8]||(t[8]=e=>r.showDateRangePicker=e),"max-width":"400px"},{default:(0,o.k6)(()=>[(0,o.bF)(y,null,{default:(0,o.k6)(()=>[(0,o.bF)(i,null,{default:(0,o.k6)(()=>[...t[15]||(t[15]=[(0,o.eW)("Select Date Range",-1)])]),_:1}),(0,o.bF)(p,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:r.dateRange,"onUpdate:modelValue":[t[6]||(t[6]=e=>r.dateRange=e),s.onDateRangeChange],range:"",color:"primary","show-adjacent-months":"",max:(new Date).toISOString().split("T")[0]},null,8,["modelValue","onUpdate:modelValue","max"])]),_:1}),(0,o.bF)(v,null,{default:(0,o.k6)(()=>[(0,o.bF)(b),(0,o.bF)(f,{text:"",onClick:t[7]||(t[7]=e=>r.showDateRangePicker=!1)},{default:(0,o.k6)(()=>[...t[16]||(t[16]=[(0,o.eW)("Cancel",-1)])]),_:1}),(0,o.bF)(f,{color:"primary",onClick:s.confirmDateRange},{default:(0,o.k6)(()=>[...t[17]||(t[17]=[(0,o.eW)("Confirm",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}l(8111),l(1701),l(8237),l(7642),l(8004),l(3853),l(5876),l(2475),l(5024),l(1698);var b=l(1300);const v="https://obhzromrgwodaxsjlgfs.supabase.co",y="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9iaHpyb21yZ3dvZGF4c2psZ2ZzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2NDg1NTgsImV4cCI6MjA3NDIyNDU1OH0.7gjEbFfzzXOTxt3fhnBxEfSqKtazQ_5ywY4i_I84O-E";v&&y||console.error("[Supabase] Missing SUPABASE_URL or SUPABASE_ANON_KEY environment variables");const k=(0,b.UU)(v||"",y||"");var F=k;const _="sales";async function S(e){const{data:t,error:l}=await F.from(_).insert([e]).select();if(l)throw l;return t}async function w(e){let t=F.from(_).select("*");if(e.dateRange)if(1===e.dateRange.length){const l=new Date(e.dateRange[0]);l.setHours(0,0,0,0);const a=new Date(e.dateRange[0]);a.setHours(23,59,59,999),t=t.gte("time",l.toISOString()).lte("time",a.toISOString())}else if(2===e.dateRange.length){const l=new Date(e.dateRange[0]);l.setHours(0,0,0,0);const a=new Date(e.dateRange[1]);a.setHours(23,59,59,999),t=t.gte("time",l.toISOString()).lte("time",a.toISOString())}e.products&&e.products.length>0&&(t=t.in("product",e.products)),e.storeNames&&e.storeNames.length>0&&(t=t.in("name",e.storeNames)),t=t.order("time",{ascending:!1}),e.limit&&(t=t.limit(e.limit)),e.offset&&(t=t.range(e.offset,e.offset+(e.limit||20)-1));const{data:l,error:a}=await t;if(a)throw a;return l}async function V(){const{data:e,error:t}=await F.from(_).select("product").order("product");if(t)throw t;const l=[...new Set(e.map(e=>e.product))];return l}async function x(){const{data:e,error:t}=await F.from(_).select("name").order("name");if(t)throw t;const l=[...new Set(e.map(e=>e.name))];return l}async function P(e={}){let t=F.from(_).select("price, quantity");if(e.dateRange)if(1===e.dateRange.length){const l=new Date(e.dateRange[0]);l.setHours(0,0,0,0);const a=new Date(e.dateRange[0]);a.setHours(23,59,59,999),t=t.gte("time",l.toISOString()).lte("time",a.toISOString())}else if(2===e.dateRange.length){const l=new Date(e.dateRange[0]);l.setHours(0,0,0,0);const a=new Date(e.dateRange[1]);a.setHours(23,59,59,999),t=t.gte("time",l.toISOString()).lte("time",a.toISOString())}e.products&&e.products.length>0&&(t=t.in("product",e.products)),e.storeNames&&e.storeNames.length>0&&(t=t.in("name",e.storeNames));const{data:l,error:a}=await t;if(a)throw a;const o=l.length,r=l.reduce((e,t)=>e+(t.price||0),0),s=l.reduce((e,t)=>e+(t.quantity||0),0);return{totalRecords:o,totalRevenue:r,totalQuantity:s}}var R={name:"SalesRecordFilters",emits:["filters-change"],data(){return{dateFilterType:"none",dateFilterOptions:[{title:"No Date Filter",value:"none"},{title:"Select Single Date",value:"single"},{title:"Select Date Range",value:"range"}],singleDate:null,dateRange:[],dateRangeText:"",showDateRangePicker:!1,selectedProducts:[],selectedStoreNames:[],availableProducts:[],availableStoreNames:[],loadingProducts:!1,loadingStoreNames:!1,loading:!1}},mounted(){this.loadFilterOptions()},methods:{async loadFilterOptions(){this.loadingProducts=!0,this.loadingStoreNames=!0;try{const[e,t]=await Promise.all([V(),x()]);this.availableProducts=e,this.availableStoreNames=t}catch(e){console.error("Failed to load filter options:",e),this.$emit("error","Failed to load filter options")}finally{this.loadingProducts=!1,this.loadingStoreNames=!1}},onDateFilterTypeChange(){this.resetDateFilters(),this.onFiltersChange()},onDateChange(){this.onFiltersChange()},onDateRangeChange(){},confirmDateRange(){this.dateRange&&this.dateRange.length>0&&(1===this.dateRange.length?this.dateRangeText=this.formatDate(this.dateRange[0]):2===this.dateRange.length&&(this.dateRangeText=`${this.formatDate(this.dateRange[0])} - ${this.formatDate(this.dateRange[1])}`)),this.showDateRangePicker=!1,this.onFiltersChange()},formatDate(e){return e?new Date(e).toLocaleDateString("en-US"):""},onFiltersChange(){this.emitFilters()},emitFilters(){const e={dateRange:this.getDateRangeFilter(),products:this.selectedProducts,storeNames:this.selectedStoreNames};this.$emit("filters-change",e)},getDateRangeFilter(){return"single"===this.dateFilterType&&this.singleDate?[this.singleDate]:"range"===this.dateFilterType&&this.dateRange.length>0?this.dateRange:null},applyFilters(){this.loading=!0,this.emitFilters(),setTimeout(()=>{this.loading=!1},500)},resetFilters(){this.dateFilterType="none",this.singleDate=null,this.dateRange=[],this.dateRangeText="",this.selectedProducts=[],this.selectedStoreNames=[],this.emitFilters()},resetDateFilters(){this.singleDate=null,this.dateRange=[],this.dateRangeText=""}}};const C=(0,n.A)(R,[["render",p],["__scopeId","data-v-5827b50c"]]);var W=C;const I={class:"text-h6"},D={class:"text-h6"},N={class:"text-h6"},Q={key:1,class:"text-center py-8"},q={key:3,class:"text-center py-8"},L={key:4},O={class:"ml-2"},T={class:"font-weight-medium"},U={class:"font-weight-medium"},X={class:"font-weight-medium"},$={class:"font-weight-bold text-primary"},E={class:"text-caption"};function A(e,t,l,a,r,s){const n=(0,o.g2)("v-icon"),i=(0,o.g2)("v-spacer"),d=(0,o.g2)("v-chip"),c=(0,o.g2)("v-card-title"),u=(0,o.g2)("v-card-text"),m=(0,o.g2)("v-card"),g=(0,o.g2)("v-col"),f=(0,o.g2)("v-row"),p=(0,o.g2)("v-progress-circular"),b=(0,o.g2)("v-alert"),v=(0,o.g2)("v-expansion-panel-title"),y=(0,o.g2)("v-divider"),k=(0,o.g2)("v-list-item-title"),F=(0,o.g2)("v-list-item-subtitle"),_=(0,o.g2)("v-list-item"),S=(0,o.g2)("v-list"),w=(0,o.g2)("v-expansion-panel-text"),V=(0,o.g2)("v-expansion-panel"),x=(0,o.g2)("v-expansion-panels"),P=(0,o.g2)("v-pagination");return(0,o.uX)(),(0,o.Wv)(m,null,{default:(0,o.k6)(()=>[(0,o.bF)(c,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,{left:""},{default:(0,o.k6)(()=>[...t[2]||(t[2]=[(0,o.eW)("mdi-format-list-bulleted",-1)])]),_:1}),t[3]||(t[3]=(0,o.eW)(" Sales Records ",-1)),(0,o.bF)(i),(0,o.bF)(d,{color:"primary",variant:"outlined"},{default:(0,o.k6)(()=>[(0,o.eW)(" Total "+(0,h.v_)(s.totalRecords)+" Records ",1)]),_:1})]),_:1}),(0,o.bF)(u,null,{default:(0,o.k6)(()=>[l.stats?((0,o.uX)(),(0,o.Wv)(f,{key:0,class:"mb-4"},{default:(0,o.k6)(()=>[(0,o.bF)(g,{cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{color:"primary",variant:"tonal"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"text-center"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",I,(0,h.v_)(l.stats.totalRecords),1),t[4]||(t[4]=(0,o.Lk)("div",{class:"text-caption"},"Total Records",-1))]),_:1})]),_:1})]),_:1}),(0,o.bF)(g,{cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{color:"success",variant:"tonal"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"text-center"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",D,"$"+(0,h.v_)(l.stats.totalRevenue.toLocaleString()),1),t[5]||(t[5]=(0,o.Lk)("div",{class:"text-caption"},"Total Revenue",-1))]),_:1})]),_:1})]),_:1}),(0,o.bF)(g,{cols:"12",md:"4"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{color:"info",variant:"tonal"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{class:"text-center"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",N,(0,h.v_)(l.stats.totalQuantity),1),t[6]||(t[6]=(0,o.Lk)("div",{class:"text-caption"},"Total Quantity",-1))]),_:1})]),_:1})]),_:1})]),_:1})):(0,o.Q3)("",!0),l.loading?((0,o.uX)(),(0,o.CE)("div",Q,[(0,o.bF)(p,{indeterminate:"",color:"primary",size:"64"}),t[7]||(t[7]=(0,o.Lk)("div",{class:"mt-2"},"Loading...",-1))])):l.error?((0,o.uX)(),(0,o.Wv)(b,{key:2,type:"error",class:"mb-4"},{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(l.error),1)]),_:1})):0===l.salesRecords.length?((0,o.uX)(),(0,o.CE)("div",q,[(0,o.bF)(n,{size:"64",color:"grey"},{default:(0,o.k6)(()=>[...t[8]||(t[8]=[(0,o.eW)("mdi-inbox-outline",-1)])]),_:1}),t[9]||(t[9]=(0,o.Lk)("div",{class:"text-h6 mt-2"},"No Sales Records Found",-1)),t[10]||(t[10]=(0,o.Lk)("div",{class:"text-body-2 text-grey"},"Please adjust filter conditions or check data",-1))])):((0,o.uX)(),(0,o.CE)("div",L,[(0,o.bF)(x,{modelValue:r.expandedPanels,"onUpdate:modelValue":t[0]||(t[0]=e=>r.expandedPanels=e),multiple:""},{default:(0,o.k6)(()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.paginatedRecords,(e,l)=>((0,o.uX)(),(0,o.Wv)(V,{key:e.id||l,value:l},{default:(0,o.k6)(()=>[(0,o.bF)(v,null,{default:(0,o.k6)(({expanded:l})=>[(0,o.bF)(f,{"no-gutters":""},{default:(0,o.k6)(()=>[(0,o.bF)(g,{cols:"12",md:"3"},{default:(0,o.k6)(()=>[(0,o.bF)(n,{icon:l?"mdi-chevron-up":"mdi-chevron-down"},null,8,["icon"]),(0,o.Lk)("span",O,(0,h.v_)(e.product),1)]),_:2},1024),(0,o.bF)(g,{cols:"12",md:"2"},{default:(0,o.k6)(()=>[t[11]||(t[11]=(0,o.Lk)("span",{class:"text-caption text-grey"},"Store:",-1)),(0,o.Lk)("div",T,(0,h.v_)(e.name),1)]),_:2},1024),(0,o.bF)(g,{cols:"12",md:"2"},{default:(0,o.k6)(()=>[t[12]||(t[12]=(0,o.Lk)("span",{class:"text-caption text-grey"},"Qty:",-1)),(0,o.Lk)("div",U,(0,h.v_)(e.quantity),1)]),_:2},1024),(0,o.bF)(g,{cols:"12",md:"2"},{default:(0,o.k6)(()=>[t[13]||(t[13]=(0,o.Lk)("span",{class:"text-caption text-grey"},"Unit:",-1)),(0,o.Lk)("div",X,"$"+(0,h.v_)(e.unit_price),1)]),_:2},1024),(0,o.bF)(g,{cols:"12",md:"2"},{default:(0,o.k6)(()=>[t[14]||(t[14]=(0,o.Lk)("span",{class:"text-caption text-grey"},"Total:",-1)),(0,o.Lk)("div",$,"$"+(0,h.v_)(e.price),1)]),_:2},1024),(0,o.bF)(g,{cols:"12",md:"1"},{default:(0,o.k6)(()=>[t[15]||(t[15]=(0,o.Lk)("span",{class:"text-caption text-grey"},"Time:",-1)),(0,o.Lk)("div",E,(0,h.v_)(s.formatDate(e.time)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,o.bF)(w,null,{default:(0,o.k6)(()=>[(0,o.bF)(y,{class:"mb-3"}),(0,o.bF)(f,null,{default:(0,o.k6)(()=>[(0,o.bF)(g,{cols:"12",md:"6"},{default:(0,o.k6)(()=>[(0,o.bF)(S,{density:"compact"},{default:(0,o.k6)(()=>[(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[16]||(t[16]=[(0,o.eW)("mdi-store",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[17]||(t[17]=[(0,o.eW)("Store Name",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(e.name),1)]),_:2},1024)]),_:2},1024),(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[18]||(t[18]=[(0,o.eW)("mdi-map-marker",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[19]||(t[19]=[(0,o.eW)("Store Location",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(e.store_location),1)]),_:2},1024)]),_:2},1024),(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[20]||(t[20]=[(0,o.eW)("mdi-package-variant",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[21]||(t[21]=[(0,o.eW)("Product",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(e.product),1)]),_:2},1024)]),_:2},1024),(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[22]||(t[22]=[(0,o.eW)("mdi-palette",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[23]||(t[23]=[(0,o.eW)("Color",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(e.color),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,o.bF)(g,{cols:"12",md:"6"},{default:(0,o.k6)(()=>[(0,o.bF)(S,{density:"compact"},{default:(0,o.k6)(()=>[e.storage?((0,o.uX)(),(0,o.Wv)(_,{key:0},{prepend:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[24]||(t[24]=[(0,o.eW)("mdi-memory",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[25]||(t[25]=[(0,o.eW)("Storage",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(e.storage)+"GB",1)]),_:2},1024)]),_:2},1024)):(0,o.Q3)("",!0),(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[26]||(t[26]=[(0,o.eW)("mdi-numeric",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[27]||(t[27]=[(0,o.eW)("Quantity",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(e.quantity),1)]),_:2},1024)]),_:2},1024),(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[28]||(t[28]=[(0,o.eW)("mdi-currency-usd",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[29]||(t[29]=[(0,o.eW)("Unit Price",-1)])]),_:1}),(0,o.bF)(F,null,{default:(0,o.k6)(()=>[(0,o.eW)("$"+(0,h.v_)(e.unit_price),1)]),_:2},1024)]),_:2},1024),(0,o.bF)(_,null,{prepend:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[30]||(t[30]=[(0,o.eW)("mdi-calculator",-1)])]),_:1})]),default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[...t[31]||(t[31]=[(0,o.eW)("Total Price",-1)])]),_:1}),(0,o.bF)(F,{class:"text-h6 text-primary"},{default:(0,o.k6)(()=>[(0,o.eW)("$"+(0,h.v_)(e.price),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,o.bF)(y,{class:"mt-3"}),(0,o.bF)(f,{class:"mt-2"},{default:(0,o.k6)(()=>[(0,o.bF)(g,{cols:"12",class:"text-right"},{default:(0,o.k6)(()=>[(0,o.bF)(d,{color:"grey",variant:"outlined",size:"small"},{default:(0,o.k6)(()=>[(0,o.bF)(n,{start:""},{default:(0,o.k6)(()=>[...t[32]||(t[32]=[(0,o.eW)("mdi-clock",-1)])]),_:1}),(0,o.eW)(" Sale Time: "+(0,h.v_)(s.formatDateTime(e.time)),1)]),_:2},1024),(0,o.bF)(d,{color:"grey",variant:"outlined",size:"small",class:"ml-2"},{default:(0,o.k6)(()=>[(0,o.bF)(n,{start:""},{default:(0,o.k6)(()=>[...t[33]||(t[33]=[(0,o.eW)("mdi-identifier",-1)])]),_:1}),(0,o.eW)(" ID: "+(0,h.v_)(e.id),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s.totalPages>1?((0,o.uX)(),(0,o.Wv)(P,{key:0,modelValue:r.currentPage,"onUpdate:modelValue":[t[1]||(t[1]=e=>r.currentPage=e),s.onPageChange],length:s.totalPages,"total-visible":7,class:"mt-4"},null,8,["modelValue","length","onUpdate:modelValue"])):(0,o.Q3)("",!0)]))]),_:1})]),_:1})}var M={name:"SalesRecordList",props:{salesRecords:{type:Array,default:()=>[]},stats:{type:Object,default:null},loading:{type:Boolean,default:!1},error:{type:String,default:""}},data(){return{currentPage:1,itemsPerPage:20,expandedPanels:[]}},computed:{totalRecords(){return this.salesRecords.length},totalPages(){return Math.ceil(this.totalRecords/this.itemsPerPage)},paginatedRecords(){const e=(this.currentPage-1)*this.itemsPerPage,t=e+this.itemsPerPage;return this.salesRecords.slice(e,t)}},watch:{salesRecords(){this.currentPage=1,this.expandedPanels=[]}},methods:{formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString("en-US")},formatDateTime(e){if(!e)return"";const t=new Date(e);return t.toLocaleString("en-US")},onPageChange(e){this.currentPage=e,this.$nextTick(()=>{const e=this.$el.querySelector(".v-card");e&&e.scrollIntoView({behavior:"smooth"})})},expandAll(){this.expandedPanels=Array.from({length:this.paginatedRecords.length},(e,t)=>t)},collapseAll(){this.expandedPanels=[]}}};const j=(0,n.A)(M,[["render",A],["__scopeId","data-v-1232b3a8"]]);var z=j,B={name:"SalesRecord",components:{SalesRecordFilters:W,SalesRecordList:z},data(){return{salesRecords:[],salesStats:null,loading:!1,isRefreshing:!1,error:"",showErrorDialog:!1,errorDialogMessage:"",currentFilters:{}}},async mounted(){await this.loadSalesData()},methods:{async onFiltersChange(e){this.currentFilters=e,await this.loadSalesData(e)},async loadSalesData(e={}){this.loading=!0,this.error="";try{const[t,l]=await Promise.all([w(e),P(e)]);this.salesRecords=t,this.salesStats=l,0===t.length&&Object.keys(e).length>0&&(this.error="No sales records found matching the criteria. Please try adjusting the filter conditions")}catch(t){console.error("Failed to load sales data:",t),this.error="Failed to load sales records: "+t.message,this.salesRecords=[],this.salesStats=null}finally{this.loading=!1}},async refreshData(){this.isRefreshing=!0;try{await this.loadSalesData(this.currentFilters)}finally{this.isRefreshing=!1}},onFilterError(e){this.errorDialogMessage=e,this.showErrorDialog=!0}}};const H=(0,n.A)(B,[["render",f],["__scopeId","data-v-5fb0bc80"]]);var G=H;const J={key:0},Z={key:1};function K(e,t,l,a,r,s){const n=(0,o.g2)("v-card-title"),i=(0,o.g2)("v-text-field"),d=(0,o.g2)("v-col"),c=(0,o.g2)("v-row"),u=(0,o.g2)("v-data-table"),m=(0,o.g2)("v-card-text"),g=(0,o.g2)("v-card"),f=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(f,{fluid:""},{default:(0,o.k6)(()=>[(0,o.bF)(c,null,{default:(0,o.k6)(()=>[(0,o.bF)(d,{cols:"12"},{default:(0,o.k6)(()=>[(0,o.bF)(g,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[5]||(t[5]=[(0,o.Lk)("h1",{class:"text-h4"},"Inventory",-1)])]),_:1}),(0,o.bF)(m,null,{default:(0,o.k6)(()=>[(0,o.bF)(c,{class:"mb-4",dense:""},{default:(0,o.k6)(()=>[(0,o.bF)(d,{cols:"12",sm:"6",md:"3"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{modelValue:r.idFilter,"onUpdate:modelValue":t[0]||(t[0]=e=>r.idFilter=e),label:"ID",clearable:"",density:"comfortable"},null,8,["modelValue"])]),_:1}),(0,o.bF)(d,{cols:"12",sm:"6",md:"3"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{modelValue:r.productFilter,"onUpdate:modelValue":t[1]||(t[1]=e=>r.productFilter=e),label:"Product",clearable:"",density:"comfortable"},null,8,["modelValue"])]),_:1}),(0,o.bF)(d,{cols:"12",sm:"6",md:"3"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{modelValue:r.nameFilter,"onUpdate:modelValue":t[2]||(t[2]=e=>r.nameFilter=e),label:"Store Name",clearable:"",density:"comfortable"},null,8,["modelValue"])]),_:1}),(0,o.bF)(d,{cols:"12",sm:"6",md:"3"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{modelValue:r.locationFilter,"onUpdate:modelValue":t[3]||(t[3]=e=>r.locationFilter=e),label:"Store Location",clearable:"",density:"comfortable"},null,8,["modelValue"])]),_:1})]),_:1}),(0,o.bF)(u,{headers:r.headers,items:s.filteredProducts,"sort-by":r.sortBy,"onUpdate:sortBy":t[4]||(t[4]=e=>r.sortBy=e)},{["item.price"]:(0,o.k6)(({item:e})=>[null!==e.price&&void 0!==e.price?((0,o.uX)(),(0,o.CE)("span",J," $"+(0,h.v_)(e.price),1)):((0,o.uX)(),(0,o.CE)("span",Z,"-"))]),_:2},1032,["headers","items","sort-by"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}l(2489);const Y="inventory";var ee={name:"InventoryPage",data(){return{headers:[{title:"ID",value:"id"},{title:"Product",value:"product"},{title:"Color",value:"color"},{title:"Storage",value:"storage"},{title:"Stock Quantity",value:"quantity"},{title:"Price",value:"price"},{title:"Store Name",value:"name"},{title:"Store Location",value:"location"},{title:"Update Time",value:"UpdateTime"}],products:[],idFilter:"",productFilter:"",nameFilter:"",locationFilter:"",sortBy:[{key:"name",order:"asc"}]}},computed:{filteredProducts(){const e=String(this.idFilter||"").trim().toLowerCase(),t=String(this.productFilter||"").trim().toLowerCase(),l=String(this.nameFilter||"").trim().toLowerCase(),a=String(this.locationFilter||"").trim().toLowerCase();return e||t||l||a?(this.products||[]).filter(o=>{const r=o&&void 0!==o.id&&null!==o.id?String(o.id).toLowerCase():"",s=o&&o.product?String(o.product).toLowerCase():"",n=o&&o.name?String(o.name).toLowerCase():"",i=o&&o.location?String(o.location).toLowerCase():"",d=!e||r.includes(e),c=!t||s.includes(t),u=!l||n.includes(l),m=!a||i.includes(a);return d&&c&&u&&m}):this.products}},async mounted(){try{const{data:e,error:t}=await F.from(Y).select("*");if(t)throw t;this.products=e}catch(e){console.error("Error fetching data:",e)}}};const te=(0,n.A)(ee,[["render",K]]);var le=te;const ae={class:"text-h6"};function oe(e,t,l,a,r,s){const n=(0,o.g2)("v-card-title"),i=(0,o.g2)("InventorySearchPanel"),d=(0,o.g2)("v-radio"),c=(0,o.g2)("v-radio-group"),u=(0,o.g2)("v-col"),m=(0,o.g2)("v-text-field"),g=(0,o.g2)("v-row"),f=(0,o.g2)("v-card-text"),p=(0,o.g2)("v-card"),b=(0,o.g2)("v-btn"),v=(0,o.g2)("v-alert"),y=(0,o.g2)("v-container");return(0,o.uX)(),(0,o.Wv)(y,{fluid:""},{default:(0,o.k6)(()=>[(0,o.bF)(g,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{cols:"12"},{default:(0,o.k6)(()=>[(0,o.bF)(p,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[2]||(t[2]=[(0,o.Lk)("h1",{class:"text-h4"},"Selling",-1)])]),_:1}),(0,o.bF)(f,null,{default:(0,o.k6)(()=>[(0,o.bF)(i,{onChange:s.onSelectionChange},null,8,["onChange"]),r.selectedItem?((0,o.uX)(),(0,o.Wv)(p,{key:0,class:"mt-4",elevation:"2"},{default:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[3]||(t[3]=[(0,o.eW)("Select Sale Quantity",-1)])]),_:1}),(0,o.bF)(f,null,{default:(0,o.k6)(()=>[(0,o.bF)(g,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{cols:"12"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{modelValue:r.selectedQuantity,"onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedQuantity=e),row:""},{default:(0,o.k6)(()=>[(0,o.bF)(d,{label:"1",value:1}),(0,o.bF)(d,{label:"2",value:2}),(0,o.bF)(d,{label:"3",value:3}),(0,o.bF)(d,{label:"4",value:4}),(0,o.bF)(d,{label:"Custom",value:r.customQuantity},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),r.selectedQuantity===r.customQuantity?((0,o.uX)(),(0,o.Wv)(u,{key:0,cols:"6"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{modelValue:r.customQuantityValue,"onUpdate:modelValue":t[1]||(t[1]=e=>r.customQuantityValue=e),label:"Custom Quantity",type:"number",min:"1",max:r.selectedItem.quantity,outlined:""},null,8,["modelValue","max"])]),_:1})):(0,o.Q3)("",!0),(0,o.bF)(u,{cols:"6"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",ae,[(0,o.Lk)("strong",null,"Total Price: "+(0,h.v_)(s.totalPriceDisplay),1)])]),_:1})]),_:1})]),_:1})]),_:1})):(0,o.Q3)("",!0),r.selectedItem?((0,o.uX)(),(0,o.Wv)(p,{key:1,class:"mt-4",elevation:"2"},{default:(0,o.k6)(()=>[(0,o.bF)(f,null,{default:(0,o.k6)(()=>[(0,o.bF)(b,{color:"primary",size:"large",disabled:!s.canSell,loading:r.isSelling,onClick:s.handleSell},{default:(0,o.k6)(()=>[...t[4]||(t[4]=[(0,o.eW)(" Checkout ",-1)])]),_:1},8,["disabled","loading","onClick"]),r.sellMessage?((0,o.uX)(),(0,o.Wv)(v,{key:0,type:r.sellMessageType,class:"mt-2"},{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(r.sellMessage),1)]),_:1},8,["type"])):(0,o.Q3)("",!0)]),_:1})]),_:1})):(0,o.Q3)("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const re={key:2,class:"text-subtitle-1"},se={class:"font-weight-bold ml-1"},ne={key:0,class:"ml-4"},ie={key:1,class:"font-weight-bold ml-1"},de={key:2,class:"ml-4"},ce={key:3,class:"font-weight-bold ml-1"};function ue(e,t,l,a,r,s){const n=(0,o.g2)("v-expansion-panel-title"),i=(0,o.g2)("StoreSelector"),d=(0,o.g2)("v-expansion-panel-text"),c=(0,o.g2)("v-expansion-panel"),u=(0,o.g2)("ProductSelector"),m=(0,o.g2)("ColorSelector"),g=(0,o.g2)("StorageSelector"),f=(0,o.g2)("v-expansion-panels"),p=(0,o.g2)("v-alert"),b=(0,o.g2)("v-skeleton-loader"),v=(0,o.g2)("v-col"),y=(0,o.g2)("v-row"),k=(0,o.g2)("v-card-text"),F=(0,o.g2)("v-card");return(0,o.uX)(),(0,o.Wv)(F,null,{default:(0,o.k6)(()=>[(0,o.bF)(k,null,{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:r.activePanel,"onUpdate:modelValue":t[4]||(t[4]=e=>r.activePanel=e),variant:"accordion",class:"mb-4"},{default:(0,o.k6)(()=>[(0,o.bF)(c,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[5]||(t[5]=[(0,o.eW)("Store",-1)])]),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)(()=>[(0,o.bF)(i,{modelValue:r.selectedStore,"onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedStore=e)},null,8,["modelValue"])]),_:1})]),_:1}),r.selectedStore?((0,o.uX)(),(0,o.Wv)(c,{key:0},{default:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[6]||(t[6]=[(0,o.eW)("Product",-1)])]),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,{store:r.selectedStore,modelValue:r.selectedProduct,"onUpdate:modelValue":t[1]||(t[1]=e=>r.selectedProduct=e)},null,8,["store","modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0),r.selectedProduct?((0,o.uX)(),(0,o.Wv)(c,{key:1},{default:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[7]||(t[7]=[(0,o.eW)("Color",-1)])]),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)(()=>[(0,o.bF)(m,{store:r.selectedStore,product:r.selectedProduct,modelValue:r.selectedColor,"onUpdate:modelValue":t[2]||(t[2]=e=>r.selectedColor=e)},null,8,["store","product","modelValue"])]),_:1})]),_:1})):(0,o.Q3)("",!0),s.hasStoreProductColor?((0,o.uX)(),(0,o.Wv)(c,{key:2,style:(0,h.Tr)({display:r.storageOptionsCount>0?"":"none"})},{default:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[...t[8]||(t[8]=[(0,o.eW)("Storage",-1)])]),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)(()=>[(0,o.bF)(g,{store:r.selectedStore,product:r.selectedProduct,color:r.selectedColor,modelValue:r.selectedStorage,"onUpdate:modelValue":t[3]||(t[3]=e=>r.selectedStorage=e),onOptions:s.onStorageOptions},null,8,["store","product","color","modelValue","onOptions"])]),_:1})]),_:1},8,["style"])):(0,o.Q3)("",!0)]),_:1},8,["modelValue"]),(0,o.bF)(y,{class:"mt-2"},{default:(0,o.k6)(()=>[(0,o.bF)(v,{cols:"12",md:"6"},{default:(0,o.k6)(()=>[r.error?((0,o.uX)(),(0,o.Wv)(p,{key:0,type:"error",density:"comfortable"},{default:(0,o.k6)(()=>[(0,o.eW)((0,h.v_)(r.error),1)]),_:1})):r.loading?((0,o.uX)(),(0,o.Wv)(b,{key:1,type:"text"})):((0,o.uX)(),(0,o.CE)("div",re,[t[9]||(t[9]=(0,o.Lk)("span",null,"Quantity:",-1)),(0,o.Lk)("span",se,(0,h.v_)(s.quantityDisplay),1),r.selectedStorage?((0,o.uX)(),(0,o.CE)("span",ne,"Storage:")):(0,o.Q3)("",!0),r.selectedStorage?((0,o.uX)(),(0,o.CE)("span",ie,(0,h.v_)(r.selectedStorage)+"GB",1)):(0,o.Q3)("",!0),null!==r.price&&void 0!==r.price?((0,o.uX)(),(0,o.CE)("span",de,"Price:")):(0,o.Q3)("",!0),null!==r.price&&void 0!==r.price?((0,o.uX)(),(0,o.CE)("span",ce,"$"+(0,h.v_)(r.price),1)):(0,o.Q3)("",!0)]))]),_:1})]),_:1})]),_:1})]),_:1})}function me(e,t,l,a,r,s){const n=(0,o.g2)("v-autocomplete");return(0,o.uX)(),(0,o.Wv)(n,{items:r.storeItems,loading:r.loading,"model-value":l.modelValue,"item-title":"label","item-value":"value",label:"Store",placeholder:"Select a store",clearable:"","onUpdate:modelValue":s.onUpdate},null,8,["items","loading","model-value","onUpdate:modelValue"])}l(4114);const ge="inventory";async function he(){const{data:e,error:t}=await F.from(ge).select("name, location").not("name","is",null).not("location","is",null);if(t)throw t;const l=new Set,a=[];for(const o of e){const e=`${o.name}__${o.location}`;l.has(e)||(l.add(e),a.push({name:o.name,location:o.location,label:`${o.name} â€” ${o.location}`}))}return a}async function fe(e){const{name:t,location:l}=e,{data:a,error:o}=await F.from(ge).select("product").eq("name",t).eq("location",l).not("product","is",null);if(o)throw o;const r=new Set(a.map(e=>String(e.product).trim().toLowerCase()));return Array.from(r).sort()}async function pe(e,t){const{name:l,location:a}=e,{data:o,error:r}=await F.from(ge).select("color").eq("name",l).eq("location",a).ilike("product",t).not("color","is",null);if(r)throw r;const s=new Set(o.map(e=>String(e.color).trim().toLowerCase()));return Array.from(s).sort()}async function be(e,t,l){const{name:a,location:o}=e,{data:r,error:s}=await F.from(ge).select("storage").eq("name",a).eq("location",o).ilike("product",t).ilike("color",l).not("storage","is",null);if(s)throw s;const n=new Set((r||[]).map(e=>String(e.storage).trim()));return Array.from(n).sort((e,t)=>Number(e)-Number(t))}async function ve(e,t,l,a){const{name:o,location:r}=e;let s=F.from(ge).select("quantity").eq("name",o).eq("location",r).ilike("product",t).ilike("color",l);if(void 0!==a&&null!==a&&""!==a){const e=Number(a);s=Number.isNaN(e)?s.eq("storage",String(a)):s.eq("storage",e)}else s=s.or("storage.is.null,storage.eq.0");const{data:n,error:i}=await s;if(i)throw i;let d=0;for(const c of n||[]){const e=Number(c.quantity);Number.isNaN(e)||(d+=e)}return d}async function ye(e,t,l,a){const{name:o,location:r}=e;let s=F.from(ge).select("price").eq("name",o).eq("location",r).ilike("product",t).ilike("color",l);if(void 0!==a&&null!==a&&""!==a){const e=Number(a);s=Number.isNaN(e)?s.eq("storage",String(a)):s.eq("storage",e)}else s=s.or("storage.is.null,storage.eq.0");const{data:n,error:i}=await s;if(i)throw i;return n&&n.length>0?n[0].price:null}var ke={name:"StoreSelector",props:{modelValue:{type:Object,default:null}},data(){return{loading:!1,storeItems:[]}},methods:{onUpdate(e){this.$emit("update:modelValue",e)},async loadStores(){this.loading=!0;try{const e=await he();this.storeItems=e.map(e=>({label:e.label,value:{name:e.name,location:e.location}}))}catch(e){console.error("Failed to load stores",e)}finally{this.loading=!1}}},mounted(){this.loadStores()}};const Fe=(0,n.A)(ke,[["render",me]]);var _e=Fe;function Se(e,t,l,a,r,s){const n=(0,o.g2)("v-autocomplete");return(0,o.uX)(),(0,o.Wv)(n,{disabled:!l.store,items:r.items,loading:r.loading,"model-value":l.modelValue,label:"Product",placeholder:"Select a product",clearable:"","onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("update:modelValue",t))},null,8,["disabled","items","loading","model-value"])}var we={name:"ProductSelector",props:{modelValue:{type:String,default:""},store:{type:Object,default:null}},data(){return{loading:!1,items:[]}},watch:{store:{handler(){this.load()},immediate:!0}},methods:{async load(){if(this.store){this.loading=!0;try{const e=await fe(this.store);this.items=e}catch(e){console.error("Failed to load products",e)}finally{this.loading=!1}}else this.items=[]}}};const Ve=(0,n.A)(we,[["render",Se]]);var xe=Ve;function Pe(e,t,l,a,r,s){const n=(0,o.g2)("v-autocomplete");return(0,o.uX)(),(0,o.Wv)(n,{disabled:!l.store||!l.product,items:r.items,loading:r.loading,"model-value":l.modelValue,label:"Color",placeholder:"Select a color",clearable:"","onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("update:modelValue",t))},null,8,["disabled","items","loading","model-value"])}var Re={name:"ColorSelector",props:{modelValue:{type:String,default:""},store:{type:Object,default:null},product:{type:String,default:""}},data(){return{loading:!1,items:[]}},watch:{store:{handler(){this.load()},immediate:!0},product(){this.load()}},methods:{async load(){if(this.store&&this.product){this.loading=!0;try{const e=await pe(this.store,this.product);this.items=e}catch(e){console.error("Failed to load colors",e)}finally{this.loading=!1}}else this.items=[]}}};const Ce=(0,n.A)(Re,[["render",Pe]]);var We=Ce;function Ie(e,t,l,a,r,s){const n=(0,o.g2)("v-autocomplete");return(0,o.uX)(),(0,o.Wv)(n,{disabled:!l.store||!l.product||!l.color,items:s.displayItems,loading:r.loading,"model-value":l.modelValue,"item-title":"label","item-value":"value",label:"Storage",placeholder:"Select storage",clearable:"","onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("update:modelValue",t))},null,8,["disabled","items","loading","model-value"])}var De={name:"StorageSelector",props:{modelValue:{type:[String,Number],default:""},store:{type:Object,default:null},product:{type:String,default:""},color:{type:String,default:""}},emits:["update:modelValue","options"],data(){return{loading:!1,items:[]}},computed:{displayItems(){return this.items.map(e=>({label:`${e}GB`,value:e}))}},watch:{store:{handler(){this.load()},immediate:!0},product(){this.load()},color(){this.load()}},methods:{async load(){if(!this.store||!this.product||!this.color)return this.items=[],void this.$emit("options",0);this.loading=!0;try{const e=await be(this.store,this.product,this.color);this.items=e,this.$emit("options",this.items.length),0===this.items.length&&this.$emit("update:modelValue","")}catch(e){console.error("Failed to load storages",e),this.$emit("options",0)}finally{this.loading=!1}}}};const Ne=(0,n.A)(De,[["render",Ie]]);var Qe=Ne,qe={name:"InventorySearchPanel",components:{StoreSelector:_e,ProductSelector:xe,ColorSelector:We,StorageSelector:Qe},emits:["change"],data(){return{selectedStore:null,selectedProduct:"",selectedColor:"",selectedStorage:"",loading:!1,error:"",quantity:null,price:null,storageOptionsCount:0,activePanel:0}},computed:{quantityDisplay(){return null===this.quantity?"-":this.quantity},hasStoreProductColor(){return!!this.selectedStore&&!!this.selectedProduct&&!!this.selectedColor}},watch:{selectedStore(){this.resetStorageState(),this.triggerQuery(),this.activePanel=1},selectedProduct(){this.resetStorageState(),this.triggerQuery(),this.activePanel=2},selectedColor(){this.resetStorageState(),this.triggerQuery(),this.activePanel=3},selectedStorage(){this.triggerQuery()}},methods:{onStorageOptions(e){this.storageOptionsCount=e},resetStorageState(){this.selectedStorage="",this.storageOptionsCount=0},async triggerQuery(){if(this.$emit("change",{store:this.selectedStore,product:this.selectedProduct,color:this.selectedColor,storage:this.selectedStorage}),!this.selectedStore||!this.selectedProduct||!this.selectedColor)return this.quantity=null,void(this.price=null);this.loading=!0,this.error="";try{const[e,t]=await Promise.all([ve(this.selectedStore,this.selectedProduct,this.selectedColor,this.selectedStorage),ye(this.selectedStore,this.selectedProduct,this.selectedColor,this.selectedStorage)]);this.quantity=e,this.price=t}catch(e){this.error="Failed to load data",console.error(e)}finally{this.loading=!1}}}};const Le=(0,n.A)(qe,[["render",ue]]);var Oe=Le,Te={name:"SellingPage",components:{InventorySearchPanel:Oe},data(){return{selectedItem:null,selectedQuantity:1,customQuantity:"custom",customQuantityValue:1,isSelling:!1,sellMessage:"",sellMessageType:"success"}},computed:{actualQuantity(){return this.selectedQuantity===this.customQuantity?parseInt(this.customQuantityValue)||1:this.selectedQuantity},totalPrice(){return this.selectedItem&&this.selectedItem.price?this.selectedItem.price*this.actualQuantity:0},totalPriceDisplay(){if(!this.selectedItem||!this.selectedItem.price)return"$0";const e=this.selectedItem.price*this.actualQuantity;return`$${e.toFixed(2)}`},canSell(){return this.selectedItem&&this.selectedItem.price&&this.actualQuantity>0&&this.actualQuantity<=(this.selectedItem.quantity||0)}},methods:{sanitizeStorageValue(e){return""===e||null===e||void 0===e?null:e},async onSelectionChange(e){if(console.log("Selection changed",e),e.store&&e.product&&e.color)try{const t=this.sanitizeStorageValue(e.storage),[l,a]=await Promise.all([ye(e.store,e.product,e.color,t),ve(e.store,e.product,e.color,t)]);this.selectedItem={store:e.store,product:e.product,color:e.color,storage:t,price:l,quantity:a},this.selectedQuantity=1,this.customQuantityValue=1,this.sellMessage=""}catch(t){console.error("Error fetching item details:",t),this.sellMessage="Error fetching product information",this.sellMessageType="error"}else this.selectedItem=null,this.sellMessage=""},async handleSell(){if(this.canSell){this.isSelling=!0,this.sellMessage="";try{const e=await this.getInventoryRecordId(),t={time:(new Date).toISOString(),id:e,name:this.selectedItem.store.name,product:this.selectedItem.product,price:this.totalPrice,quantity:this.actualQuantity,store_location:this.selectedItem.store.location,color:this.selectedItem.color,storage:this.sanitizeStorageValue(this.selectedItem.storage),unit_price:this.selectedItem.price};await S(t),await this.deductInventory(),this.sellMessage=`Successfully sold ${this.actualQuantity} items for $${this.totalPrice}`,this.sellMessageType="success";const l=await ve(this.selectedItem.store,this.selectedItem.product,this.selectedItem.color,this.selectedItem.storage);this.selectedItem.quantity=l,this.selectedQuantity=1,this.customQuantityValue=1}catch(e){console.error("Error creating sale:",e),this.sellMessage="Sale failed: "+e.message,this.sellMessageType="error"}finally{this.isSelling=!1}}},async getInventoryRecordId(){const{name:e,location:t}=this.selectedItem.store,{product:l,color:a,storage:o}=this.selectedItem;let r=F.from("inventory").select("id").eq("name",e).eq("location",t).ilike("product",l).ilike("color",a);const s=this.sanitizeStorageValue(o);if(null!==s){const e=Number(s);r=Number.isNaN(e)?r.eq("storage",String(s)):r.eq("storage",e)}else r=r.or("storage.is.null,storage.eq.");const{data:n,error:i}=await r;if(i)throw i;if(!n||0===n.length)throw new Error(`No inventory record found for ${l} ${a} ${o?o+"GB":"no storage"}`);return n[0].id},async deductInventory(){const{name:e,location:t}=this.selectedItem.store,{product:l,color:a,storage:o}=this.selectedItem,r=this.actualQuantity;let s=F.from("inventory").select("*").eq("name",e).eq("location",t).ilike("product",l).ilike("color",a);const n=this.sanitizeStorageValue(o);if(null!==n){const e=Number(n);s=Number.isNaN(e)?s.eq("storage",String(n)):s.eq("storage",e)}else s=s.or("storage.is.null,storage.eq.");const{data:i,error:d}=await s;if(d)throw d;if(!i||0===i.length)throw new Error(`No inventory records found for ${l} ${a} ${o?o+"GB":"no storage"}`);let c=0;for(const m of i)c+=Number(m.quantity)||0;if(c<r)throw new Error(`Insufficient inventory. Available: ${c}, Required: ${r}`);let u=r;for(const m of i){if(u<=0)break;const e=Number(m.quantity)||0,t=Math.min(u,e);if(t>0){const l=e-t,{error:a}=await F.from("inventory").update({quantity:l}).eq("id",m.id).eq("name",m.name).eq("location",m.location);if(a)throw a;u-=t}}if(u>0)throw new Error("Insufficient inventory to complete the sale")}}};const Ue=(0,n.A)(Te,[["render",oe]]);var Xe=Ue;const $e=[{path:"/",redirect:"/selling"},{path:"/sales-record",name:"SalesRecord",component:G},{path:"/inventory",name:"Inventory",component:le},{path:"/selling",name:"Selling",component:Xe}],Ee=(0,g.aE)({history:(0,g.LA)(),routes:$e});var Ae=Ee;const Me=(0,c.$N)({components:u,directives:m}),je=(0,a.Ef)(d);je.use(Me),je.use(Ae),je.mount("#app")}},t={};function l(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,l),r.exports}l.m=e,function(){var e=[];l.O=function(t,a,o,r){if(!a){var s=1/0;for(c=0;c<e.length;c++){a=e[c][0],o=e[c][1],r=e[c][2];for(var n=!0,i=0;i<a.length;i++)(!1&r||s>=r)&&Object.keys(l.O).every(function(e){return l.O[e](a[i])})?a.splice(i--,1):(n=!1,r<s&&(s=r));if(n){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,o,r]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};l.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,r,s=a[0],n=a[1],i=a[2],d=0;if(s.some(function(t){return 0!==e[t]})){for(o in n)l.o(n,o)&&(l.m[o]=n[o]);if(i)var c=i(l)}for(t&&t(a);d<s.length;d++)r=s[d],l.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return l.O(c)},a=self["webpackChunkinventory_management_system"]=self["webpackChunkinventory_management_system"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=l.O(void 0,[504],function(){return l(8275)});a=l.O(a)})();
//# sourceMappingURL=app.cdc5a766.js.map