(function(){"use strict";var e={5756:function(e,t,a){var l=a(5130),r=a(6768);function o(e,t,a,l,o,s){const n=(0,r.g2)("v-toolbar-title"),i=(0,r.g2)("v-spacer"),d=(0,r.g2)("v-icon"),c=(0,r.g2)("v-btn"),u=(0,r.g2)("v-app-bar"),m=(0,r.g2)("router-view"),g=(0,r.g2)("v-main"),h=(0,r.g2)("v-app");return(0,r.uX)(),(0,r.Wv)(h,null,{default:(0,r.k6)(()=>[(0,r.bF)(u,{color:"primary",dark:"",prominent:""},{default:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[0]||(t[0]=[(0,r.eW)("Distributed Inventory and Sales Management System",-1)])]),_:1}),(0,r.bF)(i),(0,r.bF)(c,{to:{name:"Selling"},color:"white",variant:"text",class:"mr-2"},{default:(0,r.k6)(()=>[(0,r.bF)(d,{left:""},{default:(0,r.k6)(()=>[...t[1]||(t[1]=[(0,r.eW)("mdi-cash-register",-1)])]),_:1}),t[2]||(t[2]=(0,r.eW)(" selling ",-1))]),_:1}),(0,r.bF)(c,{to:{name:"Inventory"},color:"white",variant:"text",class:"mr-2"},{default:(0,r.k6)(()=>[(0,r.bF)(d,{left:""},{default:(0,r.k6)(()=>[...t[3]||(t[3]=[(0,r.eW)("mdi-warehouse",-1)])]),_:1}),t[4]||(t[4]=(0,r.eW)(" Inventory ",-1))]),_:1}),(0,r.bF)(c,{to:{name:"SalesRecord"},color:"white",variant:"text",class:"mr-2"},{default:(0,r.k6)(()=>[(0,r.bF)(d,{left:""},{default:(0,r.k6)(()=>[...t[5]||(t[5]=[(0,r.eW)("mdi-chart-line",-1)])]),_:1}),t[6]||(t[6]=(0,r.eW)(" sales record ",-1))]),_:1}),(0,r.bF)(c,{icon:""},{default:(0,r.k6)(()=>[(0,r.bF)(d,null,{default:(0,r.k6)(()=>[...t[7]||(t[7]=[(0,r.eW)("mdi-account",-1)])]),_:1})]),_:1})]),_:1}),(0,r.bF)(g,null,{default:(0,r.k6)(()=>[(0,r.bF)(m)]),_:1})]),_:1})}var s={name:"App"},n=a(1241);const i=(0,n.A)(s,[["render",o]]);var d=i,c=a(5753),u=(a(5524),a(2801)),m=a(3425),g=a(1387),h=a(4232);function f(e,t,a,l,o,s){const n=(0,r.g2)("v-icon"),i=(0,r.g2)("v-spacer"),d=(0,r.g2)("v-btn"),c=(0,r.g2)("v-card-title"),u=(0,r.g2)("v-card-text"),m=(0,r.g2)("v-card"),g=(0,r.g2)("SalesRecordFilters"),f=(0,r.g2)("SalesRanking"),p=(0,r.g2)("SalesRecordList"),v=(0,r.g2)("v-col"),y=(0,r.g2)("v-row"),b=(0,r.g2)("v-card-actions"),k=(0,r.g2)("v-dialog"),F=(0,r.g2)("v-container");return(0,r.uX)(),(0,r.Wv)(F,{fluid:""},{default:(0,r.k6)(()=>[(0,r.bF)(y,null,{default:(0,r.k6)(()=>[(0,r.bF)(v,{cols:"12"},{default:(0,r.k6)(()=>[(0,r.bF)(m,{class:"mb-4"},{default:(0,r.k6)(()=>[(0,r.bF)(c,{class:"d-flex align-center"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:"",size:"large",color:"primary"},{default:(0,r.k6)(()=>[...t[2]||(t[2]=[(0,r.eW)("mdi-chart-line",-1)])]),_:1}),t[5]||(t[5]=(0,r.Lk)("h1",{class:"text-h4"},"Sales Records Query",-1)),(0,r.bF)(i),(0,r.bF)(d,{color:"primary",variant:"outlined",onClick:s.refreshData,loading:o.isRefreshing},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[3]||(t[3]=[(0,r.eW)("mdi-refresh",-1)])]),_:1}),t[4]||(t[4]=(0,r.eW)(" Refresh Data ",-1))]),_:1},8,["onClick","loading"])]),_:1}),(0,r.bF)(u,null,{default:(0,r.k6)(()=>[...t[6]||(t[6]=[(0,r.Lk)("p",{class:"text-body-1 text-grey-darken-1"}," View and manage all sales records with filtering by date, product, and store ",-1)])]),_:1})]),_:1}),(0,r.bF)(g,{onFiltersChange:s.onFiltersChange,onError:s.onFilterError,class:"mb-4"},null,8,["onFiltersChange","onError"]),(0,r.bF)(f,{class:"mb-4"}),(0,r.bF)(p,{"sales-records":o.salesRecords,stats:o.salesStats,loading:o.loading,error:o.error},null,8,["sales-records","stats","loading","error"])]),_:1})]),_:1}),(0,r.bF)(k,{modelValue:o.showErrorDialog,"onUpdate:modelValue":t[1]||(t[1]=e=>o.showErrorDialog=e),"max-width":"500px"},{default:(0,r.k6)(()=>[(0,r.bF)(m,null,{default:(0,r.k6)(()=>[(0,r.bF)(c,{class:"text-h5 text-error"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:"",color:"error"},{default:(0,r.k6)(()=>[...t[7]||(t[7]=[(0,r.eW)("mdi-alert-circle",-1)])]),_:1}),t[8]||(t[8]=(0,r.eW)(" Error ",-1))]),_:1}),(0,r.bF)(u,null,{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(o.errorDialogMessage),1)]),_:1}),(0,r.bF)(b,null,{default:(0,r.k6)(()=>[(0,r.bF)(i),(0,r.bF)(d,{color:"primary",onClick:t[0]||(t[0]=e=>o.showErrorDialog=!1)},{default:(0,r.k6)(()=>[...t[9]||(t[9]=[(0,r.eW)("OK",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}function p(e,t,a,l,o,s){const n=(0,r.g2)("v-icon"),i=(0,r.g2)("v-card-title"),d=(0,r.g2)("v-select"),c=(0,r.g2)("v-col"),u=(0,r.g2)("v-text-field"),m=(0,r.g2)("v-row"),g=(0,r.g2)("v-combobox"),h=(0,r.g2)("v-btn"),f=(0,r.g2)("v-card-text"),p=(0,r.g2)("v-card");return(0,r.uX)(),(0,r.Wv)(p,null,{default:(0,r.k6)(()=>[(0,r.bF)(i,null,{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[5]||(t[5]=[(0,r.eW)("mdi-filter",-1)])]),_:1}),t[6]||(t[6]=(0,r.eW)(" Filter Conditions ",-1))]),_:1}),(0,r.bF)(f,null,{default:(0,r.k6)(()=>[(0,r.bF)(m,null,{default:(0,r.k6)(()=>[(0,r.bF)(c,{cols:"12",md:"4"},{default:(0,r.k6)(()=>[(0,r.bF)(d,{modelValue:o.dateFilterType,"onUpdate:modelValue":t[0]||(t[0]=e=>o.dateFilterType=e),items:o.dateFilterOptions,label:"Date Filter Type",outlined:"",dense:"",onChange:s.onDateFilterTypeChange},null,8,["modelValue","items","onChange"])]),_:1}),"two-days"===o.dateFilterType?((0,r.uX)(),(0,r.Wv)(c,{key:0,cols:"12",md:"8"},{default:(0,r.k6)(()=>[(0,r.bF)(m,null,{default:(0,r.k6)(()=>[(0,r.bF)(c,{cols:"6"},{default:(0,r.k6)(()=>[(0,r.bF)(u,{modelValue:o.firstDate,"onUpdate:modelValue":[t[1]||(t[1]=e=>o.firstDate=e),s.onTwoDaysChange],label:"Start Date",type:"date",outlined:"",dense:"",max:(new Date).toISOString().split("T")[0]},null,8,["modelValue","max","onUpdate:modelValue"])]),_:1}),(0,r.bF)(c,{cols:"6"},{default:(0,r.k6)(()=>[(0,r.bF)(u,{modelValue:o.secondDate,"onUpdate:modelValue":[t[2]||(t[2]=e=>o.secondDate=e),s.onTwoDaysChange],label:"End Date",type:"date",outlined:"",dense:"",max:(new Date).toISOString().split("T")[0]},null,8,["modelValue","max","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})):(0,r.Q3)("",!0),(0,r.bF)(c,{cols:"12",md:"4"},{default:(0,r.k6)(()=>[(0,r.bF)(g,{modelValue:o.selectedProducts,"onUpdate:modelValue":[t[3]||(t[3]=e=>o.selectedProducts=e),s.onFiltersChange],items:o.availableProducts,loading:o.loadingProducts,label:"Product Filter",placeholder:"Select products",outlined:"",dense:"",multiple:"",chips:"",clearable:""},null,8,["modelValue","items","loading","onUpdate:modelValue"])]),_:1}),(0,r.bF)(c,{cols:"12",md:"4"},{default:(0,r.k6)(()=>[(0,r.bF)(g,{modelValue:o.selectedStoreNames,"onUpdate:modelValue":[t[4]||(t[4]=e=>o.selectedStoreNames=e),s.onFiltersChange],items:o.availableStoreNames,loading:o.loadingStoreNames,label:"Store Filter",placeholder:"Select stores",outlined:"",dense:"",multiple:"",chips:"",clearable:""},null,8,["modelValue","items","loading","onUpdate:modelValue"])]),_:1})]),_:1}),(0,r.bF)(m,{class:"mt-2"},{default:(0,r.k6)(()=>[(0,r.bF)(c,{cols:"12",class:"text-right"},{default:(0,r.k6)(()=>[(0,r.bF)(h,{color:"secondary",onClick:s.resetFilters,class:"mr-2"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[7]||(t[7]=[(0,r.eW)("mdi-refresh",-1)])]),_:1}),t[8]||(t[8]=(0,r.eW)(" Reset ",-1))]),_:1},8,["onClick"]),(0,r.bF)(h,{color:"primary",onClick:s.applyFilters,loading:o.loading},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[9]||(t[9]=[(0,r.eW)("mdi-magnify",-1)])]),_:1}),t[10]||(t[10]=(0,r.eW)(" Search ",-1))]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1})]),_:1})}a(4114),a(8111),a(7588),a(1701),a(8237),a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698);var v=a(1300);const y="https://obhzromrgwodaxsjlgfs.supabase.co",b="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9iaHpyb21yZ3dvZGF4c2psZ2ZzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2NDg1NTgsImV4cCI6MjA3NDIyNDU1OH0.7gjEbFfzzXOTxt3fhnBxEfSqKtazQ_5ywY4i_I84O-E";y&&b||console.error("[Supabase] Missing SUPABASE_URL or SUPABASE_ANON_KEY environment variables");const k=(0,v.UU)(y||"",b||"");var F=k;a(2489),a(3579);const _=8;function S(e){return new Date(e.getTime()+60*_*60*1e3)}function C(e){if(!Array.isArray(e)||0===e.length)return[];const t=new Map;return e.forEach((e,a)=>{if(!e||!e.time)return void console.warn(`calculateDailyRevenue: Skipping invalid record at index ${a}`);const l=new Date(e.time);if(isNaN(l.getTime()))return void console.warn(`calculateDailyRevenue: Invalid time format at index ${a}: ${e.time}`);const r=S(l),o=r.toISOString().split("T")[0],s=parseFloat(e.price)||0,n=t.get(o)||0;t.set(o,n+s)}),Array.from(t.entries()).map(([e,t])=>({date:e,revenue:Math.round(100*t)/100})).sort((e,t)=>new Date(e.date)-new Date(t.date))}function D(e){if(!Array.isArray(e)||0===e.length)return[];const t=new Map;return e.forEach(e=>{if(!e||!e.time)return;const a=new Date(e.time);if(isNaN(a.getTime()))return;const l=S(a),r=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`,o=parseFloat(e.price)||0,s=t.get(r)||0;t.set(r,s+o)}),Array.from(t.entries()).map(([e,t])=>({month:e,revenue:Math.round(100*t)/100})).sort((e,t)=>e.month.localeCompare(t.month))}function w(e,t){if(!Array.isArray(e)||0===e.length||!t)return[];const a=new Date(t),l=new Date(a);l.setHours(0,0,0,0);const r=new Date(a);r.setHours(23,59,59,999);const o=e.filter(e=>{if(!e.time)return!1;const t=new Date(e.time),a=S(t);return a>=l&&a<=r}),s=new Map;for(let n=0;n<24;n++)s.set(n,0);return o.forEach(e=>{if(!e.time)return;const t=new Date(e.time),a=S(t),l=a.getHours(),r=parseFloat(e.price)||0;l>=0&&l<=23&&s.set(l,(s.get(l)||0)+r)}),Array.from(s.entries()).map(([e,t])=>({hour:e,revenue:Math.round(100*t)/100})).sort((e,t)=>e.hour-t.hour)}function R(e,t){return Array.isArray(e)&&0!==e.length?e.map(e=>{if("daily"===t){const t=e.date||e.time;if(!t)return"Invalid Date";const a=new Date(t);if(isNaN(a.getTime()))return"Invalid Date";const l=S(a);return l.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}return e.month||"Unknown Month"}):[]}function x(e){return Array.isArray(e)&&0!==e.length?e.map(e=>{const t=parseFloat(e.revenue||e.price||0);return isNaN(t)?0:t}):[]}const W="sales";async function V(e){const{data:t,error:a}=await F.from(W).insert([e]).select();if(a)throw a;return t}async function P(e){let t=F.from(W).select("*");if(e.dateRange)if(1===e.dateRange.length){const a=new Date(e.dateRange[0]);a.setHours(0,0,0,0);const l=new Date(e.dateRange[0]);l.setHours(23,59,59,999),t=t.gte("time",a.toISOString()).lte("time",l.toISOString())}else if(2===e.dateRange.length){const a=new Date(e.dateRange[0]);a.setHours(0,0,0,0);const l=new Date(e.dateRange[1]);l.setHours(23,59,59,999),t=t.gte("time",a.toISOString()).lte("time",l.toISOString())}e.products&&e.products.length>0&&(t=t.in("product",e.products)),e.storeNames&&e.storeNames.length>0&&(t=t.in("name",e.storeNames)),t=t.order("time",{ascending:!1}),e.limit&&(t=t.limit(e.limit)),e.offset&&(t=t.range(e.offset,e.offset+(e.limit||20)-1));const{data:a,error:l}=await t;if(l)throw l;return a}async function I(){const{data:e,error:t}=await F.from(W).select("product").order("product");if(t)throw t;const a=[...new Set(e.map(e=>e.product))];return a}async function L(){const{data:e,error:t}=await F.from(W).select("name").order("name");if(t)throw t;const a=[...new Set(e.map(e=>e.name))];return a}async function N(e={}){let t=F.from(W).select("price, quantity, time");if(e.dateRange)if(1===e.dateRange.length){const a=new Date(e.dateRange[0]);a.setHours(0,0,0,0);const l=new Date(e.dateRange[0]);l.setHours(23,59,59,999),t=t.gte("time",a.toISOString()).lte("time",l.toISOString())}else if(2===e.dateRange.length){const a=new Date(e.dateRange[0]);a.setHours(0,0,0,0);const l=new Date(e.dateRange[1]);l.setHours(23,59,59,999),t=t.gte("time",a.toISOString()).lte("time",l.toISOString())}e.products&&e.products.length>0&&(t=t.in("product",e.products)),e.storeNames&&e.storeNames.length>0&&(t=t.in("name",e.storeNames));const{data:a,error:l}=await t;if(l)throw l;const r=a.length,o=a.reduce((e,t)=>e+(t.price||0),0),s=a.reduce((e,t)=>e+(t.quantity||0),0),n=C(a),i=D(a);return{totalRecords:r,totalRevenue:o,totalQuantity:s,dailyRevenue:n,monthlyRevenue:i}}async function $(e={}){let t=F.from(W).select("product, price, quantity, name, time");if(e.dateRange&&2===e.dateRange.length){const a=new Date(e.dateRange[0]);a.setHours(0,0,0,0);const l=new Date(e.dateRange[1]);l.setHours(23,59,59,999),t=t.gte("time",a.toISOString()).lte("time",l.toISOString())}e.products&&e.products.length>0&&(t=t.in("product",e.products)),e.stores&&e.stores.length>0&&(t=t.in("name",e.stores));const{data:a,error:l}=await t;if(l)throw l;const r=new Map;a.forEach(e=>{const t=e.product,a=parseFloat(e.price)||0,l=parseInt(e.quantity)||0,o=e.name;r.has(t)||r.set(t,{product:t,totalRevenue:0,totalQuantity:0,stores:new Set,prices:[]});const s=r.get(t);s.totalRevenue+=a,s.totalQuantity+=l,s.stores.add(o),s.prices.push(a/l)});let o=Array.from(r.values()).map(e=>({product:e.product,totalRevenue:Math.round(100*e.totalRevenue)/100,totalQuantity:e.totalQuantity,storeCount:e.stores.size,averagePrice:e.prices.length>0?Math.round(e.prices.reduce((e,t)=>e+t,0)/e.prices.length*100)/100:0}));const s=e.sortBy||"revenue";switch(s){case"revenue":o.sort((e,t)=>t.totalRevenue-e.totalRevenue);break;case"quantity":o.sort((e,t)=>t.totalQuantity-e.totalQuantity);break;case"stores":o.sort((e,t)=>t.storeCount-e.storeCount);break;case"price":o.sort((e,t)=>t.averagePrice-e.averagePrice);break;default:o.sort((e,t)=>t.totalRevenue-e.totalRevenue)}const n=parseInt(e.limit)||10;return o=o.slice(0,n),{ranking:o,total:r.size}}var T={name:"SalesRecordFilters",emits:["filters-change"],data(){return{dateFilterType:"none",dateFilterOptions:[{title:"No Date Filter",value:"none"},{title:"Select Day Range",value:"two-days"}],firstDate:null,secondDate:null,selectedProducts:[],selectedStoreNames:[],availableProducts:[],availableStoreNames:[],loadingProducts:!1,loadingStoreNames:!1,loading:!1}},mounted(){this.loadFilterOptions()},methods:{async loadFilterOptions(){this.loadingProducts=!0,this.loadingStoreNames=!0;try{const[e,t]=await Promise.all([I(),L()]);this.availableProducts=e,this.availableStoreNames=t}catch(e){console.error("Failed to load filter options:",e),this.$emit("error","Failed to load filter options")}finally{this.loadingProducts=!1,this.loadingStoreNames=!1}},onDateFilterTypeChange(){this.resetDateFilters(),this.onFiltersChange()},onTwoDaysChange(){this.onFiltersChange()},formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString("en-US")},onFiltersChange(){this.emitFilters()},emitFilters(){const e={dateRange:this.getDateRangeFilter(),products:this.selectedProducts,storeNames:this.selectedStoreNames};this.$emit("filters-change",e)},getDateRangeFilter(){if("two-days"===this.dateFilterType&&this.firstDate&&this.secondDate){const e=new Date(this.firstDate),t=new Date(this.secondDate);if(e>t)return this.$emit("error","开始日期不能晚于结束日期"),null;const a=[this.firstDate,this.secondDate].sort();return a}return null},applyFilters(){this.loading=!0,this.emitFilters(),setTimeout(()=>{this.loading=!1},500)},resetFilters(){this.dateFilterType="none",this.firstDate=null,this.secondDate=null,this.selectedProducts=[],this.selectedStoreNames=[],this.emitFilters()},resetDateFilters(){this.firstDate=null,this.secondDate=null}}};const E=(0,n.A)(T,[["render",p],["__scopeId","data-v-51b2f8df"]]);var Q=E;const U={class:"text-h6"},q={class:"text-h6"},M={class:"text-h6"},O={key:1,class:"text-center py-8"},A={key:3,class:"text-center py-8"},X={key:4},H={class:"ml-2"},z={class:"font-weight-medium"},B={class:"font-weight-medium"},j={class:"font-weight-medium"},J={class:"font-weight-bold text-primary"},G={class:"text-caption"},Z={key:0},K={key:1,class:"text-center py-8"},Y={key:0},ee={key:1,class:"text-center py-8"};function te(e,t,a,l,o,s){const n=(0,r.g2)("v-icon"),i=(0,r.g2)("v-spacer"),d=(0,r.g2)("v-chip"),c=(0,r.g2)("v-card-title"),u=(0,r.g2)("v-card-text"),m=(0,r.g2)("v-card"),g=(0,r.g2)("v-col"),f=(0,r.g2)("v-btn"),p=(0,r.g2)("v-row"),v=(0,r.g2)("v-progress-circular"),y=(0,r.g2)("v-alert"),b=(0,r.g2)("v-expansion-panel-title"),k=(0,r.g2)("v-divider"),F=(0,r.g2)("v-list-item-title"),_=(0,r.g2)("v-list-item-subtitle"),S=(0,r.g2)("v-list-item"),C=(0,r.g2)("v-list"),D=(0,r.g2)("v-expansion-panel-text"),w=(0,r.g2)("v-expansion-panel"),R=(0,r.g2)("v-expansion-panels"),x=(0,r.g2)("v-pagination"),W=(0,r.g2)("v-text-field"),V=(0,r.g2)("v-tab"),P=(0,r.g2)("v-tabs"),I=(0,r.g2)("RevenueChart"),L=(0,r.g2)("v-tabs-window-item"),N=(0,r.g2)("v-tabs-window"),$=(0,r.g2)("v-dialog");return(0,r.uX)(),(0,r.Wv)(m,null,{default:(0,r.k6)(()=>[(0,r.bF)(c,null,{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[8]||(t[8]=[(0,r.eW)("mdi-format-list-bulleted",-1)])]),_:1}),t[9]||(t[9]=(0,r.eW)(" Sales Records ",-1)),(0,r.bF)(i),(0,r.bF)(d,{color:"primary",variant:"outlined"},{default:(0,r.k6)(()=>[(0,r.eW)(" Total "+(0,h.v_)(s.totalRecords)+" Records ",1)]),_:1})]),_:1}),(0,r.bF)(u,null,{default:(0,r.k6)(()=>[a.stats?((0,r.uX)(),(0,r.Wv)(p,{key:0,class:"mb-4"},{default:(0,r.k6)(()=>[(0,r.bF)(g,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(m,{color:"primary",variant:"tonal"},{default:(0,r.k6)(()=>[(0,r.bF)(u,{class:"text-center"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",U,(0,h.v_)(a.stats.totalRecords),1),t[10]||(t[10]=(0,r.Lk)("div",{class:"text-caption"},"Total Records",-1))]),_:1})]),_:1})]),_:1}),(0,r.bF)(g,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(m,{color:"success",variant:"tonal"},{default:(0,r.k6)(()=>[(0,r.bF)(u,{class:"text-center"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",q,"$"+(0,h.v_)(a.stats.totalRevenue.toLocaleString()),1),t[11]||(t[11]=(0,r.Lk)("div",{class:"text-caption"},"Total Revenue",-1))]),_:1})]),_:1})]),_:1}),(0,r.bF)(g,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(m,{color:"info",variant:"tonal"},{default:(0,r.k6)(()=>[(0,r.bF)(u,{class:"text-center"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",M,(0,h.v_)(a.stats.totalQuantity),1),t[12]||(t[12]=(0,r.Lk)("div",{class:"text-caption"},"Total Quantity",-1))]),_:1})]),_:1})]),_:1}),(0,r.bF)(g,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(m,{color:"warning",variant:"tonal"},{default:(0,r.k6)(()=>[(0,r.bF)(u,{class:"text-center"},{default:(0,r.k6)(()=>[(0,r.bF)(f,{color:"warning",variant:"elevated",onClick:s.showRevenueChart,disabled:!a.stats.dailyRevenue||0===a.stats.dailyRevenue.length},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[13]||(t[13]=[(0,r.eW)("mdi-chart-line",-1)])]),_:1}),t[14]||(t[14]=(0,r.eW)(" Show Revenue ",-1))]),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})):(0,r.Q3)("",!0),a.loading?((0,r.uX)(),(0,r.CE)("div",O,[(0,r.bF)(v,{indeterminate:"",color:"primary",size:"64"}),t[15]||(t[15]=(0,r.Lk)("div",{class:"mt-2"},"Loading...",-1))])):a.error?((0,r.uX)(),(0,r.Wv)(y,{key:2,type:"error",class:"mb-4"},{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(a.error),1)]),_:1})):0===a.salesRecords.length?((0,r.uX)(),(0,r.CE)("div",A,[(0,r.bF)(n,{size:"64",color:"grey"},{default:(0,r.k6)(()=>[...t[16]||(t[16]=[(0,r.eW)("mdi-inbox-outline",-1)])]),_:1}),t[17]||(t[17]=(0,r.Lk)("div",{class:"text-h6 mt-2"},"No Sales Records Found",-1)),t[18]||(t[18]=(0,r.Lk)("div",{class:"text-body-2 text-grey"},"Please adjust filter conditions or check data",-1))])):((0,r.uX)(),(0,r.CE)("div",X,[(0,r.bF)(R,{modelValue:o.expandedPanels,"onUpdate:modelValue":t[0]||(t[0]=e=>o.expandedPanels=e),multiple:""},{default:(0,r.k6)(()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.paginatedRecords,(e,a)=>((0,r.uX)(),(0,r.Wv)(w,{key:e.id||a,value:a},{default:(0,r.k6)(()=>[(0,r.bF)(b,null,{default:(0,r.k6)(({expanded:a})=>[(0,r.bF)(p,{"no-gutters":""},{default:(0,r.k6)(()=>[(0,r.bF)(g,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{icon:a?"mdi-chevron-up":"mdi-chevron-down"},null,8,["icon"]),(0,r.Lk)("span",H,(0,h.v_)(e.product),1)]),_:2},1024),(0,r.bF)(g,{cols:"12",md:"2"},{default:(0,r.k6)(()=>[t[19]||(t[19]=(0,r.Lk)("span",{class:"text-caption text-grey"},"Store:",-1)),(0,r.Lk)("div",z,(0,h.v_)(e.name),1)]),_:2},1024),(0,r.bF)(g,{cols:"12",md:"2"},{default:(0,r.k6)(()=>[t[20]||(t[20]=(0,r.Lk)("span",{class:"text-caption text-grey"},"Qty:",-1)),(0,r.Lk)("div",B,(0,h.v_)(e.quantity),1)]),_:2},1024),(0,r.bF)(g,{cols:"12",md:"2"},{default:(0,r.k6)(()=>[t[21]||(t[21]=(0,r.Lk)("span",{class:"text-caption text-grey"},"Unit:",-1)),(0,r.Lk)("div",j,"$"+(0,h.v_)(e.unit_price),1)]),_:2},1024),(0,r.bF)(g,{cols:"12",md:"2"},{default:(0,r.k6)(()=>[t[22]||(t[22]=(0,r.Lk)("span",{class:"text-caption text-grey"},"Total:",-1)),(0,r.Lk)("div",J,"$"+(0,h.v_)(e.price),1)]),_:2},1024),(0,r.bF)(g,{cols:"12",md:"1"},{default:(0,r.k6)(()=>[t[23]||(t[23]=(0,r.Lk)("span",{class:"text-caption text-grey"},"Time:",-1)),(0,r.Lk)("div",G,(0,h.v_)(s.formatDate(e.time)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,r.bF)(D,null,{default:(0,r.k6)(()=>[(0,r.bF)(k,{class:"mb-3"}),(0,r.bF)(p,null,{default:(0,r.k6)(()=>[(0,r.bF)(g,{cols:"12",md:"6"},{default:(0,r.k6)(()=>[(0,r.bF)(C,{density:"compact"},{default:(0,r.k6)(()=>[(0,r.bF)(S,null,{prepend:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[24]||(t[24]=[(0,r.eW)("mdi-store",-1)])]),_:1})]),default:(0,r.k6)(()=>[(0,r.bF)(F,null,{default:(0,r.k6)(()=>[...t[25]||(t[25]=[(0,r.eW)("Store Name",-1)])]),_:1}),(0,r.bF)(_,null,{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(e.name),1)]),_:2},1024)]),_:2},1024),(0,r.bF)(S,null,{prepend:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[26]||(t[26]=[(0,r.eW)("mdi-map-marker",-1)])]),_:1})]),default:(0,r.k6)(()=>[(0,r.bF)(F,null,{default:(0,r.k6)(()=>[...t[27]||(t[27]=[(0,r.eW)("Store Location",-1)])]),_:1}),(0,r.bF)(_,null,{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(e.store_location),1)]),_:2},1024)]),_:2},1024),(0,r.bF)(S,null,{prepend:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[28]||(t[28]=[(0,r.eW)("mdi-package-variant",-1)])]),_:1})]),default:(0,r.k6)(()=>[(0,r.bF)(F,null,{default:(0,r.k6)(()=>[...t[29]||(t[29]=[(0,r.eW)("Product",-1)])]),_:1}),(0,r.bF)(_,null,{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(e.product),1)]),_:2},1024)]),_:2},1024),(0,r.bF)(S,null,{prepend:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[30]||(t[30]=[(0,r.eW)("mdi-palette",-1)])]),_:1})]),default:(0,r.k6)(()=>[(0,r.bF)(F,null,{default:(0,r.k6)(()=>[...t[31]||(t[31]=[(0,r.eW)("Color",-1)])]),_:1}),(0,r.bF)(_,null,{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(e.color),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,r.bF)(g,{cols:"12",md:"6"},{default:(0,r.k6)(()=>[(0,r.bF)(C,{density:"compact"},{default:(0,r.k6)(()=>[e.storage?((0,r.uX)(),(0,r.Wv)(S,{key:0},{prepend:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[32]||(t[32]=[(0,r.eW)("mdi-memory",-1)])]),_:1})]),default:(0,r.k6)(()=>[(0,r.bF)(F,null,{default:(0,r.k6)(()=>[...t[33]||(t[33]=[(0,r.eW)("Storage",-1)])]),_:1}),(0,r.bF)(_,null,{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(e.storage)+"GB",1)]),_:2},1024)]),_:2},1024)):(0,r.Q3)("",!0),(0,r.bF)(S,null,{prepend:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[34]||(t[34]=[(0,r.eW)("mdi-numeric",-1)])]),_:1})]),default:(0,r.k6)(()=>[(0,r.bF)(F,null,{default:(0,r.k6)(()=>[...t[35]||(t[35]=[(0,r.eW)("Quantity",-1)])]),_:1}),(0,r.bF)(_,null,{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(e.quantity),1)]),_:2},1024)]),_:2},1024),(0,r.bF)(S,null,{prepend:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[36]||(t[36]=[(0,r.eW)("mdi-currency-usd",-1)])]),_:1})]),default:(0,r.k6)(()=>[(0,r.bF)(F,null,{default:(0,r.k6)(()=>[...t[37]||(t[37]=[(0,r.eW)("Unit Price",-1)])]),_:1}),(0,r.bF)(_,null,{default:(0,r.k6)(()=>[(0,r.eW)("$"+(0,h.v_)(e.unit_price),1)]),_:2},1024)]),_:2},1024),(0,r.bF)(S,null,{prepend:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[38]||(t[38]=[(0,r.eW)("mdi-calculator",-1)])]),_:1})]),default:(0,r.k6)(()=>[(0,r.bF)(F,null,{default:(0,r.k6)(()=>[...t[39]||(t[39]=[(0,r.eW)("Total Price",-1)])]),_:1}),(0,r.bF)(_,{class:"text-h6 text-primary"},{default:(0,r.k6)(()=>[(0,r.eW)("$"+(0,h.v_)(e.price),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),(0,r.bF)(k,{class:"mt-3"}),(0,r.bF)(p,{class:"mt-2"},{default:(0,r.k6)(()=>[(0,r.bF)(g,{cols:"12",class:"text-right"},{default:(0,r.k6)(()=>[(0,r.bF)(d,{color:"grey",variant:"outlined",size:"small"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{start:""},{default:(0,r.k6)(()=>[...t[40]||(t[40]=[(0,r.eW)("mdi-clock",-1)])]),_:1}),(0,r.eW)(" Sale Time: "+(0,h.v_)(s.formatDateTime(e.time)),1)]),_:2},1024),(0,r.bF)(d,{color:"grey",variant:"outlined",size:"small",class:"ml-2"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{start:""},{default:(0,r.k6)(()=>[...t[41]||(t[41]=[(0,r.eW)("mdi-identifier",-1)])]),_:1}),(0,r.eW)(" ID: "+(0,h.v_)(e.id),1)]),_:2},1024),e.order_id?((0,r.uX)(),(0,r.Wv)(d,{key:0,color:"primary",variant:"outlined",size:"small",class:"ml-2"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{start:""},{default:(0,r.k6)(()=>[...t[42]||(t[42]=[(0,r.eW)("mdi-receipt",-1)])]),_:1}),(0,r.eW)(" Order ID: "+(0,h.v_)(e.order_id),1)]),_:2},1024)):(0,r.Q3)("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s.totalPages>1?((0,r.uX)(),(0,r.Wv)(x,{key:0,modelValue:o.currentPage,"onUpdate:modelValue":[t[1]||(t[1]=e=>o.currentPage=e),s.onPageChange],length:s.totalPages,"total-visible":7,class:"mt-4"},null,8,["modelValue","length","onUpdate:modelValue"])):(0,r.Q3)("",!0)]))]),_:1}),(0,r.bF)($,{modelValue:o.showChartDialog,"onUpdate:modelValue":t[7]||(t[7]=e=>o.showChartDialog=e),"max-width":"1200px"},{default:(0,r.k6)(()=>[(0,r.bF)(m,null,{default:(0,r.k6)(()=>[(0,r.bF)(c,{class:"d-flex align-center"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:"",color:"primary"},{default:(0,r.k6)(()=>[...t[43]||(t[43]=[(0,r.eW)("mdi-chart-line",-1)])]),_:1}),t[44]||(t[44]=(0,r.eW)(" Revenue Analysis ",-1)),(0,r.bF)(i),(0,r.bF)(f,{icon:"mdi-close",variant:"text",onClick:t[2]||(t[2]=e=>o.showChartDialog=!1)})]),_:1}),(0,r.bF)(u,null,{default:(0,r.k6)(()=>[(0,r.bF)(m,{class:"mb-4",variant:"outlined"},{default:(0,r.k6)(()=>[(0,r.bF)(c,{class:"text-subtitle-1"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[45]||(t[45]=[(0,r.eW)("mdi-calendar-range",-1)])]),_:1}),t[46]||(t[46]=(0,r.eW)(" Date Range Filter ",-1))]),_:1}),(0,r.bF)(u,null,{default:(0,r.k6)(()=>[(0,r.bF)(p,null,{default:(0,r.k6)(()=>[(0,r.bF)(g,{cols:"12",md:"4"},{default:(0,r.k6)(()=>[(0,r.bF)(W,{modelValue:o.revenueDateRange.startDate,"onUpdate:modelValue":[t[3]||(t[3]=e=>o.revenueDateRange.startDate=e),s.onRevenueDateRangeChange],label:"Start Date",type:"date","prepend-icon":"mdi-calendar-start",variant:"outlined",density:"compact",max:o.revenueDateRange.endDate||(new Date).toISOString().split("T")[0]},null,8,["modelValue","max","onUpdate:modelValue"])]),_:1}),(0,r.bF)(g,{cols:"12",md:"4"},{default:(0,r.k6)(()=>[(0,r.bF)(W,{modelValue:o.revenueDateRange.endDate,"onUpdate:modelValue":[t[4]||(t[4]=e=>o.revenueDateRange.endDate=e),s.onRevenueDateRangeChange],label:"End Date",type:"date","prepend-icon":"mdi-calendar-end",variant:"outlined",density:"compact",min:o.revenueDateRange.startDate,max:(new Date).toISOString().split("T")[0]},null,8,["modelValue","min","max","onUpdate:modelValue"])]),_:1}),(0,r.bF)(g,{cols:"12",md:"4",class:"d-flex align-center"},{default:(0,r.k6)(()=>[(0,r.bF)(f,{color:"primary",variant:"outlined",onClick:s.applyRevenueDateRange,disabled:!o.revenueDateRange.startDate||!o.revenueDateRange.endDate,class:"mr-2"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[47]||(t[47]=[(0,r.eW)("mdi-filter",-1)])]),_:1}),t[48]||(t[48]=(0,r.eW)(" Apply Filter ",-1))]),_:1},8,["onClick","disabled"]),(0,r.bF)(f,{color:"secondary",variant:"text",onClick:s.clearRevenueDateRange},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[49]||(t[49]=[(0,r.eW)("mdi-refresh",-1)])]),_:1}),t[50]||(t[50]=(0,r.eW)(" Clear ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),(0,r.bF)(P,{modelValue:o.activeTab,"onUpdate:modelValue":t[5]||(t[5]=e=>o.activeTab=e),class:"mb-4"},{default:(0,r.k6)(()=>[(0,r.bF)(V,{value:"daily"},{default:(0,r.k6)(()=>[...t[51]||(t[51]=[(0,r.eW)("Daily Revenue",-1)])]),_:1}),(0,r.bF)(V,{value:"monthly"},{default:(0,r.k6)(()=>[...t[52]||(t[52]=[(0,r.eW)("Monthly Revenue",-1)])]),_:1})]),_:1},8,["modelValue"]),(0,r.bF)(N,{modelValue:o.activeTab,"onUpdate:modelValue":t[6]||(t[6]=e=>o.activeTab=e)},{default:(0,r.k6)(()=>[(0,r.bF)(L,{value:"daily"},{default:(0,r.k6)(()=>[s.filteredDailyRevenue&&s.filteredDailyRevenue.length>0?((0,r.uX)(),(0,r.CE)("div",Z,[(0,r.bF)(I,{data:s.filteredDailyRevenue,type:"daily",title:"Daily Revenue Trend"},null,8,["data"])])):((0,r.uX)(),(0,r.CE)("div",K,[(0,r.bF)(n,{size:"64",color:"grey"},{default:(0,r.k6)(()=>[...t[53]||(t[53]=[(0,r.eW)("mdi-chart-line",-1)])]),_:1}),t[54]||(t[54]=(0,r.Lk)("div",{class:"text-h6 mt-2"},"No Daily Revenue Data",-1)),t[55]||(t[55]=(0,r.Lk)("div",{class:"text-body-2 text-grey"},"No sales data available for daily analysis",-1))]))]),_:1}),(0,r.bF)(L,{value:"monthly"},{default:(0,r.k6)(()=>[s.filteredMonthlyRevenue&&s.filteredMonthlyRevenue.length>0?((0,r.uX)(),(0,r.CE)("div",Y,[(0,r.bF)(I,{data:s.filteredMonthlyRevenue,type:"monthly",title:"Monthly Revenue Trend"},null,8,["data"])])):((0,r.uX)(),(0,r.CE)("div",ee,[(0,r.bF)(n,{size:"64",color:"grey"},{default:(0,r.k6)(()=>[...t[56]||(t[56]=[(0,r.eW)("mdi-chart-line",-1)])]),_:1}),t[57]||(t[57]=(0,r.Lk)("div",{class:"text-h6 mt-2"},"No Monthly Revenue Data",-1)),t[58]||(t[58]=(0,r.Lk)("div",{class:"text-body-2 text-grey"},"No sales data available for monthly analysis",-1))]))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const ae={class:"revenue-chart"},le={key:0,class:"mb-4"},re={class:"chart-container"},oe={ref:"chartCanvas"};function se(e,t,a,l,o,s){const n=(0,r.g2)("v-icon"),i=(0,r.g2)("v-spacer"),d=(0,r.g2)("v-chip"),c=(0,r.g2)("v-card-title"),u=(0,r.g2)("v-text-field"),m=(0,r.g2)("v-col"),g=(0,r.g2)("v-btn"),f=(0,r.g2)("v-row"),p=(0,r.g2)("v-card-text"),v=(0,r.g2)("v-card");return(0,r.uX)(),(0,r.CE)("div",ae,[(0,r.bF)(v,null,{default:(0,r.k6)(()=>[(0,r.bF)(c,{class:"d-flex align-center"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:"",color:"primary"},{default:(0,r.k6)(()=>[...t[1]||(t[1]=[(0,r.eW)("mdi-chart-line",-1)])]),_:1}),(0,r.eW)(" "+(0,h.v_)(a.title)+" ",1),(0,r.bF)(i),(0,r.bF)(d,{color:"success",variant:"outlined"},{default:(0,r.k6)(()=>[(0,r.eW)(" Total: $"+(0,h.v_)(s.totalRevenue.toLocaleString()),1)]),_:1})]),_:1}),(0,r.bF)(p,null,{default:(0,r.k6)(()=>["daily"===a.type?((0,r.uX)(),(0,r.CE)("div",le,[(0,r.bF)(f,{align:"center"},{default:(0,r.k6)(()=>[(0,r.bF)(m,{cols:"12",md:"6"},{default:(0,r.k6)(()=>[(0,r.bF)(u,{modelValue:o.selectedDate,"onUpdate:modelValue":[t[0]||(t[0]=e=>o.selectedDate=e),s.onDateChange],label:"Select Day",type:"date","prepend-icon":"mdi-calendar",variant:"outlined",density:"compact",max:(new Date).toISOString().split("T")[0],onBlur:s.onDateChange},null,8,["modelValue","max","onUpdate:modelValue","onBlur"])]),_:1}),(0,r.bF)(m,{cols:"12",md:"6"},{default:(0,r.k6)(()=>[(0,r.bF)(g,{color:"primary",variant:"outlined",onClick:s.loadHourlyData,loading:o.loadingHourlyData,disabled:!o.selectedDate},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[2]||(t[2]=[(0,r.eW)("mdi-refresh",-1)])]),_:1}),t[3]||(t[3]=(0,r.eW)(" Load Hourly Data ",-1))]),_:1},8,["onClick","loading","disabled"])]),_:1})]),_:1})])):(0,r.Q3)("",!0),(0,r.Lk)("div",re,[(0,r.Lk)("canvas",oe,null,512)])]),_:1})]),_:1})])}a(116);var ne=a(3861),ie={name:"RevenueChart",props:{data:{type:Array,required:!0},type:{type:String,required:!0,validator:e=>["daily","monthly"].includes(e)},title:{type:String,required:!0}},data(){return{chart:null,selectedDate:"",loadingHourlyData:!1,hourlyData:[],updateTimeout:null}},computed:{totalRevenue(){return this.data&&Array.isArray(this.data)?this.data.reduce((e,t)=>{const a=parseFloat(t.revenue);return e+(isNaN(a)?0:a)},0):0}},mounted(){this.$nextTick(()=>{this.createChart()})},beforeUnmount(){this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateTimeout=null),this.chart&&(this.chart.destroy(),this.chart=null)},watch:{data:{handler(e,t){JSON.stringify(e)!==JSON.stringify(t)&&this.debouncedUpdateChart()},deep:!0},hourlyData:{handler(e,t){JSON.stringify(e)!==JSON.stringify(t)&&this.debouncedUpdateChart()},deep:!0}},methods:{debouncedUpdateChart(){this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.$nextTick(()=>{this.updateChart()})},100)},getChartConfig(){const e=this.type||"daily",t=this.hourlyData.length>0,a="daily"===e&&t;let l,r;if(a){l=Array.from({length:24},(e,t)=>`${t}:00`);const e=Array.from({length:24},(e,t)=>{const a=this.hourlyData.find(e=>e.hour===t);return a?a.revenue:0});r=[{label:"Hourly Revenue",data:e,borderColor:"#1976d2",backgroundColor:"rgba(25, 118, 210, 0.1)",borderWidth:2,fill:!1,tension:.4,pointRadius:4,pointHoverRadius:6}]}else{l=R(this.data,e);const t=x(this.data);r=[{label:"daily"===e?"Daily Revenue":"Monthly Revenue",data:t,borderColor:"#1976d2",backgroundColor:"rgba(25, 118, 210, 0.1)",borderWidth:2,fill:!1,tension:.4,pointRadius:4,pointHoverRadius:6}]}return{type:"line",data:{labels:l,datasets:r},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:750,easing:"easeInOutQuart"},plugins:{legend:{display:!0,position:"top"},tooltip:{enabled:!0,callbacks:{label:function(e){return`${e.dataset.label}: $${e.parsed.y.toLocaleString()}`}}}},scales:{x:{display:!0,title:{display:!0,text:a?"Time (Hours)":"daily"===e?"Date":"Month"},grid:{display:!0,color:"rgba(0, 0, 0, 0.1)"}},y:{display:!0,title:{display:!0,text:"Revenue ($)"},grid:{display:!0,color:"rgba(0, 0, 0, 0.1)"},ticks:{callback:function(e){return"$"+e.toLocaleString()}}}},interaction:{intersect:!1,mode:"index"}}}},createChart(){if(this.$refs.chartCanvas)if(this.$refs.chartCanvas.parentNode)try{this.chart&&(this.chart.destroy(),this.chart=null);const e=this.getChartConfig(),t=this.$refs.chartCanvas;0!==t.width&&0!==t.height||(t.width=t.offsetWidth||400,t.height=t.offsetHeight||300),this.chart=new ne.Ay(t,e)}catch(e){console.error("RevenueChart: Error creating chart:",e),this.chart=null}else console.warn("RevenueChart: Canvas element not mounted to DOM");else console.warn("RevenueChart: Canvas element not found")},updateChart(){if(this.chart){if(!this.chart.canvas||!this.chart.canvas.parentNode)return console.warn("RevenueChart: Chart canvas is no longer valid, recreating..."),void this.createChart();try{const e=this.getChartConfig();this.chart.data.labels=e.data.labels,this.chart.data.datasets=e.data.datasets,this.chart.update("none")}catch(e){console.error("RevenueChart: Error updating chart:",e),this.createChart()}}else this.createChart()},onDateChange(){this.hourlyData=[],this.selectedDate&&this.loadHourlyData()},async loadHourlyData(){if(this.selectedDate){this.loadingHourlyData=!0;try{const e=w(this.data,this.selectedDate);this.hourlyData=e}catch(e){console.error("Failed to load hourly data:",e),this.$emit("error","Failed to load hourly revenue data"),this.hourlyData=[]}finally{this.loadingHourlyData=!1}}}}};const de=(0,n.A)(ie,[["render",se],["__scopeId","data-v-b9114bc4"]]);var ce=de,ue={name:"SalesRecordList",components:{RevenueChart:ce},props:{salesRecords:{type:Array,default:()=>[]},stats:{type:Object,default:null},loading:{type:Boolean,default:!1},error:{type:String,default:""}},data(){return{currentPage:1,itemsPerPage:20,expandedPanels:[],showChartDialog:!1,activeTab:"daily",revenueDateRange:{startDate:"",endDate:""}}},computed:{totalRecords(){return this.salesRecords.length},totalPages(){return Math.ceil(this.totalRecords/this.itemsPerPage)},paginatedRecords(){const e=(this.currentPage-1)*this.itemsPerPage,t=e+this.itemsPerPage;return this.salesRecords.slice(e,t)},filteredSalesRecords(){if(!this.revenueDateRange.startDate||!this.revenueDateRange.endDate)return this.salesRecords;const e=new Date(this.revenueDateRange.startDate);e.setHours(0,0,0,0);const t=new Date(this.revenueDateRange.endDate);return t.setHours(23,59,59,999),this.salesRecords.filter(a=>{if(!a.time)return!1;const l=new Date(a.time);return l>=e&&l<=t})},filteredDailyRevenue(){if(!this.stats||!this.stats.dailyRevenue)return[];if(!this.revenueDateRange.startDate||!this.revenueDateRange.endDate)return this.stats.dailyRevenue;const e=new Date(this.revenueDateRange.startDate),t=new Date(this.revenueDateRange.endDate);return this.stats.dailyRevenue.filter(a=>{const l=new Date(a.date);return l>=e&&l<=t})},filteredMonthlyRevenue(){if(!this.stats||!this.stats.monthlyRevenue)return[];if(!this.revenueDateRange.startDate||!this.revenueDateRange.endDate)return this.stats.monthlyRevenue;const e=new Date(this.revenueDateRange.startDate),t=new Date(this.revenueDateRange.endDate);return this.stats.monthlyRevenue.filter(a=>{const[l,r]=a.month.split("-"),o=new Date(l,r-1,1);return o>=e&&o<=t})}},watch:{salesRecords(){this.currentPage=1,this.expandedPanels=[]}},methods:{formatDate(e){if(!e)return"";const t=new Date(e),a=new Date(t.getTime()+288e5);return a.toLocaleDateString("en-US")},formatDateTime(e){if(!e)return"";const t=new Date(e),a=new Date(t.getTime()+288e5);return a.toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})},onPageChange(e){this.currentPage=e,this.$nextTick(()=>{const e=this.$el.querySelector(".v-card");e&&e.scrollIntoView({behavior:"smooth"})})},expandAll(){this.expandedPanels=Array.from({length:this.paginatedRecords.length},(e,t)=>t)},collapseAll(){this.expandedPanels=[]},showRevenueChart(){this.showChartDialog=!0,this.activeTab="daily"},onRevenueDateRangeChange(){this.revenueDateRange.startDate&&this.revenueDateRange.endDate&&this.applyRevenueDateRange()},applyRevenueDateRange(){this.$forceUpdate()},clearRevenueDateRange(){this.revenueDateRange.startDate="",this.revenueDateRange.endDate="",this.applyRevenueDateRange()}}};const me=(0,n.A)(ue,[["render",te],["__scopeId","data-v-afa57116"]]);var ge=me;const he={key:0,class:"text-center py-8"},fe={key:2,class:"text-center py-8"},pe={key:3},ve={class:"font-weight-bold text-success"},ye={class:"font-weight-bold text-primary"},be={class:"font-weight-bold text-info"},ke={class:"font-weight-bold text-warning"},Fe={class:"text-h6"},_e={class:"text-h6"},Se={class:"text-h6"},Ce={class:"text-h6"};function De(e,t,a,l,o,s){const n=(0,r.g2)("v-icon"),i=(0,r.g2)("v-spacer"),d=(0,r.g2)("v-chip"),c=(0,r.g2)("v-card-title"),u=(0,r.g2)("v-select"),m=(0,r.g2)("v-col"),g=(0,r.g2)("v-text-field"),f=(0,r.g2)("v-row"),p=(0,r.g2)("v-combobox"),v=(0,r.g2)("v-btn"),y=(0,r.g2)("v-card-text"),b=(0,r.g2)("v-card"),k=(0,r.g2)("v-progress-circular"),F=(0,r.g2)("v-alert"),_=(0,r.g2)("v-avatar"),S=(0,r.g2)("v-list-item-title"),C=(0,r.g2)("v-list-item-subtitle"),D=(0,r.g2)("v-list-item"),w=(0,r.g2)("v-list");return(0,r.uX)(),(0,r.Wv)(b,null,{default:(0,r.k6)(()=>[(0,r.bF)(c,{class:"d-flex align-center"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:"",color:"primary"},{default:(0,r.k6)(()=>[...t[6]||(t[6]=[(0,r.eW)("mdi-trophy",-1)])]),_:1}),t[7]||(t[7]=(0,r.eW)(" Sales Ranking ",-1)),(0,r.bF)(i),(0,r.bF)(d,{color:"primary",variant:"outlined"},{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(o.totalProducts)+" Products ",1)]),_:1})]),_:1}),(0,r.bF)(y,null,{default:(0,r.k6)(()=>[(0,r.bF)(b,{variant:"outlined",class:"mb-4"},{default:(0,r.k6)(()=>[(0,r.bF)(c,{class:"text-subtitle-1"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[8]||(t[8]=[(0,r.eW)("mdi-filter",-1)])]),_:1}),t[9]||(t[9]=(0,r.eW)(" Ranking Filters ",-1))]),_:1}),(0,r.bF)(y,null,{default:(0,r.k6)(()=>[(0,r.bF)(f,null,{default:(0,r.k6)(()=>[(0,r.bF)(m,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(u,{modelValue:o.rankingFilters.sortBy,"onUpdate:modelValue":[t[0]||(t[0]=e=>o.rankingFilters.sortBy=e),s.onFiltersChange],items:o.sortOptions,label:"Sort By",outlined:"",dense:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),(0,r.bF)(m,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(g,{modelValue:o.rankingFilters.startDate,"onUpdate:modelValue":[t[1]||(t[1]=e=>o.rankingFilters.startDate=e),s.onFiltersChange],label:"Start Date",type:"date",outlined:"",dense:"",max:o.rankingFilters.endDate||(new Date).toISOString().split("T")[0]},null,8,["modelValue","max","onUpdate:modelValue"])]),_:1}),(0,r.bF)(m,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(g,{modelValue:o.rankingFilters.endDate,"onUpdate:modelValue":[t[2]||(t[2]=e=>o.rankingFilters.endDate=e),s.onFiltersChange],label:"End Date",type:"date",outlined:"",dense:"",min:o.rankingFilters.startDate,max:(new Date).toISOString().split("T")[0]},null,8,["modelValue","min","max","onUpdate:modelValue"])]),_:1}),(0,r.bF)(m,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(g,{modelValue:o.rankingFilters.limit,"onUpdate:modelValue":[t[3]||(t[3]=e=>o.rankingFilters.limit=e),s.onFiltersChange],label:"Display Count",type:"number",outlined:"",dense:"",min:"1",max:"100"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1}),(0,r.bF)(f,null,{default:(0,r.k6)(()=>[(0,r.bF)(m,{cols:"12",md:"6"},{default:(0,r.k6)(()=>[(0,r.bF)(p,{modelValue:o.rankingFilters.products,"onUpdate:modelValue":[t[4]||(t[4]=e=>o.rankingFilters.products=e),s.onFiltersChange],items:o.availableProducts,label:"Product Filter",placeholder:"Select specific products",outlined:"",dense:"",multiple:"",chips:"",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),(0,r.bF)(m,{cols:"12",md:"6"},{default:(0,r.k6)(()=>[(0,r.bF)(p,{modelValue:o.rankingFilters.stores,"onUpdate:modelValue":[t[5]||(t[5]=e=>o.rankingFilters.stores=e),s.onFiltersChange],items:o.availableStores,label:"Store Filter",placeholder:"Select specific stores",outlined:"",dense:"",multiple:"",chips:"",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1})]),_:1}),(0,r.bF)(f,null,{default:(0,r.k6)(()=>[(0,r.bF)(m,{cols:"12",class:"text-right"},{default:(0,r.k6)(()=>[(0,r.bF)(v,{color:"secondary",onClick:s.resetFilters,class:"mr-2"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[10]||(t[10]=[(0,r.eW)("mdi-refresh",-1)])]),_:1}),t[11]||(t[11]=(0,r.eW)(" Reset ",-1))]),_:1},8,["onClick"]),(0,r.bF)(v,{color:"primary",onClick:s.loadRankingData,loading:o.loading},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[12]||(t[12]=[(0,r.eW)("mdi-magnify",-1)])]),_:1}),t[13]||(t[13]=(0,r.eW)(" Update Ranking ",-1))]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1})]),_:1}),o.loading?((0,r.uX)(),(0,r.CE)("div",he,[(0,r.bF)(k,{indeterminate:"",color:"primary",size:"64"}),t[14]||(t[14]=(0,r.Lk)("div",{class:"mt-2"},"Loading ranking data...",-1))])):o.error?((0,r.uX)(),(0,r.Wv)(F,{key:1,type:"error",class:"mb-4"},{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(o.error),1)]),_:1})):0===o.rankingData.length?((0,r.uX)(),(0,r.CE)("div",fe,[(0,r.bF)(n,{size:"64",color:"grey"},{default:(0,r.k6)(()=>[...t[15]||(t[15]=[(0,r.eW)("mdi-trophy-outline",-1)])]),_:1}),t[16]||(t[16]=(0,r.Lk)("div",{class:"text-h6 mt-2"},"No ranking data",-1)),t[17]||(t[17]=(0,r.Lk)("div",{class:"text-body-2 text-grey"},"Please adjust filters or check data",-1))])):((0,r.uX)(),(0,r.CE)("div",pe,[(0,r.bF)(w,null,{default:(0,r.k6)(()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.rankingData,(e,a)=>((0,r.uX)(),(0,r.Wv)(D,{key:e.product,class:(0,h.C4)(["mb-2",s.getRankingItemClass(a)])},{prepend:(0,r.k6)(()=>[(0,r.bF)(_,{color:s.getRankingColor(a),size:"40",class:"font-weight-bold"},{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(a+1),1)]),_:2},1032,["color"])]),append:(0,r.k6)(()=>[(0,r.bF)(d,{color:s.getRankingColor(a),variant:"outlined",size:"small"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{start:""},{default:(0,r.k6)(()=>[...t[26]||(t[26]=[(0,r.eW)("mdi-trophy",-1)])]),_:1}),(0,r.eW)(" "+(0,h.v_)(s.getRankingText(a)),1)]),_:2},1032,["color"])]),default:(0,r.k6)(()=>[(0,r.bF)(S,{class:"text-h6"},{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(e.product),1)]),_:2},1024),(0,r.bF)(C,null,{default:(0,r.k6)(()=>[(0,r.bF)(f,{"no-gutters":""},{default:(0,r.k6)(()=>[(0,r.bF)(m,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{small:"",class:"mr-1"},{default:(0,r.k6)(()=>[...t[18]||(t[18]=[(0,r.eW)("mdi-cash",-1)])]),_:1}),(0,r.Lk)("span",ve," $"+(0,h.v_)(e.totalRevenue.toLocaleString()),1),t[19]||(t[19]=(0,r.Lk)("div",{class:"text-caption"},"Total Revenue",-1))]),_:2},1024),(0,r.bF)(m,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{small:"",class:"mr-1"},{default:(0,r.k6)(()=>[...t[20]||(t[20]=[(0,r.eW)("mdi-package-variant",-1)])]),_:1}),(0,r.Lk)("span",ye,(0,h.v_)(e.totalQuantity),1),t[21]||(t[21]=(0,r.Lk)("div",{class:"text-caption"},"Total Quantity",-1))]),_:2},1024),(0,r.bF)(m,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{small:"",class:"mr-1"},{default:(0,r.k6)(()=>[...t[22]||(t[22]=[(0,r.eW)("mdi-store",-1)])]),_:1}),(0,r.Lk)("span",be,(0,h.v_)(e.storeCount),1),t[23]||(t[23]=(0,r.Lk)("div",{class:"text-caption"},"Store Count",-1))]),_:2},1024),(0,r.bF)(m,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{small:"",class:"mr-1"},{default:(0,r.k6)(()=>[...t[24]||(t[24]=[(0,r.eW)("mdi-chart-line",-1)])]),_:1}),(0,r.Lk)("span",ke," $"+(0,h.v_)(e.averagePrice.toFixed(2)),1),t[25]||(t[25]=(0,r.Lk)("div",{class:"text-caption"},"Average Price",-1))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1}),(0,r.bF)(b,{variant:"outlined",class:"mt-4"},{default:(0,r.k6)(()=>[(0,r.bF)(c,{class:"text-subtitle-1"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{left:""},{default:(0,r.k6)(()=>[...t[27]||(t[27]=[(0,r.eW)("mdi-chart-box",-1)])]),_:1}),t[28]||(t[28]=(0,r.eW)(" Ranking Statistics ",-1))]),_:1}),(0,r.bF)(y,null,{default:(0,r.k6)(()=>[(0,r.bF)(f,null,{default:(0,r.k6)(()=>[(0,r.bF)(m,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(b,{color:"primary",variant:"tonal"},{default:(0,r.k6)(()=>[(0,r.bF)(y,{class:"text-center"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",Fe,(0,h.v_)(o.rankingData.length),1),t[29]||(t[29]=(0,r.Lk)("div",{class:"text-caption"},"Ranked Products",-1))]),_:1})]),_:1})]),_:1}),(0,r.bF)(m,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(b,{color:"success",variant:"tonal"},{default:(0,r.k6)(()=>[(0,r.bF)(y,{class:"text-center"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",_e,"$"+(0,h.v_)(s.totalRevenue.toLocaleString()),1),t[30]||(t[30]=(0,r.Lk)("div",{class:"text-caption"},"Total Revenue",-1))]),_:1})]),_:1})]),_:1}),(0,r.bF)(m,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(b,{color:"info",variant:"tonal"},{default:(0,r.k6)(()=>[(0,r.bF)(y,{class:"text-center"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",Se,(0,h.v_)(s.totalQuantity),1),t[31]||(t[31]=(0,r.Lk)("div",{class:"text-caption"},"Total Quantity",-1))]),_:1})]),_:1})]),_:1}),(0,r.bF)(m,{cols:"12",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(b,{color:"warning",variant:"tonal"},{default:(0,r.k6)(()=>[(0,r.bF)(y,{class:"text-center"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",Ce,"$"+(0,h.v_)(s.averagePrice.toFixed(2)),1),t[32]||(t[32]=(0,r.Lk)("div",{class:"text-caption"},"Average Price",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))]),_:1})]),_:1})}var we={name:"SalesRanking",data(){return{rankingData:[],loading:!1,error:"",totalProducts:0,availableProducts:[],availableStores:[],rankingFilters:{sortBy:"revenue",startDate:"",endDate:"",limit:10,products:[],stores:[]},sortOptions:[{title:"Sort by Revenue",value:"revenue"},{title:"Sort by Quantity",value:"quantity"},{title:"Sort by Store Count",value:"stores"},{title:"Sort by Average Price",value:"price"}]}},computed:{totalRevenue(){return this.rankingData.reduce((e,t)=>e+t.totalRevenue,0)},totalQuantity(){return this.rankingData.reduce((e,t)=>e+t.totalQuantity,0)},averagePrice(){return 0===this.rankingData.length?0:this.totalRevenue/this.totalQuantity}},async mounted(){await this.loadFilterOptions(),await this.loadRankingData()},methods:{async loadFilterOptions(){try{const[e,t]=await Promise.all([I(),L()]);this.availableProducts=e,this.availableStores=t}catch(e){console.error("Failed to load filter options:",e),this.error="Failed to load filter options"}},async loadRankingData(){this.loading=!0,this.error="";try{const e=this.buildFilters(),t=await $(e);this.rankingData=t.ranking||[],this.totalProducts=t.total||0,0===this.rankingData.length&&(this.error="No products found matching the criteria")}catch(e){console.error("Failed to load ranking data:",e),this.error="Failed to load ranking data: "+e.message,this.rankingData=[],this.totalProducts=0}finally{this.loading=!1}},buildFilters(){const e={sortBy:this.rankingFilters.sortBy,limit:parseInt(this.rankingFilters.limit)||10};return this.rankingFilters.startDate&&this.rankingFilters.endDate&&(e.dateRange=[this.rankingFilters.startDate,this.rankingFilters.endDate]),this.rankingFilters.products.length>0&&(e.products=this.rankingFilters.products),this.rankingFilters.stores.length>0&&(e.stores=this.rankingFilters.stores),e},onFiltersChange(){this.loadRankingData()},resetFilters(){this.rankingFilters={sortBy:"revenue",startDate:"",endDate:"",limit:10,products:[],stores:[]},this.loadRankingData()},getRankingColor(e){return 0===e?"amber":1===e?"grey":2===e?"orange":"primary"},getRankingText(e){return 0===e?"Champion":1===e?"Runner-up":2===e?"Third Place":`#${e+1}`},getRankingItemClass(e){return e<3?"ranking-top":""}}};const Re=(0,n.A)(we,[["render",De],["__scopeId","data-v-9d773ab0"]]);var xe=Re,We={name:"SalesRecord",components:{SalesRecordFilters:Q,SalesRecordList:ge,SalesRanking:xe},data(){return{salesRecords:[],salesStats:null,loading:!1,isRefreshing:!1,error:"",showErrorDialog:!1,errorDialogMessage:"",currentFilters:{}}},async mounted(){await this.loadSalesData()},methods:{async onFiltersChange(e){this.currentFilters=e,await this.loadSalesData(e)},async loadSalesData(e={}){this.loading=!0,this.error="";try{const[t,a]=await Promise.all([P(e),N(e)]);this.salesRecords=t,this.salesStats=a,0===t.length&&Object.keys(e).length>0&&(this.error="No sales records found matching the criteria. Please try adjusting the filter conditions")}catch(t){console.error("Failed to load sales data:",t),this.error="Failed to load sales records: "+t.message,this.salesRecords=[],this.salesStats=null}finally{this.loading=!1}},async refreshData(){this.isRefreshing=!0;try{await this.loadSalesData(this.currentFilters)}finally{this.isRefreshing=!1}},onFilterError(e){this.errorDialogMessage=e,this.showErrorDialog=!0}}};const Ve=(0,n.A)(We,[["render",f],["__scopeId","data-v-011e5758"]]);var Pe=Ve;const Ie={key:0},Le={key:1};function Ne(e,t,a,l,o,s){const n=(0,r.g2)("v-card-title"),i=(0,r.g2)("v-text-field"),d=(0,r.g2)("v-col"),c=(0,r.g2)("v-row"),u=(0,r.g2)("v-data-table"),m=(0,r.g2)("v-card-text"),g=(0,r.g2)("v-card"),f=(0,r.g2)("v-container");return(0,r.uX)(),(0,r.Wv)(f,{fluid:""},{default:(0,r.k6)(()=>[(0,r.bF)(c,null,{default:(0,r.k6)(()=>[(0,r.bF)(d,{cols:"12"},{default:(0,r.k6)(()=>[(0,r.bF)(g,null,{default:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[5]||(t[5]=[(0,r.Lk)("h1",{class:"text-h4"},"Inventory",-1)])]),_:1}),(0,r.bF)(m,null,{default:(0,r.k6)(()=>[(0,r.bF)(c,{class:"mb-4",dense:""},{default:(0,r.k6)(()=>[(0,r.bF)(d,{cols:"12",sm:"6",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(i,{modelValue:o.idFilter,"onUpdate:modelValue":t[0]||(t[0]=e=>o.idFilter=e),label:"ID",clearable:"",density:"comfortable"},null,8,["modelValue"])]),_:1}),(0,r.bF)(d,{cols:"12",sm:"6",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(i,{modelValue:o.productFilter,"onUpdate:modelValue":t[1]||(t[1]=e=>o.productFilter=e),label:"Product",clearable:"",density:"comfortable"},null,8,["modelValue"])]),_:1}),(0,r.bF)(d,{cols:"12",sm:"6",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(i,{modelValue:o.nameFilter,"onUpdate:modelValue":t[2]||(t[2]=e=>o.nameFilter=e),label:"Store Name",clearable:"",density:"comfortable"},null,8,["modelValue"])]),_:1}),(0,r.bF)(d,{cols:"12",sm:"6",md:"3"},{default:(0,r.k6)(()=>[(0,r.bF)(i,{modelValue:o.locationFilter,"onUpdate:modelValue":t[3]||(t[3]=e=>o.locationFilter=e),label:"Store Location",clearable:"",density:"comfortable"},null,8,["modelValue"])]),_:1})]),_:1}),(0,r.bF)(u,{headers:o.headers,items:s.filteredProducts,"sort-by":o.sortBy,"onUpdate:sortBy":t[4]||(t[4]=e=>o.sortBy=e)},{["item.price"]:(0,r.k6)(({item:e})=>[null!==e.price&&void 0!==e.price?((0,r.uX)(),(0,r.CE)("span",Ie," $"+(0,h.v_)(e.price),1)):((0,r.uX)(),(0,r.CE)("span",Le,"-"))]),_:2},1032,["headers","items","sort-by"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const $e="inventory";var Te={name:"InventoryPage",data(){return{headers:[{title:"ID",value:"id"},{title:"Product",value:"product"},{title:"Color",value:"color"},{title:"Storage",value:"storage"},{title:"Stock Quantity",value:"quantity"},{title:"Price",value:"price"},{title:"Store Name",value:"name"},{title:"Store Location",value:"location"},{title:"Update Time",value:"UpdateTime"}],products:[],idFilter:"",productFilter:"",nameFilter:"",locationFilter:"",sortBy:[{key:"name",order:"asc"}]}},computed:{filteredProducts(){const e=String(this.idFilter||"").trim().toLowerCase(),t=String(this.productFilter||"").trim().toLowerCase(),a=String(this.nameFilter||"").trim().toLowerCase(),l=String(this.locationFilter||"").trim().toLowerCase();return e||t||a||l?(this.products||[]).filter(r=>{const o=r&&void 0!==r.id&&null!==r.id?String(r.id).toLowerCase():"",s=r&&r.product?String(r.product).toLowerCase():"",n=r&&r.name?String(r.name).toLowerCase():"",i=r&&r.location?String(r.location).toLowerCase():"",d=!e||o.includes(e),c=!t||s.includes(t),u=!a||n.includes(a),m=!l||i.includes(l);return d&&c&&u&&m}):this.products}},async mounted(){try{const{data:e,error:t}=await F.from($e).select("*");if(t)throw t;this.products=e}catch(e){console.error("Error fetching data:",e)}}};const Ee=(0,n.A)(Te,[["render",Ne]]);var Qe=Ee;const Ue={class:"text-h6"};function qe(e,t,a,l,o,s){const n=(0,r.g2)("v-card-title"),i=(0,r.g2)("InventorySearchPanel"),d=(0,r.g2)("v-radio"),c=(0,r.g2)("v-radio-group"),u=(0,r.g2)("v-col"),m=(0,r.g2)("v-text-field"),g=(0,r.g2)("v-row"),f=(0,r.g2)("v-card-text"),p=(0,r.g2)("v-card"),v=(0,r.g2)("v-btn"),y=(0,r.g2)("v-alert"),b=(0,r.g2)("CartPanel"),k=(0,r.g2)("v-container");return(0,r.uX)(),(0,r.Wv)(k,{fluid:""},{default:(0,r.k6)(()=>[(0,r.bF)(g,null,{default:(0,r.k6)(()=>[(0,r.bF)(u,{cols:"12"},{default:(0,r.k6)(()=>[(0,r.bF)(p,null,{default:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[2]||(t[2]=[(0,r.Lk)("h1",{class:"text-h4"},"Selling",-1)])]),_:1}),(0,r.bF)(f,null,{default:(0,r.k6)(()=>[(0,r.bF)(i,{onChange:s.onSelectionChange},null,8,["onChange"]),o.selectedItem?((0,r.uX)(),(0,r.Wv)(p,{key:0,class:"mt-4",elevation:"2"},{default:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[3]||(t[3]=[(0,r.eW)("Select Sale Quantity",-1)])]),_:1}),(0,r.bF)(f,null,{default:(0,r.k6)(()=>[(0,r.bF)(g,null,{default:(0,r.k6)(()=>[(0,r.bF)(u,{cols:"12"},{default:(0,r.k6)(()=>[(0,r.bF)(c,{modelValue:o.selectedQuantity,"onUpdate:modelValue":t[0]||(t[0]=e=>o.selectedQuantity=e),row:""},{default:(0,r.k6)(()=>[(0,r.bF)(d,{label:"1",value:1}),(0,r.bF)(d,{label:"2",value:2}),(0,r.bF)(d,{label:"3",value:3}),(0,r.bF)(d,{label:"4",value:4}),(0,r.bF)(d,{label:"Custom",value:o.customQuantity},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),o.selectedQuantity===o.customQuantity?((0,r.uX)(),(0,r.Wv)(u,{key:0,cols:"6"},{default:(0,r.k6)(()=>[(0,r.bF)(m,{modelValue:o.customQuantityValue,"onUpdate:modelValue":t[1]||(t[1]=e=>o.customQuantityValue=e),label:"Custom Quantity",type:"number",min:"1",max:o.selectedItem.quantity,outlined:""},null,8,["modelValue","max"])]),_:1})):(0,r.Q3)("",!0),(0,r.bF)(u,{cols:"6"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",Ue,[(0,r.Lk)("strong",null,"Total Price: "+(0,h.v_)(s.totalPriceDisplay),1)])]),_:1})]),_:1})]),_:1})]),_:1})):(0,r.Q3)("",!0),o.selectedItem?((0,r.uX)(),(0,r.Wv)(p,{key:1,class:"mt-4",elevation:"2"},{default:(0,r.k6)(()=>[(0,r.bF)(f,null,{default:(0,r.k6)(()=>[(0,r.bF)(v,{color:"primary",size:"large",disabled:!s.canSell,loading:o.isSelling,onClick:s.handleSell},{default:(0,r.k6)(()=>[...t[4]||(t[4]=[(0,r.eW)(" Checkout ",-1)])]),_:1},8,["disabled","loading","onClick"]),(0,r.bF)(v,{class:"ml-2",color:"secondary",size:"large",disabled:!s.canSell,loading:o.isAddingToCart,onClick:s.handleAddToCart},{default:(0,r.k6)(()=>[...t[5]||(t[5]=[(0,r.eW)(" Add to Cart ",-1)])]),_:1},8,["disabled","loading","onClick"]),o.sellMessage?((0,r.uX)(),(0,r.Wv)(y,{key:0,type:o.sellMessageType,class:"mt-2"},{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(o.sellMessage),1)]),_:1},8,["type"])):(0,r.Q3)("",!0)]),_:1})]),_:1})):(0,r.Q3)("",!0),(0,r.bF)(b,{items:o.cart.items,loading:o.isCartProcessing,estimates:o.priceEstimates,"total-estimate":o.totalEstimate,message:o.cartMessage,"message-type":o.cartMessageType,onUpdateQty:s.onCartUpdateQty,onRemoveItem:s.onCartRemoveItem,onClear:s.onCartClear,onCheckout:s.onCartCheckout,onRefreshPrices:s.onRefreshEstimates},null,8,["items","loading","estimates","total-estimate","message","message-type","onUpdateQty","onRemoveItem","onClear","onCheckout","onRefreshPrices"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const Me={key:2,class:"text-subtitle-1"},Oe={key:0},Ae={key:1,class:"font-weight-bold ml-1"},Xe={key:2,class:"ml-4"},He={key:3,class:"font-weight-bold ml-1"},ze={key:4,class:"ml-4"},Be={key:5,class:"font-weight-bold ml-1"};function je(e,t,a,l,o,s){const n=(0,r.g2)("v-expansion-panel-title"),i=(0,r.g2)("ProductSelector"),d=(0,r.g2)("v-expansion-panel-text"),c=(0,r.g2)("v-expansion-panel"),u=(0,r.g2)("ColorSelector"),m=(0,r.g2)("StorageSelector"),g=(0,r.g2)("StoreSelector"),f=(0,r.g2)("v-expansion-panels"),p=(0,r.g2)("v-alert"),v=(0,r.g2)("v-skeleton-loader"),y=(0,r.g2)("v-col"),b=(0,r.g2)("v-row"),k=(0,r.g2)("v-card-text"),F=(0,r.g2)("v-card");return(0,r.uX)(),(0,r.Wv)(F,null,{default:(0,r.k6)(()=>[(0,r.bF)(k,null,{default:(0,r.k6)(()=>[(0,r.bF)(f,{modelValue:o.activePanel,"onUpdate:modelValue":t[4]||(t[4]=e=>o.activePanel=e),variant:"accordion",class:"mb-4"},{default:(0,r.k6)(()=>[(0,r.bF)(c,null,{default:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[5]||(t[5]=[(0,r.eW)("Product",-1)])]),_:1}),(0,r.bF)(d,null,{default:(0,r.k6)(()=>[(0,r.bF)(i,{modelValue:o.selectedProduct,"onUpdate:modelValue":t[0]||(t[0]=e=>o.selectedProduct=e)},null,8,["modelValue"])]),_:1})]),_:1}),o.selectedProduct?((0,r.uX)(),(0,r.Wv)(c,{key:0},{default:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[6]||(t[6]=[(0,r.eW)("Color",-1)])]),_:1}),(0,r.bF)(d,null,{default:(0,r.k6)(()=>[(0,r.bF)(u,{product:o.selectedProduct,modelValue:o.selectedColor,"onUpdate:modelValue":t[1]||(t[1]=e=>o.selectedColor=e)},null,8,["product","modelValue"])]),_:1})]),_:1})):(0,r.Q3)("",!0),o.selectedColor?((0,r.uX)(),(0,r.Wv)(c,{key:1},{default:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[7]||(t[7]=[(0,r.eW)("Storage",-1)])]),_:1}),(0,r.bF)(d,null,{default:(0,r.k6)(()=>[(0,r.bF)(m,{product:o.selectedProduct,color:o.selectedColor,modelValue:o.selectedStorage,"onUpdate:modelValue":t[2]||(t[2]=e=>o.selectedStorage=e),onOptions:s.onStorageOptions},null,8,["product","color","modelValue","onOptions"])]),_:1})]),_:1})):(0,r.Q3)("",!0),o.selectedColor?((0,r.uX)(),(0,r.Wv)(c,{key:2},{default:(0,r.k6)(()=>[(0,r.bF)(n,null,{default:(0,r.k6)(()=>[...t[8]||(t[8]=[(0,r.eW)("Store",-1)])]),_:1}),(0,r.bF)(d,null,{default:(0,r.k6)(()=>[(0,r.bF)(g,{modelValue:o.selectedStore,"onUpdate:modelValue":t[3]||(t[3]=e=>o.selectedStore=e),product:o.selectedProduct,color:o.selectedColor,storage:o.selectedStorage},null,8,["modelValue","product","color","storage"])]),_:1})]),_:1})):(0,r.Q3)("",!0)]),_:1},8,["modelValue"]),(0,r.bF)(b,{class:"mt-2"},{default:(0,r.k6)(()=>[(0,r.bF)(y,{cols:"12",md:"6"},{default:(0,r.k6)(()=>[o.error?((0,r.uX)(),(0,r.Wv)(p,{key:0,type:"error",density:"comfortable"},{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(o.error),1)]),_:1})):o.loading?((0,r.uX)(),(0,r.Wv)(v,{key:1,type:"text"})):((0,r.uX)(),(0,r.CE)("div",Me,[o.selectedStore?((0,r.uX)(),(0,r.CE)("span",Oe,"Quantity:")):(0,r.Q3)("",!0),o.selectedStore?((0,r.uX)(),(0,r.CE)("span",Ae,(0,h.v_)(s.quantityDisplay),1)):(0,r.Q3)("",!0),o.selectedStore&&o.selectedStorage?((0,r.uX)(),(0,r.CE)("span",Xe,"Storage:")):(0,r.Q3)("",!0),o.selectedStore&&o.selectedStorage?((0,r.uX)(),(0,r.CE)("span",He,(0,h.v_)(o.selectedStorage)+"GB",1)):(0,r.Q3)("",!0),o.selectedStore&&null!==o.price&&void 0!==o.price?((0,r.uX)(),(0,r.CE)("span",ze,"Price:")):(0,r.Q3)("",!0),o.selectedStore&&null!==o.price&&void 0!==o.price?((0,r.uX)(),(0,r.CE)("span",Be,"$"+(0,h.v_)(o.price),1)):(0,r.Q3)("",!0)]))]),_:1})]),_:1})]),_:1})]),_:1})}function Je(e,t,a,l,o,s){const n=(0,r.g2)("v-autocomplete");return(0,r.uX)(),(0,r.Wv)(n,{items:o.storeItems,loading:o.loading,"model-value":a.modelValue,"item-title":"label","item-value":"value",label:"Store",placeholder:"Select a store",clearable:"","onUpdate:modelValue":s.onUpdate},null,8,["items","loading","model-value","onUpdate:modelValue"])}const Ge="inventory";async function Ze(){const{data:e,error:t}=await F.from(Ge).select("name, location").not("name","is",null).not("location","is",null);if(t)throw t;const a=new Set,l=[],r=e=>String(e).trim().replace(/\s+/g," ");for(const o of e){const e=r(o.name),t=r(o.location),s=`${e.toLowerCase()}__${t.toLowerCase()}`;a.has(s)||(a.add(s),l.push({name:e,location:t,label:`${e} — ${t}`}))}return l.sort((e,t)=>e.label.localeCompare(t.label))}async function Ke(){const{data:e,error:t}=await F.from(Ge).select("product").not("product","is",null);if(t)throw t;const a=new Set((e||[]).map(e=>String(e.product).trim().toLowerCase()));return Array.from(a).sort()}async function Ye(e){const{data:t,error:a}=await F.from(Ge).select("color").ilike("product",e).not("color","is",null);if(a)throw a;const l=new Set((t||[]).map(e=>String(e.color).trim().toLowerCase()));return Array.from(l).sort()}async function et(e,t){const{data:a,error:l}=await F.from(Ge).select("storage").ilike("product",e).ilike("color",t).not("storage","is",null);if(l)throw l;const r=new Set((a||[]).map(e=>String(e.storage).trim()));return Array.from(r).sort((e,t)=>Number(e)-Number(t))}async function tt(e,t,a){let l=F.from(Ge).select("name, location, quantity").ilike("product",e).ilike("color",t);if(void 0!==a&&null!==a&&""!==a){const e=Number(a);l=Number.isNaN(e)?l.eq("storage",String(a)):l.eq("storage",e)}else l=l.or("storage.is.null,storage.eq.0");const{data:r,error:o}=await l;if(o)throw o;const s=e=>String(e).trim().replace(/\s+/g," "),n=new Map;for(const d of r||[]){const e=s(d.name),t=s(d.location),a=`${e.toLowerCase()}__${t.toLowerCase()}`,l=n.get(a)||0,r=Number(d.quantity);n.set(a,l+(Number.isNaN(r)?0:r))}const i=[];for(const[d,c]of n.entries()){const[e,t]=d.split("__"),a=r.find(a=>s(a.name).toLowerCase()===e&&s(a.location).toLowerCase()===t),l=a?s(a.name):e,o=a?s(a.location):t,n=c>0,u=`${l} — ${o}`,m=n?u:`(no available) ${u}`;i.push({name:l,location:o,label:m,available:n})}return i.sort((e,t)=>e.label.localeCompare(t.label))}async function at(e,t,a,l){const{name:r,location:o}=e;let s=F.from(Ge).select("quantity").eq("name",r).eq("location",o).ilike("product",t).ilike("color",a);if(void 0!==l&&null!==l&&""!==l){const e=Number(l);s=Number.isNaN(e)?s.eq("storage",String(l)):s.eq("storage",e)}else s=s.or("storage.is.null,storage.eq.0");const{data:n,error:i}=await s;if(i)throw i;let d=0;for(const c of n||[]){const e=Number(c.quantity);Number.isNaN(e)||(d+=e)}return d}async function lt(e,t,a,l){const{name:r,location:o}=e;let s=F.from(Ge).select("price").eq("name",r).eq("location",o).ilike("product",t).ilike("color",a);if(void 0!==l&&null!==l&&""!==l){const e=Number(l);s=Number.isNaN(e)?s.eq("storage",String(l)):s.eq("storage",e)}else s=s.or("storage.is.null,storage.eq.0");const{data:n,error:i}=await s;if(i)throw i;return n&&n.length>0?n[0].price:null}var rt={name:"StoreSelector",props:{modelValue:{type:Object,default:null},product:{type:String,default:""},color:{type:String,default:""},storage:{type:[String,Number],default:""}},data(){return{loading:!1,storeItems:[]}},methods:{onUpdate(e){this.$emit("update:modelValue",e)},async loadStores(){this.loading=!0;try{const e=await Ze();let t=new Map;if(this.product&&this.color){const e=await tt(this.product,this.color,this.storage);for(const a of e){const e=`${String(a.name).trim().replace(/\s+/g," ").toLowerCase()}__${String(a.location).trim().replace(/\s+/g," ").toLowerCase()}`;t.set(e,{hasProduct:!0,available:a.available})}}const a=(e,t)=>`${String(e).trim().replace(/\s+/g," ").toLowerCase()}__${String(t).trim().replace(/\s+/g," ").toLowerCase()}`,l=new Map;for(const r of e){const e=a(r.name,r.location);if(l.has(e))continue;const o=t.get(e),s=!0===o?.hasProduct,n=!0===o?.available,i=String(r.name).trim().replace(/\s+/g," "),d=String(r.location).trim().replace(/\s+/g," ");let c=`${i} — ${d}`;this.product&&this.color&&(s?n||(c=`(no available) ${c}`):c=`(not available) ${c}`);const u={name:i,location:d},m={label:c,value:u,disabled:!(!this.product||!this.color)&&!s};l.set(e,m)}this.storeItems=Array.from(l.values())}catch(e){console.error("Failed to load stores",e)}finally{this.loading=!1}}},mounted(){this.loadStores()},watch:{product(){this.loadStores()},color(){this.loadStores()},storage(){this.loadStores()}}};const ot=(0,n.A)(rt,[["render",Je]]);var st=ot;function nt(e,t,a,l,o,s){const n=(0,r.g2)("v-autocomplete");return(0,r.uX)(),(0,r.Wv)(n,{disabled:!1,items:o.items,loading:o.loading,"model-value":a.modelValue,label:"Product",placeholder:"Select a product",clearable:"","onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("update:modelValue",t))},null,8,["items","loading","model-value"])}var it={name:"ProductSelector",props:{modelValue:{type:String,default:""},store:{type:Object,default:null}},data(){return{loading:!1,items:[]}},watch:{modelValue(){}},mounted(){this.load()},methods:{async load(){this.loading=!0;try{const e=await Ke();this.items=e.length>0?e:["(not available)"]}catch(e){console.error("Failed to load products",e),this.items=["(not available)"]}finally{this.loading=!1}}}};const dt=(0,n.A)(it,[["render",nt]]);var ct=dt;function ut(e,t,a,l,o,s){const n=(0,r.g2)("v-autocomplete");return(0,r.uX)(),(0,r.Wv)(n,{disabled:!a.product,items:o.items,loading:o.loading,"model-value":a.modelValue,label:"Color",placeholder:"Select a color",clearable:"","onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("update:modelValue",t))},null,8,["disabled","items","loading","model-value"])}var mt={name:"ColorSelector",props:{modelValue:{type:String,default:""},store:{type:Object,default:null},product:{type:String,default:""}},data(){return{loading:!1,items:[]}},watch:{product:{handler(){this.load()},immediate:!0}},methods:{async load(){if(this.product){this.loading=!0;try{const e=await Ye(this.product);this.items=e&&e.length?e:["(not available)"]}catch(e){console.error("Failed to load colors",e),this.items=["(not available)"]}finally{this.loading=!1}}else this.items=[]}}};const gt=(0,n.A)(mt,[["render",ut]]);var ht=gt;function ft(e,t,a,l,o,s){const n=(0,r.g2)("v-autocomplete");return(0,r.uX)(),(0,r.Wv)(n,{disabled:!a.product||!a.color,items:s.displayItems,loading:o.loading,"model-value":a.modelValue,"item-title":"label","item-value":"value",label:"Storage",placeholder:"Select storage",clearable:"","onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("update:modelValue",t))},null,8,["disabled","items","loading","model-value"])}var pt={name:"StorageSelector",props:{modelValue:{type:[String,Number],default:""},store:{type:Object,default:null},product:{type:String,default:""},color:{type:String,default:""}},emits:["update:modelValue","options"],data(){return{loading:!1,items:[]}},computed:{displayItems(){return this.items.map(e=>"(not available)"===e?{label:"(not available)",value:""}:{label:`${e}GB`,value:e})}},watch:{product:{handler(){this.load()},immediate:!0},color(){this.load()}},methods:{async load(){if(!this.product||!this.color)return this.items=[],void this.$emit("options",0);this.loading=!0;try{const e=await et(this.product,this.color);this.items=e&&e.length?e:["(not available)"],this.$emit("options",this.items.length),0===this.items.length&&this.$emit("update:modelValue","")}catch(e){console.error("Failed to load storages",e),this.items=["(not available)"],this.$emit("options",1)}finally{this.loading=!1}}}};const vt=(0,n.A)(pt,[["render",ft]]);var yt=vt,bt={name:"InventorySearchPanel",components:{StoreSelector:st,ProductSelector:ct,ColorSelector:ht,StorageSelector:yt},emits:["change"],data(){return{selectedStore:null,selectedProduct:"",selectedColor:"",selectedStorage:"",loading:!1,error:"",quantity:null,price:null,storageOptionsCount:0,activePanel:0}},computed:{quantityDisplay(){return null===this.quantity?"-":this.quantity},hasStoreProductColor(){return!!this.selectedStore&&!!this.selectedProduct&&!!this.selectedColor}},watch:{selectedProduct(){this.resetAfterProduct(),this.emitSelection(),this.activePanel=1},selectedColor(){this.resetAfterColor(),this.emitSelection(),this.activePanel=2},selectedStorage(){this.emitSelection(),this.activePanel=3},selectedStore(){this.triggerQuery(),this.activePanel=3}},methods:{onStorageOptions(e){this.storageOptionsCount=e},resetAfterProduct(){this.selectedColor="",this.selectedStorage="",this.selectedStore=null,this.storageOptionsCount=0,this.quantity=null,this.price=null},resetAfterColor(){this.selectedStorage="",this.selectedStore=null,this.storageOptionsCount=0,this.quantity=null,this.price=null},emitSelection(){this.$emit("change",{store:this.selectedStore,product:this.selectedProduct,color:this.selectedColor,storage:this.selectedStorage})},async triggerQuery(){if(this.emitSelection(),!this.selectedStore||!this.selectedProduct||!this.selectedColor)return this.quantity=null,void(this.price=null);this.loading=!0,this.error="";try{const[e,t]=await Promise.all([at(this.selectedStore,this.selectedProduct,this.selectedColor,this.selectedStorage),lt(this.selectedStore,this.selectedProduct,this.selectedColor,this.selectedStorage)]);this.quantity=e,this.price=t}catch(e){this.error="Failed to load data",console.error(e)}finally{this.loading=!1}}}};const kt=(0,n.A)(bt,[["render",je]]);var Ft=kt;const _t={key:0,class:"text-body-2"},St={key:0,class:"text-left"},Ct={key:1,class:"text-left"},Dt={key:0},wt={key:1},Rt={class:"mt-4 d-flex align-center"},xt={class:"text-body-2 mr-2"},Wt={key:0};function Vt(e,t,a,l,o,s){const n=(0,r.g2)("v-spacer"),i=(0,r.g2)("v-btn"),d=(0,r.g2)("v-card-title"),c=(0,r.g2)("v-text-field"),u=(0,r.g2)("v-table"),m=(0,r.g2)("v-alert"),g=(0,r.g2)("v-card-text"),f=(0,r.g2)("v-card");return(0,r.uX)(),(0,r.Wv)(f,{class:"mt-4",elevation:"2"},{default:(0,r.k6)(()=>[(0,r.bF)(d,null,{default:(0,r.k6)(()=>[t[5]||(t[5]=(0,r.eW)(" Cart ",-1)),(0,r.bF)(n),(0,r.bF)(i,{class:"mr-2",color:"primary",variant:"text",disabled:0===a.items.length||a.loading,onClick:t[0]||(t[0]=t=>e.$emit("refresh-prices"))},{default:(0,r.k6)(()=>[...t[3]||(t[3]=[(0,r.eW)("Refresh Prices",-1)])]),_:1},8,["disabled"]),(0,r.bF)(i,{color:"error",variant:"text",disabled:0===a.items.length,onClick:t[1]||(t[1]=t=>e.$emit("clear"))},{default:(0,r.k6)(()=>[...t[4]||(t[4]=[(0,r.eW)("Clear",-1)])]),_:1},8,["disabled"])]),_:1}),(0,r.bF)(g,null,{default:(0,r.k6)(()=>[0===a.items.length?((0,r.uX)(),(0,r.CE)("div",_t,"Cart is empty")):((0,r.uX)(),(0,r.Wv)(u,{key:1,density:"comfortable"},{default:(0,r.k6)(()=>[(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[t[6]||(t[6]=(0,r.Lk)("th",{class:"text-left"},"Product",-1)),t[7]||(t[7]=(0,r.Lk)("th",{class:"text-left"},"Color",-1)),t[8]||(t[8]=(0,r.Lk)("th",{class:"text-left"},"Storage",-1)),s.hasEstimates?((0,r.uX)(),(0,r.CE)("th",St,"Unit Price")):(0,r.Q3)("",!0),s.hasEstimates?((0,r.uX)(),(0,r.CE)("th",Ct,"Subtotal")):(0,r.Q3)("",!0),t[9]||(t[9]=(0,r.Lk)("th",{class:"text-left",style:{width:"140px"}},"Qty",-1)),t[10]||(t[10]=(0,r.Lk)("th",{class:"text-left",style:{width:"80px"}},null,-1))])]),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.items,t=>((0,r.uX)(),(0,r.CE)("tr",{key:t.key},[(0,r.Lk)("td",null,(0,h.v_)(t.product),1),(0,r.Lk)("td",null,(0,h.v_)(t.color),1),(0,r.Lk)("td",null,(0,h.v_)(t.storage||"-"),1),s.hasEstimates?((0,r.uX)(),(0,r.CE)("td",Dt,(0,h.v_)(s.displayUnitPrice(t.key)),1)):(0,r.Q3)("",!0),s.hasEstimates?((0,r.uX)(),(0,r.CE)("td",wt,(0,h.v_)(s.displaySubtotal(t.key,t.quantity)),1)):(0,r.Q3)("",!0),(0,r.Lk)("td",null,[(0,r.bF)(c,{type:"number",min:"1",density:"compact",variant:"outlined","hide-details":"","model-value":t.quantity,"onUpdate:modelValue":e=>s.onUpdateQty(t.key,e)},null,8,["model-value","onUpdate:modelValue"])]),(0,r.Lk)("td",null,[(0,r.bF)(i,{color:"error",variant:"text",icon:"mdi-delete",onClick:a=>e.$emit("remove-item",t.key)},null,8,["onClick"])])]))),128))])]),_:1})),(0,r.Lk)("div",Rt,[(0,r.Lk)("div",xt,[t[11]||(t[11]=(0,r.eW)(" Prices are estimated and finalized at checkout ",-1)),s.hasEstimates&&null!==a.totalEstimate?((0,r.uX)(),(0,r.CE)("span",Wt," — Estimated Total: "+(0,h.v_)(s.displayCurrency(a.totalEstimate)),1)):(0,r.Q3)("",!0)]),(0,r.bF)(n),(0,r.bF)(i,{color:"primary",disabled:0===a.items.length||a.loading,loading:a.loading,onClick:t[2]||(t[2]=t=>e.$emit("checkout"))},{default:(0,r.k6)(()=>[...t[12]||(t[12]=[(0,r.eW)("Checkout Cart",-1)])]),_:1},8,["disabled","loading"])]),a.message?((0,r.uX)(),(0,r.Wv)(m,{key:2,type:a.messageType,class:"mt-3"},{default:(0,r.k6)(()=>[(0,r.eW)((0,h.v_)(a.message),1)]),_:1},8,["type"])):(0,r.Q3)("",!0)]),_:1})]),_:1})}var Pt={name:"CartPanel",props:{items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},estimates:{type:Object,default:null},totalEstimate:{type:Number,default:null},message:{type:String,default:""},messageType:{type:String,default:"success"}},emits:["update-qty","remove-item","clear","checkout","refresh-prices"],computed:{hasEstimates(){return!!this.estimates}},methods:{onUpdateQty(e,t){const a=parseInt(t,10);this.$emit("update-qty",{key:e,quantity:Number.isNaN(a)?1:a})},displayCurrency(e){const t=Number(e)||0;return`$${t.toFixed(2)}`},displayUnitPrice(e){return this.estimates&&void 0!==this.estimates[e]&&null!==this.estimates[e]?this.displayCurrency(this.estimates[e]):"-"},displaySubtotal(e,t){if(!this.estimates||void 0===this.estimates[e]||null===this.estimates[e])return"-";const a=Number(this.estimates[e])||0,l=Number(t)||0;return this.displayCurrency(a*l)}}};const It=(0,n.A)(Pt,[["render",Vt]]);var Lt=It;const Nt="app_cart";function $t(e){return void 0===e||null===e||""===e?"NULL":String(e)}function Tt(){try{const e=localStorage.getItem(Nt);if(!e)return{store:null,items:[]};const t=JSON.parse(e);return t&&"object"===typeof t?{store:t.store||null,items:Array.isArray(t.items)?t.items:[]}:{store:null,items:[]}}catch(e){return{store:null,items:[]}}}function Et(e){localStorage.setItem(Nt,JSON.stringify(e))}function Qt(){const e={store:null,items:[]};return Et(e),e}function Ut(e,t,a){if(e.items.length>0){const{name:a,location:l}=e.store||{};if(!t||t.name!==a||t.location!==l)return{cart:e,error:"Cart only allows items from the same store."}}const l=$t(a.storage),r=`${String(a.product).toLowerCase()}|${String(a.color).toLowerCase()}|${l}`,o={store:0===e.items.length?t:e.store,items:[...e.items]},s=o.items.findIndex(e=>e.key===r);if(s>=0){const e=o.items[s];o.items.splice(s,1,{...e,quantity:Number(e.quantity)+Number(a.quantity)})}else o.items.push({key:r,product:a.product,color:a.color,storage:a.storage,quantity:Number(a.quantity)});return Et(o),{cart:o}}function qt(e,t,a){const l=Math.max(0,Number(a)||0),r={store:e.store,items:e.items.map(e=>e.key===t?{...e,quantity:l}:e)},o={store:r.store,items:r.items.filter(e=>e.quantity>0)};return 0===o.items.length&&(o.store=null),Et(o),o}function Mt(e,t){const a={store:e.store,items:e.items.filter(e=>e.key!==t)};return 0===a.items.length&&(a.store=null),Et(a),a}function Ot(e){return""===e||null===e||void 0===e?null:e}async function At({store:e,product:t,color:a,storage:l}){const{name:r,location:o}=e;let s=F.from("inventory").select("id").eq("name",r).eq("location",o).ilike("product",t).ilike("color",a);const n=Ot(l);if(null!==n){const e=Number(n);s=Number.isNaN(e)?s.eq("storage",String(n)):s.eq("storage",e)}else s=s.or("storage.is.null,storage.eq.0");const{data:i,error:d}=await s;if(d)throw d;if(!i||0===i.length)throw new Error(`No inventory record found for ${t} ${a} ${l?l+"GB":"no storage"}`);return i[0].id}async function Xt({store:e,product:t,color:a,storage:l},r){const{name:o,location:s}=e;let n=F.from("inventory").select("*").eq("name",o).eq("location",s).ilike("product",t).ilike("color",a);const i=Ot(l);if(null!==i){const e=Number(i);n=Number.isNaN(e)?n.eq("storage",String(i)):n.eq("storage",e)}else n=n.or("storage.is.null,storage.eq.0");const{data:d,error:c}=await n;if(c)throw c;if(!d||0===d.length)throw new Error(`No inventory records found for ${t} ${a} ${l?l+"GB":"no storage"}`);let u=0;for(const g of d)u+=Number(g.quantity)||0;if(u<r)throw new Error(`Insufficient inventory. Available: ${u}, Required: ${r}`);let m=r;for(const g of d){if(m<=0)break;const e=Number(g.quantity)||0,t=Math.min(m,e);if(t>0){const a=e-t,{error:l}=await F.from("inventory").update({quantity:a}).eq("id",g.id).eq("name",g.name).eq("location",g.location);if(l)throw l;m-=t}}if(m>0)throw new Error("Insufficient inventory to complete the sale")}var Ht={name:"SellingPage",components:{InventorySearchPanel:Ft,CartPanel:Lt},data(){return{selectedItem:null,selectedQuantity:1,customQuantity:"custom",customQuantityValue:1,isSelling:!1,isAddingToCart:!1,sellMessage:"",sellMessageType:"success",cart:{store:null,items:[]},isCartProcessing:!1,cartMessage:"",cartMessageType:"success",priceEstimates:null,totalEstimate:null}},created(){this.cart=Tt()},computed:{actualQuantity(){return this.selectedQuantity===this.customQuantity?parseInt(this.customQuantityValue)||1:this.selectedQuantity},totalPrice(){return this.selectedItem&&this.selectedItem.price?this.selectedItem.price*this.actualQuantity:0},totalPriceDisplay(){if(!this.selectedItem||!this.selectedItem.price)return"$0";const e=this.selectedItem.price*this.actualQuantity;return`$${e.toFixed(2)}`},canSell(){return this.selectedItem&&this.selectedItem.price&&this.actualQuantity>0&&this.actualQuantity<=(this.selectedItem.quantity||0)}},methods:{generateOrderId(){const e=new Date,t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0"),r=String(e.getHours()).padStart(2,"0"),o=String(e.getMinutes()).padStart(2,"0"),s=String(e.getSeconds()).padStart(2,"0"),n=String(e.getMilliseconds()).padStart(3,"0");return`${t}${a}${l}${r}${o}${s}${n}`},async onSelectionChange(e){if(console.log("Selection changed",e),e.store&&e.product&&e.color)try{const t=Ot(e.storage),[a,l]=await Promise.all([lt(e.store,e.product,e.color,t),at(e.store,e.product,e.color,t)]);this.selectedItem={store:e.store,product:e.product,color:e.color,storage:t,price:a,quantity:l},this.selectedQuantity=1,this.customQuantityValue=1,this.sellMessage=""}catch(t){console.error("Error fetching item details:",t),this.sellMessage="Error fetching product information",this.sellMessageType="error"}else this.selectedItem=null,this.sellMessage=""},handleAddToCart(){if(this.canSell){this.isAddingToCart=!0,this.cartMessage="";try{const e={product:this.selectedItem.product,color:this.selectedItem.color,storage:this.selectedItem.storage,quantity:this.actualQuantity},{cart:t,error:a}=Ut(this.cart,this.selectedItem.store,e);a?(this.cartMessage=a,this.cartMessageType="error"):(this.cart=t,this.cartMessage="Added to cart",this.cartMessageType="success")}catch(e){this.cartMessage="Failed to add to cart",this.cartMessageType="error"}finally{this.isAddingToCart=!1}}},async handleSell(){if(this.canSell){this.isSelling=!0,this.sellMessage="";try{const e=await lt(this.selectedItem.store,this.selectedItem.product,this.selectedItem.color,this.selectedItem.storage),t=await At({store:this.selectedItem.store,product:this.selectedItem.product,color:this.selectedItem.color,storage:this.selectedItem.storage}),a=this.generateOrderId(),l={time:(new Date).toISOString(),id:t,order_id:a,name:this.selectedItem.store.name,product:this.selectedItem.product,price:(e||0)*this.actualQuantity,quantity:this.actualQuantity,store_location:this.selectedItem.store.location,color:this.selectedItem.color,storage:Ot(this.selectedItem.storage),unit_price:e};await V(l),await Xt({store:this.selectedItem.store,product:this.selectedItem.product,color:this.selectedItem.color,storage:this.selectedItem.storage},this.actualQuantity),this.sellMessage=`Successfully sold ${this.actualQuantity} items for $${(e||0)*this.actualQuantity}`,this.sellMessageType="success";const r=await at(this.selectedItem.store,this.selectedItem.product,this.selectedItem.color,this.selectedItem.storage);this.selectedItem.quantity=r,this.selectedQuantity=1,this.customQuantityValue=1}catch(e){console.error("Error creating sale:",e),this.sellMessage="Sale failed: "+e.message,this.sellMessageType="error"}finally{this.isSelling=!1}}},onCartUpdateQty({key:e,quantity:t}){this.cart=qt(this.cart,e,t),this.cartMessage=""},onCartRemoveItem(e){this.cart=Mt(this.cart,e),this.cartMessage=""},onCartClear(){this.cart=Qt(),this.cartMessage="",this.priceEstimates=null,this.totalEstimate=null},async onCartCheckout(){if(this.cart&&0!==this.cart.items.length){this.isCartProcessing=!0,this.cartMessage="";try{for(const t of this.cart.items){const[e]=await Promise.all([at(this.cart.store,t.product,t.color,t.storage)]);if(e<t.quantity)return this.cartMessage=`Insufficient inventory for ${t.product} ${t.color} ${t.storage||""}. Available: ${e}, Required: ${t.quantity}`,void(this.cartMessageType="error")}const e=this.generateOrderId();for(const t of this.cart.items){const a=await lt(this.cart.store,t.product,t.color,t.storage),l=await At({store:this.cart.store,product:t.product,color:t.color,storage:t.storage}),r={time:(new Date).toISOString(),id:l,order_id:e,name:this.cart.store.name,product:t.product,price:(a||0)*t.quantity,quantity:t.quantity,store_location:this.cart.store.location,color:t.color,storage:Ot(t.storage),unit_price:a};await V(r),await Xt({store:this.cart.store,product:t.product,color:t.color,storage:t.storage},t.quantity)}this.cart=Qt(),this.cartMessage="Checkout completed.",this.cartMessageType="success"}catch(e){console.error(e),this.cartMessage=`Checkout failed: ${e.message}`,this.cartMessageType="error"}finally{this.isCartProcessing=!1}}},async onRefreshEstimates(){if(!this.cart||0===this.cart.items.length||!this.cart.store)return this.priceEstimates=null,void(this.totalEstimate=null);this.isCartProcessing=!0;try{const e={};let t=0;for(const a of this.cart.items){const l=await lt(this.cart.store,a.product,a.color,a.storage);e[a.key]=l,t+=(Number(l)||0)*(Number(a.quantity)||0)}this.priceEstimates=e,this.totalEstimate=t}catch(e){console.error(e),this.cartMessage="Failed to refresh prices",this.cartMessageType="error"}finally{this.isCartProcessing=!1}}}};const zt=(0,n.A)(Ht,[["render",qe]]);var Bt=zt;const jt=[{path:"/",redirect:"/selling"},{path:"/sales-record",name:"SalesRecord",component:Pe},{path:"/inventory",name:"Inventory",component:Qe},{path:"/selling",name:"Selling",component:Bt}],Jt=(0,g.aE)({history:(0,g.LA)(),routes:jt});var Gt=Jt;const Zt=(0,c.$N)({components:u,directives:m}),Kt=(0,l.Ef)(d);Kt.use(Zt),Kt.use(Gt),Kt.mount("#app")}},t={};function a(l){var r=t[l];if(void 0!==r)return r.exports;var o=t[l]={exports:{}};return e[l].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,l,r,o){if(!l){var s=1/0;for(c=0;c<e.length;c++){l=e[c][0],r=e[c][1],o=e[c][2];for(var n=!0,i=0;i<l.length;i++)(!1&o||s>=o)&&Object.keys(a.O).every(function(e){return a.O[e](l[i])})?l.splice(i--,1):(n=!1,o<s&&(s=o));if(n){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[l,r,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,l){var r,o,s=l[0],n=l[1],i=l[2],d=0;if(s.some(function(t){return 0!==e[t]})){for(r in n)a.o(n,r)&&(a.m[r]=n[r]);if(i)var c=i(a)}for(t&&t(l);d<s.length;d++)o=s[d],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(c)},l=self["webpackChunkinventory_management_system"]=self["webpackChunkinventory_management_system"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=a.O(void 0,[504],function(){return a(5756)});l=a.O(l)})();
//# sourceMappingURL=app.c394c117.js.map